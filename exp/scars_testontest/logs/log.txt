2024-05-15 10:15:27,502 - INFO - Training scars_testontest with the following settings:
2024-05-15 10:15:27,503 - INFO - Command-line arguments: output_dir=exp
 experiment_name=scars_testontest
 seed_num=1
 evaluate=False
 dataset_name=scars
 backbone_name=ViT-B/16
 epochs=200
 base_lr=0.0005
 classifier_lr=0.1
 momentum=0.9
 weight_decay=0.0001
 num_workers=8
 batch_size=128
 prop_train_labels=0.5
 image_size=224
 crop_pct=0.875
 interpolation=3
 transform=imagenet
 alpha_sr=0
 alpha_ri=0.05
 alpha_rs=0.05
 alpha_rd=0.05
 pseudo_ratio=0.6
 lambda_loss=0.2
 coteaching_epoch_t=10
 coteaching_epoch_i=15
 max_kmeans_iter=10
 k_means_init=20
 interrupted_path=
 train_classes=range(0, 98)
 unlabeled_classes=range(98, 196)
 num_labeled_classes=98
 num_unlabeled_classes=98
 num_classes=196
 log_path=exp/scars_testontest/logs/log.txt
 model_path=exp/scars_testontest/models/model.pth
 device=cuda
2024-05-15 10:15:27,505 - INFO - Loading CLIP (backbone: ViT-B/16)
2024-05-15 10:15:31,646 - INFO - Building custom CLIP
2024-05-15 10:15:37,156 - INFO - Turning off gradients in both the image and the text encoder
2024-05-15 10:15:37,158 - INFO - Parameters that require gradients: ['model.text_projection', 'model.visual.proj', 'model.visual.transformer.resblocks.11.attn.in_proj_weight', 'model.visual.transformer.resblocks.11.attn.in_proj_bias', 'model.visual.transformer.resblocks.11.attn.out_proj.weight', 'model.visual.transformer.resblocks.11.attn.out_proj.bias', 'model.visual.transformer.resblocks.11.ln_1.weight', 'model.visual.transformer.resblocks.11.ln_1.bias', 'model.visual.transformer.resblocks.11.mlp.c_fc.weight', 'model.visual.transformer.resblocks.11.mlp.c_fc.bias', 'model.visual.transformer.resblocks.11.mlp.c_proj.weight', 'model.visual.transformer.resblocks.11.mlp.c_proj.bias', 'model.visual.transformer.resblocks.11.ln_2.weight', 'model.visual.transformer.resblocks.11.ln_2.bias', 'model.transformer.resblocks.11.attn.in_proj_weight', 'model.transformer.resblocks.11.attn.in_proj_bias', 'model.transformer.resblocks.11.attn.out_proj.weight', 'model.transformer.resblocks.11.attn.out_proj.bias', 'model.transformer.resblocks.11.ln_1.weight', 'model.transformer.resblocks.11.ln_1.bias', 'model.transformer.resblocks.11.mlp.c_fc.weight', 'model.transformer.resblocks.11.mlp.c_fc.bias', 'model.transformer.resblocks.11.mlp.c_proj.weight', 'model.transformer.resblocks.11.mlp.c_proj.bias', 'model.transformer.resblocks.11.ln_2.weight', 'model.transformer.resblocks.11.ln_2.bias', 'image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2024-05-15 10:15:37,160 - INFO - Parameters in classifier with big lr: ['image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2024-05-15 10:15:37,974 - INFO - len of train dataset: 8144
2024-05-15 10:15:37,975 - INFO - len of test dataset: 6118
2024-05-15 10:15:37,975 - INFO - Pseudo Nums: 18
2024-05-15 10:16:30,185 - INFO - len of image_to_class_map: 2160
2024-05-15 10:16:30,188 - INFO - len of image_to_class_map_i: 2251
2024-05-15 10:17:32,878 - INFO - Before Train Accuracies: All 0.0184 | Old 0.0112 | New 0.0255
2024-05-15 10:17:32,879 - INFO - Before Train Accuracies: All 0.0616 | Old 0.0442 | New 0.0787
2024-05-15 10:19:43,332 - INFO - Epoch 1/200, Total Loss: 11.8946, Cls Loss: 9.8797, Cluster Loss: 10.0823, New Loss: 0.0000, Clip tag Loss: 1.8529
2024-05-15 10:19:43,333 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2024-05-15 10:19:43,333 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-05-15 10:20:46,345 - INFO - Text classifier Epoch 0 Train Accuracies: All 0.0390 | Old 0.0390 | New 0.0391
2024-05-15 10:20:46,345 - INFO - Image classifier Epoch 0 Train Accuracies: All 0.1688 | Old 0.1972 | New 0.1406
2024-05-15 10:21:49,006 - INFO - Weighted Accuracies: All 0.1188 | Old 0.1532 | New 0.0847
2024-05-15 10:22:40,293 - INFO - len of image_to_class_map: 2861
2024-05-15 10:22:40,293 - INFO - len of image_to_class_map_i: 2869
2024-05-15 10:24:51,125 - INFO - Epoch 2/200, Total Loss: 10.1261, Cls Loss: 8.0063, Cluster Loss: 8.5070, New Loss: 0.0000, Clip tag Loss: 1.7192
2024-05-15 10:24:51,125 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2024-05-15 10:24:51,125 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-05-15 10:25:54,833 - INFO - Text classifier Epoch 1 Train Accuracies: All 0.0399 | Old 0.0400 | New 0.0399
2024-05-15 10:25:54,833 - INFO - Image classifier Epoch 1 Train Accuracies: All 0.2722 | Old 0.4123 | New 0.1334
2024-05-15 10:26:58,104 - INFO - Weighted Accuracies: All 0.1509 | Old 0.2281 | New 0.0743
2024-05-15 10:27:49,633 - INFO - len of image_to_class_map: 2944
2024-05-15 10:27:49,634 - INFO - len of image_to_class_map_i: 2608
2024-05-15 10:29:59,909 - INFO - Epoch 3/200, Total Loss: 7.8244, Cls Loss: 6.1241, Cluster Loss: 6.1516, New Loss: 0.0000, Clip tag Loss: 1.6783
2024-05-15 10:29:59,911 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2024-05-15 10:29:59,911 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-05-15 10:31:02,985 - INFO - Text classifier Epoch 2 Train Accuracies: All 0.0451 | Old 0.0452 | New 0.0451
2024-05-15 10:31:02,986 - INFO - Image classifier Epoch 2 Train Accuracies: All 0.3462 | Old 0.5520 | New 0.1424
2024-05-15 10:32:06,159 - INFO - Weighted Accuracies: All 0.1592 | Old 0.2289 | New 0.0901
2024-05-15 10:32:57,528 - INFO - len of image_to_class_map: 3072
2024-05-15 10:32:57,529 - INFO - len of image_to_class_map_i: 2835
2024-05-15 10:35:06,044 - INFO - Epoch 4/200, Total Loss: 6.7203, Cls Loss: 5.0982, Cluster Loss: 5.0832, New Loss: 0.0000, Clip tag Loss: 1.6341
2024-05-15 10:35:06,044 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2024-05-15 10:35:06,044 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-05-15 10:36:09,312 - INFO - Text classifier Epoch 3 Train Accuracies: All 0.0448 | Old 0.0427 | New 0.0468
2024-05-15 10:36:09,313 - INFO - Image classifier Epoch 3 Train Accuracies: All 0.4024 | Old 0.6147 | New 0.1921
2024-05-15 10:37:11,763 - INFO - Weighted Accuracies: All 0.1480 | Old 0.1904 | New 0.1060
2024-05-15 10:38:02,676 - INFO - len of image_to_class_map: 3105
2024-05-15 10:38:02,678 - INFO - len of image_to_class_map_i: 2969
2024-05-15 10:40:11,687 - INFO - Epoch 5/200, Total Loss: 6.1770, Cls Loss: 4.5416, Cluster Loss: 4.5634, New Loss: 0.0000, Clip tag Loss: 1.6179
2024-05-15 10:40:11,688 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2024-05-15 10:40:11,688 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-05-15 10:41:14,678 - INFO - Text classifier Epoch 4 Train Accuracies: All 0.0438 | Old 0.0452 | New 0.0423
2024-05-15 10:41:14,679 - INFO - Image classifier Epoch 4 Train Accuracies: All 0.4435 | Old 0.7019 | New 0.1874
2024-05-15 10:42:16,785 - INFO - Weighted Accuracies: All 0.1398 | Old 0.1797 | New 0.1003
2024-05-15 10:43:08,343 - INFO - len of image_to_class_map: 3071
2024-05-15 10:43:08,344 - INFO - len of image_to_class_map_i: 3083
2024-05-15 10:45:16,813 - INFO - Epoch 6/200, Total Loss: 5.6878, Cls Loss: 4.1046, Cluster Loss: 4.1233, New Loss: 0.0000, Clip tag Loss: 1.5682
2024-05-15 10:45:16,814 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2024-05-15 10:45:16,815 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-05-15 10:46:19,726 - INFO - Text classifier Epoch 5 Train Accuracies: All 0.0468 | Old 0.0477 | New 0.0458
2024-05-15 10:46:19,727 - INFO - Image classifier Epoch 5 Train Accuracies: All 0.4752 | Old 0.6924 | New 0.2600
2024-05-15 10:47:22,720 - INFO - Weighted Accuracies: All 0.1467 | Old 0.1904 | New 0.1035
2024-05-15 10:48:13,556 - INFO - len of image_to_class_map: 3164
2024-05-15 10:48:13,557 - INFO - len of image_to_class_map_i: 3169
2024-05-15 10:50:22,699 - INFO - Epoch 7/200, Total Loss: 5.4310, Cls Loss: 3.7613, Cluster Loss: 3.8957, New Loss: 0.0000, Clip tag Loss: 1.5622
2024-05-15 10:50:22,700 - INFO -    Param Group: classifier_head, Learning Rate: 0.0997
2024-05-15 10:50:22,700 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-05-15 10:51:24,943 - INFO - Text classifier Epoch 6 Train Accuracies: All 0.0465 | Old 0.0467 | New 0.0463
2024-05-15 10:51:24,944 - INFO - Image classifier Epoch 6 Train Accuracies: All 0.5104 | Old 0.7191 | New 0.3035
