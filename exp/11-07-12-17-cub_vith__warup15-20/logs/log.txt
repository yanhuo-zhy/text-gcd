2023-11-07 12:17:46,011 - INFO - Training cub_vith__warup15-20 with the following settings:
2023-11-07 12:17:46,011 - INFO - Command-line arguments: output_dir=exp
 experiment_name=cub_vith__warup15-20
 seed_num=1
 evaluate=False
 dataset_name=cub
 backbone_name=ViT-B/16
 epochs=200
 base_lr=0.0005
 classifier_lr=0.1
 momentum=0.9
 weight_decay=0.0001
 num_workers=8
 batch_size=110
 prop_train_labels=0.5
 image_size=224
 crop_pct=0.875
 interpolation=3
 transform=imagenet
 alpha_sr=0
 alpha_ri=0.05
 alpha_rs=0.05
 alpha_rd=0.05
 pseudo_ratio=0.6
 lambda_loss=0.2
 coteaching_epoch_t=15
 coteaching_epoch_i=20
 max_kmeans_iter=10
 k_means_init=20
 interrupted_path=
 train_classes=range(0, 100)
 unlabeled_classes=range(100, 200)
 num_labeled_classes=100
 num_unlabeled_classes=100
 num_classes=200
 log_path=exp/11-07-12-17-cub_vith__warup15-20/logs/log.txt
 model_path=exp/11-07-12-17-cub_vith__warup15-20/models/model.pth
 device=cuda
2023-11-07 12:17:46,015 - INFO - Loading CLIP (backbone: ViT-B/16)
2023-11-07 12:17:46,337 - INFO - Loaded hf-hub:laion/CLIP-ViT-H-14-laion2B-s32B-b79K model config.
2023-11-07 12:17:52,207 - INFO - Loading pretrained hf-hub:laion/CLIP-ViT-H-14-laion2B-s32B-b79K weights (/home/zhun.zhong/.cache/huggingface/hub/models--laion--CLIP-ViT-H-14-laion2B-s32B-b79K/snapshots/94a64189c3535c1cb44acfcccd7b0908c1c8eb23/open_clip_pytorch_model.bin).
2023-11-07 12:18:09,929 - INFO - Building custom CLIP
2023-11-07 12:18:11,253 - INFO - Turning off gradients in both the image and the text encoder
2023-11-07 12:18:11,257 - INFO - Parameters that require gradients: ['model.text_projection', 'model.visual.proj', 'model.visual.transformer.resblocks.11.ln_1.weight', 'model.visual.transformer.resblocks.11.ln_1.bias', 'model.visual.transformer.resblocks.11.attn.in_proj_weight', 'model.visual.transformer.resblocks.11.attn.in_proj_bias', 'model.visual.transformer.resblocks.11.attn.out_proj.weight', 'model.visual.transformer.resblocks.11.attn.out_proj.bias', 'model.visual.transformer.resblocks.11.ln_2.weight', 'model.visual.transformer.resblocks.11.ln_2.bias', 'model.visual.transformer.resblocks.11.mlp.c_fc.weight', 'model.visual.transformer.resblocks.11.mlp.c_fc.bias', 'model.visual.transformer.resblocks.11.mlp.c_proj.weight', 'model.visual.transformer.resblocks.11.mlp.c_proj.bias', 'model.transformer.resblocks.11.ln_1.weight', 'model.transformer.resblocks.11.ln_1.bias', 'model.transformer.resblocks.11.attn.in_proj_weight', 'model.transformer.resblocks.11.attn.in_proj_bias', 'model.transformer.resblocks.11.attn.out_proj.weight', 'model.transformer.resblocks.11.attn.out_proj.bias', 'model.transformer.resblocks.11.ln_2.weight', 'model.transformer.resblocks.11.ln_2.bias', 'model.transformer.resblocks.11.mlp.c_fc.weight', 'model.transformer.resblocks.11.mlp.c_fc.bias', 'model.transformer.resblocks.11.mlp.c_proj.weight', 'model.transformer.resblocks.11.mlp.c_proj.bias', 'image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2023-11-07 12:18:11,258 - INFO - Parameters in classifier with big lr: ['image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2023-11-07 12:18:14,265 - INFO - len of train dataset: 5994
2023-11-07 12:18:14,265 - INFO - len of test dataset: 4494
2023-11-07 12:18:14,265 - INFO - Pseudo Nums: 13
2023-11-07 12:20:09,570 - INFO - len of image_to_class_map: 1552
2023-11-07 12:20:09,571 - INFO - len of image_to_class_map_i: 1797
2023-11-07 12:21:51,974 - INFO - Before Train Accuracies: All 0.0863 | Old 0.0707 | New 0.0942
2023-11-07 12:21:51,974 - INFO - Before Train Accuracies: All 0.0866 | Old 0.0593 | New 0.1002
2023-11-07 12:29:41,165 - INFO - Epoch 1/200, Total Loss: 11.4091, Cls Loss: 9.6912, Cluster Loss: 10.1654, New Loss: 0.0000, Clip tag Loss: 1.3385
2023-11-07 12:29:41,166 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2023-11-07 12:29:41,166 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-11-07 12:31:22,430 - INFO - Text classifier Epoch 0 Train Accuracies: All 0.2708 | Old 0.3047 | New 0.2538
2023-11-07 12:31:22,431 - INFO - Image classifier Epoch 0 Train Accuracies: All 0.2063 | Old 0.2893 | New 0.1647
2023-11-07 12:33:03,720 - INFO - Weighted Accuracies: All 0.2392 | Old 0.3140 | New 0.2017
2023-11-07 12:34:45,218 - INFO - len of image_to_class_map: 1966
2023-11-07 12:34:45,219 - INFO - len of image_to_class_map_i: 2078
2023-11-07 12:42:32,296 - INFO - Epoch 2/200, Total Loss: 9.5124, Cls Loss: 7.7046, Cluster Loss: 8.3402, New Loss: 0.0000, Clip tag Loss: 1.2993
2023-11-07 12:42:32,297 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2023-11-07 12:42:32,297 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-11-07 12:44:13,409 - INFO - Text classifier Epoch 1 Train Accuracies: All 0.3198 | Old 0.4620 | New 0.2485
2023-11-07 12:44:13,410 - INFO - Image classifier Epoch 1 Train Accuracies: All 0.2699 | Old 0.4387 | New 0.1854
2023-11-07 12:45:54,186 - INFO - Weighted Accuracies: All 0.3002 | Old 0.4880 | New 0.2061
2023-11-07 12:47:35,516 - INFO - len of image_to_class_map: 1759
2023-11-07 12:47:35,517 - INFO - len of image_to_class_map_i: 1792
2023-11-07 12:55:23,217 - INFO - Epoch 3/200, Total Loss: 7.5003, Cls Loss: 6.1369, Cluster Loss: 6.2428, New Loss: 0.0000, Clip tag Loss: 1.2787
2023-11-07 12:55:23,218 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2023-11-07 12:55:23,218 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-11-07 12:57:04,947 - INFO - Text classifier Epoch 2 Train Accuracies: All 0.3903 | Old 0.5707 | New 0.2999
2023-11-07 12:57:04,947 - INFO - Image classifier Epoch 2 Train Accuracies: All 0.3360 | Old 0.5727 | New 0.2174
2023-11-07 12:58:46,140 - INFO - Weighted Accuracies: All 0.3687 | Old 0.6260 | New 0.2398
2023-11-07 13:00:27,446 - INFO - len of image_to_class_map: 1931
2023-11-07 13:00:27,447 - INFO - len of image_to_class_map_i: 1938
2023-11-07 13:08:14,523 - INFO - Epoch 4/200, Total Loss: 6.5566, Cls Loss: 5.2988, Cluster Loss: 5.2945, New Loss: 0.0000, Clip tag Loss: 1.2613
2023-11-07 13:08:14,524 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2023-11-07 13:08:14,524 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-11-07 13:09:55,798 - INFO - Text classifier Epoch 3 Train Accuracies: All 0.4039 | Old 0.6047 | New 0.3033
2023-11-07 13:09:55,799 - INFO - Image classifier Epoch 3 Train Accuracies: All 0.3663 | Old 0.6313 | New 0.2335
2023-11-07 13:11:36,874 - INFO - Weighted Accuracies: All 0.4034 | Old 0.6433 | New 0.2832
2023-11-07 13:13:18,351 - INFO - len of image_to_class_map: 1940
2023-11-07 13:13:18,352 - INFO - len of image_to_class_map_i: 1948
2023-11-07 13:21:05,301 - INFO - Epoch 5/200, Total Loss: 6.0899, Cls Loss: 4.8336, Cluster Loss: 4.8309, New Loss: 0.0000, Clip tag Loss: 1.2584
2023-11-07 13:21:05,301 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2023-11-07 13:21:05,302 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-11-07 13:22:46,767 - INFO - Text classifier Epoch 4 Train Accuracies: All 0.4368 | Old 0.6247 | New 0.3427
2023-11-07 13:22:46,768 - INFO - Image classifier Epoch 4 Train Accuracies: All 0.3923 | Old 0.6687 | New 0.2538
2023-11-07 13:24:28,184 - INFO - Weighted Accuracies: All 0.4148 | Old 0.7000 | New 0.2719
2023-11-07 13:26:12,372 - INFO - len of image_to_class_map: 2005
2023-11-07 13:26:12,373 - INFO - len of image_to_class_map_i: 2014
2023-11-07 13:33:59,879 - INFO - Epoch 6/200, Total Loss: 5.7683, Cls Loss: 4.5195, Cluster Loss: 4.5196, New Loss: 0.0000, Clip tag Loss: 1.2488
2023-11-07 13:33:59,880 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2023-11-07 13:33:59,880 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-11-07 13:35:42,368 - INFO - Text classifier Epoch 5 Train Accuracies: All 0.4522 | Old 0.6327 | New 0.3617
2023-11-07 13:35:42,368 - INFO - Image classifier Epoch 5 Train Accuracies: All 0.4119 | Old 0.6973 | New 0.2689
2023-11-07 13:37:24,252 - INFO - Weighted Accuracies: All 0.4315 | Old 0.6940 | New 0.2999
2023-11-07 13:39:05,758 - INFO - len of image_to_class_map: 2032
2023-11-07 13:39:05,759 - INFO - len of image_to_class_map_i: 2000
2023-11-07 13:46:52,698 - INFO - Epoch 7/200, Total Loss: 5.5461, Cls Loss: 4.2449, Cluster Loss: 4.3301, New Loss: 0.0000, Clip tag Loss: 1.2330
2023-11-07 13:46:52,698 - INFO -    Param Group: classifier_head, Learning Rate: 0.0997
2023-11-07 13:46:52,698 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-11-07 13:48:33,923 - INFO - Text classifier Epoch 6 Train Accuracies: All 0.4737 | Old 0.6473 | New 0.3868
2023-11-07 13:48:33,924 - INFO - Image classifier Epoch 6 Train Accuracies: All 0.4219 | Old 0.7007 | New 0.2822
2023-11-07 13:50:15,365 - INFO - Weighted Accuracies: All 0.4484 | Old 0.7060 | New 0.3193
2023-11-07 13:51:56,876 - INFO - len of image_to_class_map: 2099
2023-11-07 13:51:56,876 - INFO - len of image_to_class_map_i: 2038
2023-11-07 13:59:43,530 - INFO - Epoch 8/200, Total Loss: 5.3884, Cls Loss: 4.0939, Cluster Loss: 4.1530, New Loss: 0.0000, Clip tag Loss: 1.2472
2023-11-07 13:59:43,530 - INFO -    Param Group: classifier_head, Learning Rate: 0.0996
2023-11-07 13:59:43,530 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-11-07 14:01:24,764 - INFO - Text classifier Epoch 7 Train Accuracies: All 0.4920 | Old 0.6700 | New 0.4028
2023-11-07 14:01:24,764 - INFO - Image classifier Epoch 7 Train Accuracies: All 0.4252 | Old 0.6940 | New 0.2906
2023-11-07 14:03:05,962 - INFO - Weighted Accuracies: All 0.4591 | Old 0.7253 | New 0.3257
2023-11-07 14:04:46,731 - INFO - len of image_to_class_map: 2134
2023-11-07 14:04:46,732 - INFO - len of image_to_class_map_i: 2043
2023-11-07 14:12:33,593 - INFO - Epoch 9/200, Total Loss: 5.1818, Cls Loss: 3.8672, Cluster Loss: 3.9762, New Loss: 0.0000, Clip tag Loss: 1.2275
2023-11-07 14:12:33,594 - INFO -    Param Group: classifier_head, Learning Rate: 0.0995
2023-11-07 14:12:33,594 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-11-07 14:14:14,773 - INFO - Text classifier Epoch 8 Train Accuracies: All 0.4989 | Old 0.6473 | New 0.4245
2023-11-07 14:14:14,773 - INFO - Image classifier Epoch 8 Train Accuracies: All 0.4328 | Old 0.7127 | New 0.2926
2023-11-07 14:15:56,016 - INFO - Weighted Accuracies: All 0.4566 | Old 0.7333 | New 0.3180
2023-11-07 14:17:37,381 - INFO - len of image_to_class_map: 2167
2023-11-07 14:17:37,382 - INFO - len of image_to_class_map_i: 2080
2023-11-07 14:25:24,583 - INFO - Epoch 10/200, Total Loss: 5.0568, Cls Loss: 3.7200, Cluster Loss: 3.8554, New Loss: 0.0000, Clip tag Loss: 1.2284
2023-11-07 14:25:24,583 - INFO -    Param Group: classifier_head, Learning Rate: 0.0994
2023-11-07 14:25:24,584 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-11-07 14:27:06,140 - INFO - Text classifier Epoch 9 Train Accuracies: All 0.5360 | Old 0.6760 | New 0.4659
2023-11-07 14:27:06,140 - INFO - Image classifier Epoch 9 Train Accuracies: All 0.4537 | Old 0.7233 | New 0.3186
2023-11-07 14:28:47,472 - INFO - Weighted Accuracies: All 0.4682 | Old 0.7193 | New 0.3424
2023-11-07 14:30:29,069 - INFO - len of image_to_class_map: 2239
2023-11-07 14:30:29,070 - INFO - len of image_to_class_map_i: 2094
