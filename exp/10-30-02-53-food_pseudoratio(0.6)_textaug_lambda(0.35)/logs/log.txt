2023-10-30 02:53:46,128 - INFO - Training food_pseudoratio(0.6)_textaug_lambda(0.35) with the following settings:
2023-10-30 02:53:46,129 - INFO - Command-line arguments: output_dir=exp
 experiment_name=food_pseudoratio(0.6)_textaug_lambda(0.35)
 seed_num=1
 evaluate=False
 dataset_name=food
 backbone_name=ViT-B/16
 epochs=200
 base_lr=0.0005
 classifier_lr=0.1
 momentum=0.9
 weight_decay=0.0001
 num_workers=8
 batch_size=128
 prop_train_labels=0.5
 image_size=224
 crop_pct=0.875
 interpolation=3
 transform=imagenet
 alpha_sr=0
 alpha_ri=0.05
 alpha_rs=0.05
 alpha_rd=0.05
 pseudo_ratio=0.6
 lambda_loss=0.35
 coteaching_epoch_t=10
 coteaching_epoch_i=15
 max_kmeans_iter=10
 k_means_init=20
 train_classes=range(0, 51)
 unlabeled_classes=range(51, 101)
 num_labeled_classes=51
 num_unlabeled_classes=50
 num_classes=101
 log_path=exp/10-30-02-53-food_pseudoratio(0.6)_textaug_lambda(0.35)/logs/log.txt
 model_path=exp/10-30-02-53-food_pseudoratio(0.6)_textaug_lambda(0.35)/models/model.pth
 device=cuda
2023-10-30 02:53:46,133 - INFO - Loading CLIP (backbone: ViT-B/16)
2023-10-30 02:53:48,157 - INFO - Building custom CLIP
2023-10-30 02:53:48,448 - INFO - Turning off gradients in both the image and the text encoder
2023-10-30 02:53:48,450 - INFO - Parameters that require gradients: ['model.text_projection', 'model.visual.proj', 'model.visual.transformer.resblocks.11.attn.in_proj_weight', 'model.visual.transformer.resblocks.11.attn.in_proj_bias', 'model.visual.transformer.resblocks.11.attn.out_proj.weight', 'model.visual.transformer.resblocks.11.attn.out_proj.bias', 'model.visual.transformer.resblocks.11.ln_1.weight', 'model.visual.transformer.resblocks.11.ln_1.bias', 'model.visual.transformer.resblocks.11.mlp.c_fc.weight', 'model.visual.transformer.resblocks.11.mlp.c_fc.bias', 'model.visual.transformer.resblocks.11.mlp.c_proj.weight', 'model.visual.transformer.resblocks.11.mlp.c_proj.bias', 'model.visual.transformer.resblocks.11.ln_2.weight', 'model.visual.transformer.resblocks.11.ln_2.bias', 'model.transformer.resblocks.11.attn.in_proj_weight', 'model.transformer.resblocks.11.attn.in_proj_bias', 'model.transformer.resblocks.11.attn.out_proj.weight', 'model.transformer.resblocks.11.attn.out_proj.bias', 'model.transformer.resblocks.11.ln_1.weight', 'model.transformer.resblocks.11.ln_1.bias', 'model.transformer.resblocks.11.mlp.c_fc.weight', 'model.transformer.resblocks.11.mlp.c_fc.bias', 'model.transformer.resblocks.11.mlp.c_proj.weight', 'model.transformer.resblocks.11.mlp.c_proj.bias', 'model.transformer.resblocks.11.ln_2.weight', 'model.transformer.resblocks.11.ln_2.bias', 'image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2023-10-30 02:53:48,451 - INFO - Parameters in classifier with big lr: ['image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2023-10-30 02:54:00,628 - INFO - len of train dataset: 75750
2023-10-30 02:54:00,628 - INFO - len of test dataset: 56625
2023-10-30 02:54:00,628 - INFO - Pseudo Nums: 336
2023-10-30 02:57:14,540 - INFO - len of image_to_class_map: 17861
2023-10-30 02:57:14,578 - INFO - len of image_to_class_map_i: 21755
2023-10-30 03:03:51,485 - INFO - Before Train Accuracies: All 0.1095 | Old 0.0596 | New 0.1350
2023-10-30 03:03:51,521 - INFO - Before Train Accuracies: All 0.0776 | Old 0.0262 | New 0.1037
2023-10-30 03:19:27,865 - INFO - Epoch 1/200, Total Loss: 4.5867, Cls Loss: 2.6510, Cluster Loss: 3.5397, New Loss: 0.0000, Clip tag Loss: 1.3581
2023-10-30 03:19:27,865 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2023-10-30 03:19:27,865 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-10-30 03:28:28,121 - INFO - Text classifier Epoch 0 Train Accuracies: All 0.7207 | Old 0.9013 | New 0.6285
2023-10-30 03:28:28,163 - INFO - Image classifier Epoch 0 Train Accuracies: All 0.5733 | Old 0.8684 | New 0.4227
2023-10-30 03:33:39,553 - INFO - Weighted Accuracies: All 0.5349 | Old 0.8649 | New 0.3666
2023-10-30 03:37:24,632 - INFO - len of image_to_class_map: 33444
2023-10-30 03:37:24,689 - INFO - len of image_to_class_map_i: 33867
2023-10-30 03:46:28,159 - INFO - Epoch 2/200, Total Loss: 3.2736, Cls Loss: 1.2305, Cluster Loss: 2.4044, New Loss: 0.0000, Clip tag Loss: 1.2801
2023-10-30 03:46:28,211 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2023-10-30 03:46:28,211 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-10-30 03:54:38,469 - INFO - Text classifier Epoch 1 Train Accuracies: All 0.6816 | Old 0.9018 | New 0.5693
2023-10-30 03:54:38,504 - INFO - Image classifier Epoch 1 Train Accuracies: All 0.5802 | Old 0.8693 | New 0.4327
2023-10-30 03:58:53,479 - INFO - Weighted Accuracies: All 0.5342 | Old 0.8858 | New 0.3549
2023-10-30 04:03:08,526 - INFO - len of image_to_class_map: 33894
2023-10-30 04:03:08,593 - INFO - len of image_to_class_map_i: 33935
2023-10-30 04:11:56,633 - INFO - Epoch 3/200, Total Loss: 3.1648, Cls Loss: 1.1129, Cluster Loss: 2.3604, New Loss: 0.0000, Clip tag Loss: 1.2410
2023-10-30 04:11:56,662 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2023-10-30 04:11:56,662 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-10-30 04:19:42,642 - INFO - Text classifier Epoch 2 Train Accuracies: All 0.6492 | Old 0.9016 | New 0.5205
2023-10-30 04:19:42,669 - INFO - Image classifier Epoch 2 Train Accuracies: All 0.5498 | Old 0.8737 | New 0.3846
2023-10-30 04:24:11,706 - INFO - Weighted Accuracies: All 0.5219 | Old 0.9026 | New 0.3278
2023-10-30 04:28:07,183 - INFO - len of image_to_class_map: 33631
2023-10-30 04:28:07,222 - INFO - len of image_to_class_map_i: 33936
2023-10-30 04:36:55,596 - INFO - Epoch 4/200, Total Loss: 3.0869, Cls Loss: 1.0294, Cluster Loss: 2.3343, New Loss: 0.0000, Clip tag Loss: 1.2093
2023-10-30 04:36:55,644 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2023-10-30 04:36:55,644 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-10-30 04:44:47,472 - INFO - Text classifier Epoch 3 Train Accuracies: All 0.6473 | Old 0.9027 | New 0.5170
2023-10-30 04:44:47,507 - INFO - Image classifier Epoch 3 Train Accuracies: All 0.5583 | Old 0.8761 | New 0.3962
2023-10-30 04:49:05,149 - INFO - Weighted Accuracies: All 0.5228 | Old 0.8704 | New 0.3456
2023-10-30 04:53:28,410 - INFO - len of image_to_class_map: 33822
2023-10-30 04:53:28,454 - INFO - len of image_to_class_map_i: 33934
2023-10-30 05:02:14,445 - INFO - Epoch 5/200, Total Loss: 3.0412, Cls Loss: 0.9910, Cluster Loss: 2.3114, New Loss: 0.0000, Clip tag Loss: 1.1919
2023-10-30 05:02:14,472 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2023-10-30 05:02:14,472 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-10-30 05:09:11,193 - INFO - Text classifier Epoch 4 Train Accuracies: All 0.6432 | Old 0.9022 | New 0.5111
2023-10-30 05:09:11,218 - INFO - Image classifier Epoch 4 Train Accuracies: All 0.5771 | Old 0.8756 | New 0.4248
2023-10-30 05:13:23,205 - INFO - Weighted Accuracies: All 0.5261 | Old 0.8863 | New 0.3425
2023-10-30 05:17:18,246 - INFO - len of image_to_class_map: 33802
2023-10-30 05:17:18,280 - INFO - len of image_to_class_map_i: 33936
2023-10-30 05:25:50,023 - INFO - Epoch 6/200, Total Loss: 3.0168, Cls Loss: 0.9520, Cluster Loss: 2.3083, New Loss: 0.0000, Clip tag Loss: 1.1832
2023-10-30 05:25:50,047 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2023-10-30 05:25:50,047 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-10-30 05:32:25,355 - INFO - Text classifier Epoch 5 Train Accuracies: All 0.6580 | Old 0.9024 | New 0.5333
2023-10-30 05:32:25,380 - INFO - Image classifier Epoch 5 Train Accuracies: All 0.5637 | Old 0.8716 | New 0.4066
2023-10-30 05:36:14,364 - INFO - Weighted Accuracies: All 0.5346 | Old 0.8852 | New 0.3558
2023-10-30 05:40:13,263 - INFO - len of image_to_class_map: 33907
2023-10-30 05:40:13,303 - INFO - len of image_to_class_map_i: 33935
2023-10-30 05:49:09,693 - INFO - Epoch 7/200, Total Loss: 2.9758, Cls Loss: 0.9011, Cluster Loss: 2.2883, New Loss: 0.0000, Clip tag Loss: 1.1731
2023-10-30 05:49:09,734 - INFO -    Param Group: classifier_head, Learning Rate: 0.0997
2023-10-30 05:49:09,734 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-10-30 05:57:04,827 - INFO - Text classifier Epoch 6 Train Accuracies: All 0.6514 | Old 0.9030 | New 0.5231
2023-10-30 05:57:04,849 - INFO - Image classifier Epoch 6 Train Accuracies: All 0.5649 | Old 0.8802 | New 0.4041
2023-10-30 06:01:42,384 - INFO - Weighted Accuracies: All 0.5223 | Old 0.8729 | New 0.3434
2023-10-30 06:05:04,609 - INFO - len of image_to_class_map: 33898
2023-10-30 06:05:04,643 - INFO - len of image_to_class_map_i: 33935
2023-10-30 06:13:52,832 - INFO - Epoch 8/200, Total Loss: 2.9605, Cls Loss: 0.8981, Cluster Loss: 2.2809, New Loss: 0.0000, Clip tag Loss: 1.1635
2023-10-30 06:13:52,866 - INFO -    Param Group: classifier_head, Learning Rate: 0.0996
2023-10-30 06:13:52,866 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-10-30 06:21:52,098 - INFO - Text classifier Epoch 7 Train Accuracies: All 0.6475 | Old 0.9025 | New 0.5175
2023-10-30 06:21:52,125 - INFO - Image classifier Epoch 7 Train Accuracies: All 0.5841 | Old 0.8773 | New 0.4346
2023-10-30 06:26:37,262 - INFO - Weighted Accuracies: All 0.5201 | Old 0.9041 | New 0.3243
2023-10-30 06:30:44,882 - INFO - len of image_to_class_map: 33655
2023-10-30 06:30:44,916 - INFO - len of image_to_class_map_i: 33911
2023-10-30 06:39:40,238 - INFO - Epoch 9/200, Total Loss: 2.9442, Cls Loss: 0.8890, Cluster Loss: 2.2743, New Loss: 0.0000, Clip tag Loss: 1.1547
2023-10-30 06:39:40,279 - INFO -    Param Group: classifier_head, Learning Rate: 0.0995
2023-10-30 06:39:40,279 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-10-30 06:46:48,456 - INFO - Text classifier Epoch 8 Train Accuracies: All 0.6511 | Old 0.9022 | New 0.5231
2023-10-30 06:46:48,490 - INFO - Image classifier Epoch 8 Train Accuracies: All 0.5795 | Old 0.8807 | New 0.4259
