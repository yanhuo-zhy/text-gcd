2023-11-07 10:50:22,307 - INFO - Training imagenet_1k_pseudoratio(0.6)_textaug_lambda(0.2)_warmup1-5 with the following settings:
2023-11-07 10:50:22,308 - INFO - Command-line arguments: output_dir=exp
 experiment_name=imagenet_1k_pseudoratio(0.6)_textaug_lambda(0.2)_warmup1-5
 seed_num=1
 evaluate=False
 dataset_name=imagenet_1k
 backbone_name=ViT-B/16
 epochs=200
 base_lr=0.0005
 classifier_lr=0.1
 momentum=0.9
 weight_decay=0.0001
 num_workers=8
 batch_size=128
 prop_train_labels=0.5
 image_size=224
 crop_pct=0.875
 interpolation=3
 transform=imagenet
 alpha_sr=0
 alpha_ri=0.05
 alpha_rs=0.05
 alpha_rd=0.05
 pseudo_ratio=0.6
 lambda_loss=0.2
 coteaching_epoch_t=1
 coteaching_epoch_i=5
 max_kmeans_iter=10
 k_means_init=20
 interrupted_path=
 train_classes=range(0, 500)
 unlabeled_classes=range(500, 1000)
 num_labeled_classes=500
 num_unlabeled_classes=500
 num_classes=1000
 log_path=exp/11-07-10-50-imagenet_1k_pseudoratio(0.6)_textaug_lambda(0.2)_warmup1-5/logs/log.txt
 model_path=exp/11-07-10-50-imagenet_1k_pseudoratio(0.6)_textaug_lambda(0.2)_warmup1-5/models/model.pth
 device=cuda
2023-11-07 10:50:22,312 - INFO - Loading CLIP (backbone: ViT-B/16)
2023-11-07 10:50:25,850 - INFO - Building custom CLIP
2023-11-07 10:50:32,296 - INFO - Turning off gradients in both the image and the text encoder
2023-11-07 10:50:32,298 - INFO - Parameters that require gradients: ['model.text_projection', 'model.visual.proj', 'model.visual.transformer.resblocks.11.attn.in_proj_weight', 'model.visual.transformer.resblocks.11.attn.in_proj_bias', 'model.visual.transformer.resblocks.11.attn.out_proj.weight', 'model.visual.transformer.resblocks.11.attn.out_proj.bias', 'model.visual.transformer.resblocks.11.ln_1.weight', 'model.visual.transformer.resblocks.11.ln_1.bias', 'model.visual.transformer.resblocks.11.mlp.c_fc.weight', 'model.visual.transformer.resblocks.11.mlp.c_fc.bias', 'model.visual.transformer.resblocks.11.mlp.c_proj.weight', 'model.visual.transformer.resblocks.11.mlp.c_proj.bias', 'model.visual.transformer.resblocks.11.ln_2.weight', 'model.visual.transformer.resblocks.11.ln_2.bias', 'model.transformer.resblocks.11.attn.in_proj_weight', 'model.transformer.resblocks.11.attn.in_proj_bias', 'model.transformer.resblocks.11.attn.out_proj.weight', 'model.transformer.resblocks.11.attn.out_proj.bias', 'model.transformer.resblocks.11.ln_1.weight', 'model.transformer.resblocks.11.ln_1.bias', 'model.transformer.resblocks.11.mlp.c_fc.weight', 'model.transformer.resblocks.11.mlp.c_fc.bias', 'model.transformer.resblocks.11.mlp.c_proj.weight', 'model.transformer.resblocks.11.mlp.c_proj.bias', 'model.transformer.resblocks.11.ln_2.weight', 'model.transformer.resblocks.11.ln_2.bias', 'image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2023-11-07 10:50:32,300 - INFO - Parameters in classifier with big lr: ['image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2023-11-07 10:52:18,460 - INFO - len of train dataset: 1281167
2023-11-07 10:52:18,460 - INFO - len of test dataset: 960023
2023-11-07 10:52:18,460 - INFO - Pseudo Nums: 576
2023-11-07 11:42:57,225 - INFO - len of image_to_class_map: 304484
2023-11-07 11:42:57,228 - INFO - len of image_to_class_map_i: 379184
2023-11-07 12:31:23,271 - INFO - Before Train Accuracies: All 0.0586 | Old 0.0614 | New 0.0572
2023-11-07 12:31:23,272 - INFO - Before Train Accuracies: All 0.0473 | Old 0.0292 | New 0.0564
2023-11-07 14:39:56,639 - INFO - Epoch 1/200, Total Loss: 8.0906, Cls Loss: 6.5214, Cluster Loss: 7.3254, New Loss: 0.0000, Clip tag Loss: 0.9260
2023-11-07 14:39:56,640 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2023-11-07 14:39:56,640 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-11-07 15:24:47,257 - INFO - Text classifier Epoch 0 Train Accuracies: All 0.4317 | Old 0.7277 | New 0.2829
2023-11-07 15:24:47,258 - INFO - Image classifier Epoch 0 Train Accuracies: All 0.3482 | Old 0.7008 | New 0.1709
2023-11-07 16:12:08,844 - INFO - Weighted Accuracies: All 0.3498 | Old 0.6806 | New 0.1835
2023-11-07 16:59:18,425 - INFO - len of image_to_class_map: 540253
2023-11-07 16:59:18,427 - INFO - len of image_to_class_map_i: 536295
2023-11-07 18:57:17,776 - INFO - Epoch 2/200, Total Loss: 7.3486, Cls Loss: 5.5200, Cluster Loss: 6.7049, New Loss: 0.0000, Clip tag Loss: 0.8807
2023-11-07 18:57:17,777 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2023-11-07 18:57:17,777 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-11-07 19:39:02,284 - INFO - Text classifier Epoch 1 Train Accuracies: All 0.3940 | Old 0.7393 | New 0.2205
2023-11-07 19:39:02,284 - INFO - Image classifier Epoch 1 Train Accuracies: All 0.3383 | Old 0.7238 | New 0.1445
2023-11-07 20:20:49,392 - INFO - Weighted Accuracies: All 0.3498 | Old 0.6943 | New 0.1766
2023-11-07 21:02:58,572 - INFO - len of image_to_class_map: 531949
2023-11-07 21:02:58,575 - INFO - len of image_to_class_map_i: 526324
2023-11-07 23:03:10,144 - INFO - Epoch 3/200, Total Loss: 9.3750, Cls Loss: 4.3836, Cluster Loss: 6.5523, New Loss: 2.3623, Clip tag Loss: 0.8941
2023-11-07 23:03:10,156 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2023-11-07 23:03:10,156 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-11-07 23:49:44,548 - INFO - Text classifier Epoch 2 Train Accuracies: All 0.4052 | Old 0.7398 | New 0.2371
2023-11-07 23:49:44,549 - INFO - Image classifier Epoch 2 Train Accuracies: All 0.4256 | Old 0.7119 | New 0.2817
2023-11-08 00:36:06,714 - INFO - Weighted Accuracies: All 0.4561 | Old 0.7727 | New 0.2970
2023-11-08 01:23:00,699 - INFO - len of image_to_class_map: 518113
2023-11-08 01:23:00,707 - INFO - len of image_to_class_map_i: 551191
2023-11-08 03:26:22,279 - INFO - Epoch 4/200, Total Loss: 8.9062, Cls Loss: 4.1361, Cluster Loss: 6.5777, New Loss: 1.9444, Clip tag Loss: 0.8724
2023-11-08 03:26:22,280 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2023-11-08 03:26:22,280 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-11-08 04:10:36,838 - INFO - Text classifier Epoch 3 Train Accuracies: All 0.4024 | Old 0.7379 | New 0.2337
2023-11-08 04:10:36,839 - INFO - Image classifier Epoch 3 Train Accuracies: All 0.4388 | Old 0.7257 | New 0.2947
2023-11-08 04:56:53,802 - INFO - Weighted Accuracies: All 0.4666 | Old 0.7877 | New 0.3052
2023-11-08 05:43:40,900 - INFO - len of image_to_class_map: 513713
2023-11-08 05:43:40,903 - INFO - len of image_to_class_map_i: 551598
2023-11-08 07:47:11,370 - INFO - Epoch 5/200, Total Loss: 8.7806, Cls Loss: 4.0339, Cluster Loss: 6.5577, New Loss: 1.8657, Clip tag Loss: 0.8620
2023-11-08 07:47:11,371 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2023-11-08 07:47:11,371 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-11-08 08:29:51,656 - INFO - Text classifier Epoch 4 Train Accuracies: All 0.4014 | Old 0.7357 | New 0.2334
2023-11-08 08:29:51,657 - INFO - Image classifier Epoch 4 Train Accuracies: All 0.4392 | Old 0.7266 | New 0.2948
2023-11-08 09:13:33,172 - INFO - Weighted Accuracies: All 0.4639 | Old 0.7821 | New 0.3040
2023-11-08 09:58:59,346 - INFO - len of image_to_class_map: 507955
2023-11-08 09:58:59,349 - INFO - len of image_to_class_map_i: 549096
2023-11-08 12:06:28,842 - INFO - Epoch 6/200, Total Loss: 8.6948, Cls Loss: 3.9599, Cluster Loss: 6.5287, New Loss: 1.8237, Clip tag Loss: 0.8561
2023-11-08 12:06:28,843 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2023-11-08 12:06:28,843 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-11-08 12:50:35,956 - INFO - Text classifier Epoch 5 Train Accuracies: All 0.4076 | Old 0.7346 | New 0.2433
2023-11-08 12:50:35,956 - INFO - Image classifier Epoch 5 Train Accuracies: All 0.4345 | Old 0.7337 | New 0.2842
2023-11-08 13:37:51,799 - INFO - Weighted Accuracies: All 0.4599 | Old 0.7823 | New 0.2978
2023-11-08 14:24:42,086 - INFO - len of image_to_class_map: 503479
2023-11-08 14:24:42,089 - INFO - len of image_to_class_map_i: 550456
2023-11-08 16:32:57,010 - INFO - Epoch 7/200, Total Loss: 10.2967, Cls Loss: 3.1567, Cluster Loss: 6.4482, New Loss: 3.6305, Clip tag Loss: 0.8763
2023-11-08 16:32:57,011 - INFO -    Param Group: classifier_head, Learning Rate: 0.0997
2023-11-08 16:32:57,011 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-11-08 17:17:43,000 - INFO - Text classifier Epoch 6 Train Accuracies: All 0.5200 | Old 0.7341 | New 0.4123
2023-11-08 17:17:43,001 - INFO - Image classifier Epoch 6 Train Accuracies: All 0.4384 | Old 0.7359 | New 0.2889
2023-11-08 18:03:57,574 - INFO - Weighted Accuracies: All 0.5178 | Old 0.7780 | New 0.3870
2023-11-08 18:50:44,340 - INFO - len of image_to_class_map: 550017
2023-11-08 18:50:44,343 - INFO - len of image_to_class_map_i: 550609
2023-11-08 20:58:45,108 - INFO - Epoch 8/200, Total Loss: 9.9022, Cls Loss: 3.0408, Cluster Loss: 6.5633, New Loss: 3.1761, Clip tag Loss: 0.8672
2023-11-08 20:58:45,109 - INFO -    Param Group: classifier_head, Learning Rate: 0.0996
2023-11-08 20:58:45,109 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-11-08 21:42:36,333 - INFO - Text classifier Epoch 7 Train Accuracies: All 0.5214 | Old 0.7368 | New 0.4131
2023-11-08 21:42:36,334 - INFO - Image classifier Epoch 7 Train Accuracies: All 0.5215 | Old 0.7047 | New 0.4295
2023-11-08 22:28:47,067 - INFO - Weighted Accuracies: All 0.5510 | Old 0.7683 | New 0.4418
2023-11-08 23:15:27,871 - INFO - len of image_to_class_map: 551572
2023-11-08 23:15:27,874 - INFO - len of image_to_class_map_i: 553770
2023-11-09 01:23:41,944 - INFO - Epoch 9/200, Total Loss: 9.5831, Cls Loss: 3.0065, Cluster Loss: 6.6446, New Loss: 2.8054, Clip tag Loss: 0.8607
2023-11-09 01:23:41,945 - INFO -    Param Group: classifier_head, Learning Rate: 0.0995
2023-11-09 01:23:41,945 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-11-09 02:08:15,410 - INFO - Text classifier Epoch 8 Train Accuracies: All 0.5749 | Old 0.7320 | New 0.4959
2023-11-09 02:08:15,411 - INFO - Image classifier Epoch 8 Train Accuracies: All 0.5255 | Old 0.7200 | New 0.4277
2023-11-09 02:54:13,300 - INFO - Weighted Accuracies: All 0.5696 | Old 0.7658 | New 0.4711
2023-11-09 03:40:37,203 - INFO - len of image_to_class_map: 553621
2023-11-09 03:40:37,205 - INFO - len of image_to_class_map_i: 554650
2023-11-09 05:49:11,972 - INFO - Epoch 10/200, Total Loss: 9.3998, Cls Loss: 2.9707, Cluster Loss: 6.6874, New Loss: 2.6002, Clip tag Loss: 0.8555
2023-11-09 05:49:11,972 - INFO -    Param Group: classifier_head, Learning Rate: 0.0994
2023-11-09 05:49:11,973 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-11-09 06:33:32,418 - INFO - Text classifier Epoch 9 Train Accuracies: All 0.5739 | Old 0.7383 | New 0.4912
2023-11-09 06:33:32,419 - INFO - Image classifier Epoch 9 Train Accuracies: All 0.5645 | Old 0.7103 | New 0.4912
2023-11-09 07:18:27,807 - INFO - Weighted Accuracies: All 0.5765 | Old 0.7752 | New 0.4766
2023-11-09 08:02:34,593 - INFO - len of image_to_class_map: 554687
2023-11-09 08:02:34,596 - INFO - len of image_to_class_map_i: 554930
