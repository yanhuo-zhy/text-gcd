2023-10-30 02:55:23,163 - INFO - Training food_pseudoratio(0.6)_textaug_lambda(0.3) with the following settings:
2023-10-30 02:55:23,163 - INFO - Command-line arguments: output_dir=exp
 experiment_name=food_pseudoratio(0.6)_textaug_lambda(0.3)
 seed_num=1
 evaluate=False
 dataset_name=food
 backbone_name=ViT-B/16
 epochs=200
 base_lr=0.0005
 classifier_lr=0.1
 momentum=0.9
 weight_decay=0.0001
 num_workers=8
 batch_size=128
 prop_train_labels=0.5
 image_size=224
 crop_pct=0.875
 interpolation=3
 transform=imagenet
 alpha_sr=0
 alpha_ri=0.05
 alpha_rs=0.05
 alpha_rd=0.05
 pseudo_ratio=0.6
 lambda_loss=0.3
 coteaching_epoch_t=10
 coteaching_epoch_i=15
 max_kmeans_iter=10
 k_means_init=20
 train_classes=range(0, 51)
 unlabeled_classes=range(51, 101)
 num_labeled_classes=51
 num_unlabeled_classes=50
 num_classes=101
 log_path=exp/10-30-02-55-food_pseudoratio(0.6)_textaug_lambda(0.3)/logs/log.txt
 model_path=exp/10-30-02-55-food_pseudoratio(0.6)_textaug_lambda(0.3)/models/model.pth
 device=cuda
2023-10-30 02:55:23,167 - INFO - Loading CLIP (backbone: ViT-B/16)
2023-10-30 02:55:25,136 - INFO - Building custom CLIP
2023-10-30 02:55:25,423 - INFO - Turning off gradients in both the image and the text encoder
2023-10-30 02:55:25,425 - INFO - Parameters that require gradients: ['model.text_projection', 'model.visual.proj', 'model.visual.transformer.resblocks.11.attn.in_proj_weight', 'model.visual.transformer.resblocks.11.attn.in_proj_bias', 'model.visual.transformer.resblocks.11.attn.out_proj.weight', 'model.visual.transformer.resblocks.11.attn.out_proj.bias', 'model.visual.transformer.resblocks.11.ln_1.weight', 'model.visual.transformer.resblocks.11.ln_1.bias', 'model.visual.transformer.resblocks.11.mlp.c_fc.weight', 'model.visual.transformer.resblocks.11.mlp.c_fc.bias', 'model.visual.transformer.resblocks.11.mlp.c_proj.weight', 'model.visual.transformer.resblocks.11.mlp.c_proj.bias', 'model.visual.transformer.resblocks.11.ln_2.weight', 'model.visual.transformer.resblocks.11.ln_2.bias', 'model.transformer.resblocks.11.attn.in_proj_weight', 'model.transformer.resblocks.11.attn.in_proj_bias', 'model.transformer.resblocks.11.attn.out_proj.weight', 'model.transformer.resblocks.11.attn.out_proj.bias', 'model.transformer.resblocks.11.ln_1.weight', 'model.transformer.resblocks.11.ln_1.bias', 'model.transformer.resblocks.11.mlp.c_fc.weight', 'model.transformer.resblocks.11.mlp.c_fc.bias', 'model.transformer.resblocks.11.mlp.c_proj.weight', 'model.transformer.resblocks.11.mlp.c_proj.bias', 'model.transformer.resblocks.11.ln_2.weight', 'model.transformer.resblocks.11.ln_2.bias', 'image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2023-10-30 02:55:25,426 - INFO - Parameters in classifier with big lr: ['image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2023-10-30 02:55:37,493 - INFO - len of train dataset: 75750
2023-10-30 02:55:37,494 - INFO - len of test dataset: 56625
2023-10-30 02:55:37,494 - INFO - Pseudo Nums: 336
2023-10-30 03:00:30,968 - INFO - len of image_to_class_map: 17861
2023-10-30 03:00:31,013 - INFO - len of image_to_class_map_i: 21755
2023-10-30 03:07:52,887 - INFO - Before Train Accuracies: All 0.1095 | Old 0.0596 | New 0.1350
2023-10-30 03:07:52,917 - INFO - Before Train Accuracies: All 0.0776 | Old 0.0262 | New 0.1037
2023-10-30 03:20:26,364 - INFO - Epoch 1/200, Total Loss: 4.7355, Cls Loss: 2.8826, Cluster Loss: 3.5954, New Loss: 0.0000, Clip tag Loss: 1.3540
2023-10-30 03:20:26,391 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2023-10-30 03:20:26,391 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-10-30 03:28:28,090 - INFO - Text classifier Epoch 0 Train Accuracies: All 0.7240 | Old 0.8990 | New 0.6347
2023-10-30 03:28:28,136 - INFO - Image classifier Epoch 0 Train Accuracies: All 0.5818 | Old 0.8584 | New 0.4407
2023-10-30 03:33:39,447 - INFO - Weighted Accuracies: All 0.5340 | Old 0.8469 | New 0.3744
2023-10-30 03:37:24,683 - INFO - len of image_to_class_map: 33803
2023-10-30 03:37:24,727 - INFO - len of image_to_class_map_i: 33875
2023-10-30 03:46:28,169 - INFO - Epoch 2/200, Total Loss: 3.3547, Cls Loss: 1.3527, Cluster Loss: 2.3871, New Loss: 0.0000, Clip tag Loss: 1.2779
2023-10-30 03:46:28,232 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2023-10-30 03:46:28,232 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-10-30 03:54:38,475 - INFO - Text classifier Epoch 1 Train Accuracies: All 0.6754 | Old 0.8994 | New 0.5612
2023-10-30 03:54:38,514 - INFO - Image classifier Epoch 1 Train Accuracies: All 0.5835 | Old 0.8559 | New 0.4446
2023-10-30 03:58:53,477 - INFO - Weighted Accuracies: All 0.5348 | Old 0.8667 | New 0.3655
2023-10-30 04:03:08,499 - INFO - len of image_to_class_map: 33883
2023-10-30 04:03:08,568 - INFO - len of image_to_class_map_i: 33924
2023-10-30 04:11:56,473 - INFO - Epoch 3/200, Total Loss: 3.2478, Cls Loss: 1.2255, Cluster Loss: 2.3438, New Loss: 0.0000, Clip tag Loss: 1.2395
2023-10-30 04:11:56,502 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2023-10-30 04:11:56,503 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-10-30 04:19:42,682 - INFO - Text classifier Epoch 2 Train Accuracies: All 0.6534 | Old 0.8968 | New 0.5293
2023-10-30 04:19:42,714 - INFO - Image classifier Epoch 2 Train Accuracies: All 0.5617 | Old 0.8618 | New 0.4087
2023-10-30 04:24:11,596 - INFO - Weighted Accuracies: All 0.5223 | Old 0.8832 | New 0.3382
2023-10-30 04:28:07,177 - INFO - len of image_to_class_map: 33719
2023-10-30 04:28:07,220 - INFO - len of image_to_class_map_i: 33932
2023-10-30 04:36:55,234 - INFO - Epoch 4/200, Total Loss: 3.1707, Cls Loss: 1.1378, Cluster Loss: 2.3160, New Loss: 0.0000, Clip tag Loss: 1.2082
2023-10-30 04:36:55,285 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2023-10-30 04:36:55,285 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-10-30 04:44:47,431 - INFO - Text classifier Epoch 3 Train Accuracies: All 0.6582 | Old 0.8997 | New 0.5351
2023-10-30 04:44:47,460 - INFO - Image classifier Epoch 3 Train Accuracies: All 0.5658 | Old 0.8624 | New 0.4145
2023-10-30 04:49:05,134 - INFO - Weighted Accuracies: All 0.5167 | Old 0.8491 | New 0.3472
2023-10-30 04:53:28,453 - INFO - len of image_to_class_map: 33838
2023-10-30 04:53:28,480 - INFO - len of image_to_class_map_i: 33936
2023-10-30 05:02:13,335 - INFO - Epoch 5/200, Total Loss: 3.1270, Cls Loss: 1.1012, Cluster Loss: 2.2938, New Loss: 0.0000, Clip tag Loss: 1.1910
2023-10-30 05:02:13,365 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2023-10-30 05:02:13,365 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-10-30 05:09:11,225 - INFO - Text classifier Epoch 4 Train Accuracies: All 0.6560 | Old 0.8980 | New 0.5326
2023-10-30 05:09:11,254 - INFO - Image classifier Epoch 4 Train Accuracies: All 0.5768 | Old 0.8559 | New 0.4345
2023-10-30 05:13:23,237 - INFO - Weighted Accuracies: All 0.5200 | Old 0.8837 | New 0.3345
2023-10-30 05:17:18,384 - INFO - len of image_to_class_map: 33754
2023-10-30 05:17:18,417 - INFO - len of image_to_class_map_i: 33936
2023-10-30 05:25:48,296 - INFO - Epoch 6/200, Total Loss: 3.1051, Cls Loss: 1.0622, Cluster Loss: 2.2916, New Loss: 0.0000, Clip tag Loss: 1.1824
2023-10-30 05:25:48,322 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2023-10-30 05:25:48,322 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-10-30 05:32:25,396 - INFO - Text classifier Epoch 5 Train Accuracies: All 0.6585 | Old 0.8981 | New 0.5363
2023-10-30 05:32:25,420 - INFO - Image classifier Epoch 5 Train Accuracies: All 0.5764 | Old 0.8511 | New 0.4363
2023-10-30 05:36:14,348 - INFO - Weighted Accuracies: All 0.5266 | Old 0.8670 | New 0.3529
2023-10-30 05:40:13,246 - INFO - len of image_to_class_map: 33863
2023-10-30 05:40:13,283 - INFO - len of image_to_class_map_i: 33934
2023-10-30 05:49:09,533 - INFO - Epoch 7/200, Total Loss: 3.0678, Cls Loss: 1.0064, Cluster Loss: 2.2763, New Loss: 0.0000, Clip tag Loss: 1.1725
2023-10-30 05:49:09,576 - INFO -    Param Group: classifier_head, Learning Rate: 0.0997
2023-10-30 05:49:09,576 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-10-30 05:57:04,890 - INFO - Text classifier Epoch 6 Train Accuracies: All 0.6511 | Old 0.8995 | New 0.5244
2023-10-30 05:57:04,912 - INFO - Image classifier Epoch 6 Train Accuracies: All 0.5681 | Old 0.8646 | New 0.4169
2023-10-30 06:01:42,321 - INFO - Weighted Accuracies: All 0.5134 | Old 0.8344 | New 0.3497
2023-10-30 06:05:04,645 - INFO - len of image_to_class_map: 33901
2023-10-30 06:05:04,677 - INFO - len of image_to_class_map_i: 33936
2023-10-30 06:13:52,649 - INFO - Epoch 8/200, Total Loss: 3.0461, Cls Loss: 1.0042, Cluster Loss: 2.2598, New Loss: 0.0000, Clip tag Loss: 1.1630
2023-10-30 06:13:52,683 - INFO -    Param Group: classifier_head, Learning Rate: 0.0996
2023-10-30 06:13:52,683 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-10-30 06:21:52,099 - INFO - Text classifier Epoch 7 Train Accuracies: All 0.6366 | Old 0.8984 | New 0.5031
2023-10-30 06:21:52,125 - INFO - Image classifier Epoch 7 Train Accuracies: All 0.5737 | Old 0.8564 | New 0.4295
2023-10-30 06:26:37,168 - INFO - Weighted Accuracies: All 0.5199 | Old 0.8672 | New 0.3427
2023-10-30 06:30:44,868 - INFO - len of image_to_class_map: 33686
2023-10-30 06:30:44,907 - INFO - len of image_to_class_map_i: 33911
2023-10-30 06:39:38,444 - INFO - Epoch 9/200, Total Loss: 3.0273, Cls Loss: 0.9945, Cluster Loss: 2.2496, New Loss: 0.0000, Clip tag Loss: 1.1542
2023-10-30 06:39:38,487 - INFO -    Param Group: classifier_head, Learning Rate: 0.0995
2023-10-30 06:39:38,487 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-10-30 06:46:48,405 - INFO - Text classifier Epoch 8 Train Accuracies: All 0.6456 | Old 0.8977 | New 0.5170
2023-10-30 06:46:48,450 - INFO - Image classifier Epoch 8 Train Accuracies: All 0.5752 | Old 0.8651 | New 0.4273
