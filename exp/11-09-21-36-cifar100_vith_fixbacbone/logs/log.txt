2023-11-09 21:36:17,978 - INFO - Training cifar100_vith_fixbacbone with the following settings:
2023-11-09 21:36:17,978 - INFO - Command-line arguments: output_dir=exp
 experiment_name=cifar100_vith_fixbacbone
 seed_num=1
 evaluate=False
 dataset_name=cifar100
 backbone_name=ViT-B/16
 epochs=200
 base_lr=0.0005
 classifier_lr=0.1
 momentum=0.9
 weight_decay=0.0001
 num_workers=8
 batch_size=128
 prop_train_labels=0.5
 image_size=224
 crop_pct=0.875
 interpolation=3
 transform=imagenet
 alpha_sr=0
 alpha_ri=0.05
 alpha_rs=0.05
 alpha_rd=0.05
 pseudo_ratio=0.6
 lambda_loss=0.2
 coteaching_epoch_t=10
 coteaching_epoch_i=15
 max_kmeans_iter=10
 k_means_init=20
 interrupted_path=
 train_classes=range(0, 80)
 unlabeled_classes=range(80, 100)
 num_labeled_classes=80
 num_unlabeled_classes=20
 num_classes=100
 log_path=exp/11-09-21-36-cifar100_vith_fixbacbone/logs/log.txt
 model_path=exp/11-09-21-36-cifar100_vith_fixbacbone/models/model.pth
 device=cuda
2023-11-09 21:36:17,990 - INFO - Loading CLIP (backbone: ViT-B/16)
2023-11-09 21:36:18,296 - INFO - Loaded hf-hub:laion/CLIP-ViT-H-14-laion2B-s32B-b79K model config.
2023-11-09 21:36:24,248 - INFO - Loading pretrained hf-hub:laion/CLIP-ViT-H-14-laion2B-s32B-b79K weights (/home/zhun.zhong/.cache/huggingface/hub/models--laion--CLIP-ViT-H-14-laion2B-s32B-b79K/snapshots/94a64189c3535c1cb44acfcccd7b0908c1c8eb23/open_clip_pytorch_model.bin).
2023-11-09 21:36:25,670 - INFO - Building custom CLIP
2023-11-09 21:36:26,896 - INFO - Turning off gradients in both the image and the text encoder
2023-11-09 21:36:26,900 - INFO - Parameters that require gradients: ['image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2023-11-09 21:36:26,902 - INFO - Parameters in classifier with big lr: ['image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2023-11-09 21:36:29,752 - INFO - len of train dataset: 50000
2023-11-09 21:36:29,752 - INFO - len of test dataset: 30000
2023-11-09 21:36:29,752 - INFO - Pseudo Nums: 180
2023-11-09 21:50:06,045 - INFO - len of image_to_class_map: 12969
2023-11-09 21:50:06,048 - INFO - len of image_to_class_map_i: 13202
2023-11-09 22:03:19,024 - INFO - Before Train Accuracies: All 0.1586 | Old 0.0815 | New 0.3128
2023-11-09 22:03:19,025 - INFO - Before Train Accuracies: All 0.1052 | Old 0.0519 | New 0.2117
2023-11-09 22:47:13,838 - INFO - Epoch 1/200, Total Loss: 5.6849, Cls Loss: 4.7476, Cluster Loss: 4.3601, New Loss: 0.0000, Clip tag Loss: 1.2473
2023-11-09 22:47:13,839 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2023-11-09 22:47:13,839 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-11-09 23:00:25,259 - INFO - Text classifier Epoch 0 Train Accuracies: All 0.7165 | Old 0.7766 | New 0.5964
2023-11-09 23:00:25,259 - INFO - Image classifier Epoch 0 Train Accuracies: All 0.6582 | Old 0.7418 | New 0.4910
2023-11-09 23:13:36,478 - INFO - Weighted Accuracies: All 0.6725 | Old 0.7882 | New 0.4412
2023-11-09 23:26:48,039 - INFO - len of image_to_class_map: 17410
2023-11-09 23:26:48,044 - INFO - len of image_to_class_map_i: 16746
2023-11-10 00:10:41,511 - INFO - Epoch 2/200, Total Loss: 3.6998, Cls Loss: 2.5467, Cluster Loss: 2.4217, New Loss: 0.0000, Clip tag Loss: 1.2531
2023-11-10 00:10:41,519 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2023-11-10 00:10:41,519 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-11-10 00:23:51,994 - INFO - Text classifier Epoch 1 Train Accuracies: All 0.7629 | Old 0.8000 | New 0.6888
2023-11-10 00:23:51,996 - INFO - Image classifier Epoch 1 Train Accuracies: All 0.6961 | Old 0.8118 | New 0.4646
2023-11-10 00:37:02,690 - INFO - Weighted Accuracies: All 0.6673 | Old 0.7785 | New 0.4447
2023-11-10 00:50:14,265 - INFO - len of image_to_class_map: 17995
2023-11-10 00:50:14,265 - INFO - len of image_to_class_map_i: 17475
2023-11-10 01:34:07,278 - INFO - Epoch 3/200, Total Loss: 3.4697, Cls Loss: 2.1066, Cluster Loss: 2.2557, New Loss: 0.0000, Clip tag Loss: 1.2438
2023-11-10 01:34:07,315 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2023-11-10 01:34:07,315 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-11-10 01:47:19,023 - INFO - Text classifier Epoch 2 Train Accuracies: All 0.7602 | Old 0.8247 | New 0.6311
2023-11-10 01:47:19,023 - INFO - Image classifier Epoch 2 Train Accuracies: All 0.7118 | Old 0.8505 | New 0.4344
2023-11-10 02:00:30,051 - INFO - Weighted Accuracies: All 0.6684 | Old 0.8160 | New 0.3732
2023-11-10 02:13:41,507 - INFO - len of image_to_class_map: 17996
2023-11-10 02:13:41,563 - INFO - len of image_to_class_map_i: 17685
