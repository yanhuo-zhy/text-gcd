2023-11-14 10:18:09,088 - INFO - Training cifar100_coca_nonorm_seed1 with the following settings:
2023-11-14 10:18:09,088 - INFO - Command-line arguments: output_dir=exp
 experiment_name=cifar100_coca_nonorm_seed1
 seed_num=1
 evaluate=False
 dataset_name=cifar100
 backbone_name=ViT-B/16
 epochs=200
 base_lr=0.0005
 classifier_lr=0.1
 momentum=0.9
 weight_decay=0.0001
 num_workers=8
 batch_size=128
 prop_train_labels=0.5
 image_size=224
 crop_pct=0.875
 interpolation=3
 transform=imagenet
 alpha_sr=0
 alpha_ri=0.05
 alpha_rs=0.05
 alpha_rd=0.05
 pseudo_ratio=0.6
 lambda_loss=0.2
 coteaching_epoch_t=10
 coteaching_epoch_i=15
 max_kmeans_iter=10
 k_means_init=20
 interrupted_path=
 train_classes=range(0, 80)
 unlabeled_classes=range(80, 100)
 num_labeled_classes=80
 num_unlabeled_classes=20
 num_classes=100
 log_path=exp/11-14-10-18-cifar100_coca_nonorm_seed1/logs/log.txt
 model_path=exp/11-14-10-18-cifar100_coca_nonorm_seed1/models/model.pth
 device=cuda
2023-11-14 10:18:09,092 - INFO - Loading CLIP (backbone: ViT-B/16)
2023-11-14 10:18:12,955 - INFO - Building custom CLIP
2023-11-14 10:18:19,915 - INFO - Turning off gradients in both the image and the text encoder
2023-11-14 10:18:19,918 - INFO - Parameters that require gradients: ['model.text_projection', 'model.visual.proj', 'model.visual.transformer.resblocks.11.attn.in_proj_weight', 'model.visual.transformer.resblocks.11.attn.in_proj_bias', 'model.visual.transformer.resblocks.11.attn.out_proj.weight', 'model.visual.transformer.resblocks.11.attn.out_proj.bias', 'model.visual.transformer.resblocks.11.ln_1.weight', 'model.visual.transformer.resblocks.11.ln_1.bias', 'model.visual.transformer.resblocks.11.mlp.c_fc.weight', 'model.visual.transformer.resblocks.11.mlp.c_fc.bias', 'model.visual.transformer.resblocks.11.mlp.c_proj.weight', 'model.visual.transformer.resblocks.11.mlp.c_proj.bias', 'model.visual.transformer.resblocks.11.ln_2.weight', 'model.visual.transformer.resblocks.11.ln_2.bias', 'model.transformer.resblocks.11.attn.in_proj_weight', 'model.transformer.resblocks.11.attn.in_proj_bias', 'model.transformer.resblocks.11.attn.out_proj.weight', 'model.transformer.resblocks.11.attn.out_proj.bias', 'model.transformer.resblocks.11.ln_1.weight', 'model.transformer.resblocks.11.ln_1.bias', 'model.transformer.resblocks.11.mlp.c_fc.weight', 'model.transformer.resblocks.11.mlp.c_fc.bias', 'model.transformer.resblocks.11.mlp.c_proj.weight', 'model.transformer.resblocks.11.mlp.c_proj.bias', 'model.transformer.resblocks.11.ln_2.weight', 'model.transformer.resblocks.11.ln_2.bias', 'image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2023-11-14 10:18:19,919 - INFO - Parameters in classifier with big lr: ['image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2023-11-14 10:18:24,946 - INFO - len of train dataset: 50000
2023-11-14 10:18:24,946 - INFO - len of test dataset: 30000
2023-11-14 10:18:24,946 - INFO - Pseudo Nums: 180
2023-11-14 10:19:51,397 - INFO - len of image_to_class_map: 10768
2023-11-14 10:19:51,398 - INFO - len of image_to_class_map_i: 10862
2023-11-14 10:21:16,027 - INFO - Before Train Accuracies: All 0.1059 | Old 0.0658 | New 0.1863
2023-11-14 10:21:16,028 - INFO - Before Train Accuracies: All 0.0723 | Old 0.0167 | New 0.1835
2023-11-14 10:26:37,458 - INFO - Epoch 1/200, Total Loss: 6.6040, Cls Loss: 5.3006, Cluster Loss: 4.9215, New Loss: 0.0000, Clip tag Loss: 1.6067
2023-11-14 10:26:37,459 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2023-11-14 10:26:37,459 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-11-14 10:28:00,702 - INFO - Text classifier Epoch 0 Train Accuracies: All 0.6734 | Old 0.7228 | New 0.5748
2023-11-14 10:28:00,703 - INFO - Image classifier Epoch 0 Train Accuracies: All 0.5518 | Old 0.6431 | New 0.3690
2023-11-14 10:29:24,673 - INFO - Weighted Accuracies: All 0.6440 | Old 0.7175 | New 0.4970
2023-11-14 10:30:47,424 - INFO - len of image_to_class_map: 17619
2023-11-14 10:30:47,437 - INFO - len of image_to_class_map_i: 17395
2023-11-14 10:35:43,269 - INFO - Epoch 2/200, Total Loss: 4.2134, Cls Loss: 2.8703, Cluster Loss: 2.6693, New Loss: 0.0000, Clip tag Loss: 1.5039
2023-11-14 10:35:43,269 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2023-11-14 10:35:43,270 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-11-14 10:37:01,796 - INFO - Text classifier Epoch 1 Train Accuracies: All 0.7010 | Old 0.7808 | New 0.5415
2023-11-14 10:37:01,796 - INFO - Image classifier Epoch 1 Train Accuracies: All 0.5994 | Old 0.6997 | New 0.3986
2023-11-14 10:38:20,791 - INFO - Weighted Accuracies: All 0.6506 | Old 0.7342 | New 0.4832
2023-11-14 10:39:40,169 - INFO - len of image_to_class_map: 17978
2023-11-14 10:39:40,169 - INFO - len of image_to_class_map_i: 17804
2023-11-14 10:44:35,744 - INFO - Epoch 3/200, Total Loss: 3.8905, Cls Loss: 2.4464, Cluster Loss: 2.4543, New Loss: 0.0000, Clip tag Loss: 1.4378
2023-11-14 10:44:35,744 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2023-11-14 10:44:35,744 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-11-14 10:45:54,561 - INFO - Text classifier Epoch 2 Train Accuracies: All 0.6976 | Old 0.7896 | New 0.5137
2023-11-14 10:45:54,562 - INFO - Image classifier Epoch 2 Train Accuracies: All 0.6123 | Old 0.7496 | New 0.3378
2023-11-14 10:47:11,811 - INFO - Weighted Accuracies: All 0.6490 | Old 0.7419 | New 0.4632
2023-11-14 10:48:30,917 - INFO - len of image_to_class_map: 18000
2023-11-14 10:48:30,918 - INFO - len of image_to_class_map_i: 17931
2023-11-14 10:53:27,127 - INFO - Epoch 4/200, Total Loss: 3.7252, Cls Loss: 2.2416, Cluster Loss: 2.3618, New Loss: 0.0000, Clip tag Loss: 1.3875
2023-11-14 10:53:27,127 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2023-11-14 10:53:27,127 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-11-14 10:54:46,147 - INFO - Text classifier Epoch 3 Train Accuracies: All 0.7083 | Old 0.7914 | New 0.5421
2023-11-14 10:54:46,147 - INFO - Image classifier Epoch 3 Train Accuracies: All 0.6325 | Old 0.7562 | New 0.3850
2023-11-14 10:56:05,168 - INFO - Weighted Accuracies: All 0.6544 | Old 0.7660 | New 0.4314
2023-11-14 10:57:24,310 - INFO - len of image_to_class_map: 17987
2023-11-14 10:57:24,311 - INFO - len of image_to_class_map_i: 17943
2023-11-14 11:02:20,231 - INFO - Epoch 5/200, Total Loss: 3.6527, Cls Loss: 2.1318, Cluster Loss: 2.3260, New Loss: 0.0000, Clip tag Loss: 1.3656
2023-11-14 11:02:20,231 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2023-11-14 11:02:20,232 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-11-14 11:03:39,392 - INFO - Text classifier Epoch 4 Train Accuracies: All 0.7050 | Old 0.7872 | New 0.5405
2023-11-14 11:03:39,392 - INFO - Image classifier Epoch 4 Train Accuracies: All 0.6419 | Old 0.7602 | New 0.4051
2023-11-14 11:04:57,984 - INFO - Weighted Accuracies: All 0.6511 | Old 0.7734 | New 0.4065
2023-11-14 11:06:17,227 - INFO - len of image_to_class_map: 17999
2023-11-14 11:06:17,228 - INFO - len of image_to_class_map_i: 17953
2023-11-14 11:11:14,091 - INFO - Epoch 6/200, Total Loss: 3.5316, Cls Loss: 2.0214, Cluster Loss: 2.2591, New Loss: 0.0000, Clip tag Loss: 1.3200
2023-11-14 11:11:14,092 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2023-11-14 11:11:14,092 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-11-14 11:12:32,887 - INFO - Text classifier Epoch 5 Train Accuracies: All 0.7135 | Old 0.8046 | New 0.5312
2023-11-14 11:12:32,887 - INFO - Image classifier Epoch 5 Train Accuracies: All 0.6518 | Old 0.7641 | New 0.4270
2023-11-14 11:13:51,911 - INFO - Weighted Accuracies: All 0.6462 | Old 0.7806 | New 0.3773
2023-11-14 11:15:11,247 - INFO - len of image_to_class_map: 18000
2023-11-14 11:15:11,248 - INFO - len of image_to_class_map_i: 17964
2023-11-14 11:20:06,967 - INFO - Epoch 7/200, Total Loss: 3.5039, Cls Loss: 1.9725, Cluster Loss: 2.2384, New Loss: 0.0000, Clip tag Loss: 1.3187
2023-11-14 11:20:06,968 - INFO -    Param Group: classifier_head, Learning Rate: 0.0997
2023-11-14 11:20:06,968 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-11-14 11:21:25,688 - INFO - Text classifier Epoch 6 Train Accuracies: All 0.7249 | Old 0.8045 | New 0.5656
2023-11-14 11:21:25,689 - INFO - Image classifier Epoch 6 Train Accuracies: All 0.6613 | Old 0.7769 | New 0.4300
2023-11-14 11:22:44,570 - INFO - Weighted Accuracies: All 0.6361 | Old 0.7828 | New 0.3428
2023-11-14 11:24:03,474 - INFO - len of image_to_class_map: 17998
2023-11-14 11:24:03,475 - INFO - len of image_to_class_map_i: 17960
2023-11-14 11:28:58,133 - INFO - Epoch 8/200, Total Loss: 3.4474, Cls Loss: 1.9241, Cluster Loss: 2.2073, New Loss: 0.0000, Clip tag Loss: 1.2967
2023-11-14 11:28:58,134 - INFO -    Param Group: classifier_head, Learning Rate: 0.0996
2023-11-14 11:28:58,134 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-11-14 11:30:16,960 - INFO - Text classifier Epoch 7 Train Accuracies: All 0.7273 | Old 0.8048 | New 0.5721
2023-11-14 11:30:16,961 - INFO - Image classifier Epoch 7 Train Accuracies: All 0.6713 | Old 0.7751 | New 0.4638
