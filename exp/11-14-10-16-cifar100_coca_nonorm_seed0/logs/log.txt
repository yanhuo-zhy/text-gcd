2023-11-14 10:16:13,699 - INFO - Training cifar100_coca_nonorm_seed0 with the following settings:
2023-11-14 10:16:13,699 - INFO - Command-line arguments: output_dir=exp
 experiment_name=cifar100_coca_nonorm_seed0
 seed_num=0
 evaluate=False
 dataset_name=cifar100
 backbone_name=ViT-B/16
 epochs=200
 base_lr=0.0005
 classifier_lr=0.1
 momentum=0.9
 weight_decay=0.0001
 num_workers=8
 batch_size=128
 prop_train_labels=0.5
 image_size=224
 crop_pct=0.875
 interpolation=3
 transform=imagenet
 alpha_sr=0
 alpha_ri=0.05
 alpha_rs=0.05
 alpha_rd=0.05
 pseudo_ratio=0.6
 lambda_loss=0.2
 coteaching_epoch_t=10
 coteaching_epoch_i=15
 max_kmeans_iter=10
 k_means_init=20
 interrupted_path=
 train_classes=range(0, 80)
 unlabeled_classes=range(80, 100)
 num_labeled_classes=80
 num_unlabeled_classes=20
 num_classes=100
 log_path=exp/11-14-10-16-cifar100_coca_nonorm_seed0/logs/log.txt
 model_path=exp/11-14-10-16-cifar100_coca_nonorm_seed0/models/model.pth
 device=cuda
2023-11-14 10:16:13,703 - INFO - Loading CLIP (backbone: ViT-B/16)
2023-11-14 10:16:16,774 - INFO - Building custom CLIP
2023-11-14 10:16:22,380 - INFO - Turning off gradients in both the image and the text encoder
2023-11-14 10:16:22,382 - INFO - Parameters that require gradients: ['model.text_projection', 'model.visual.proj', 'model.visual.transformer.resblocks.11.attn.in_proj_weight', 'model.visual.transformer.resblocks.11.attn.in_proj_bias', 'model.visual.transformer.resblocks.11.attn.out_proj.weight', 'model.visual.transformer.resblocks.11.attn.out_proj.bias', 'model.visual.transformer.resblocks.11.ln_1.weight', 'model.visual.transformer.resblocks.11.ln_1.bias', 'model.visual.transformer.resblocks.11.mlp.c_fc.weight', 'model.visual.transformer.resblocks.11.mlp.c_fc.bias', 'model.visual.transformer.resblocks.11.mlp.c_proj.weight', 'model.visual.transformer.resblocks.11.mlp.c_proj.bias', 'model.visual.transformer.resblocks.11.ln_2.weight', 'model.visual.transformer.resblocks.11.ln_2.bias', 'model.transformer.resblocks.11.attn.in_proj_weight', 'model.transformer.resblocks.11.attn.in_proj_bias', 'model.transformer.resblocks.11.attn.out_proj.weight', 'model.transformer.resblocks.11.attn.out_proj.bias', 'model.transformer.resblocks.11.ln_1.weight', 'model.transformer.resblocks.11.ln_1.bias', 'model.transformer.resblocks.11.mlp.c_fc.weight', 'model.transformer.resblocks.11.mlp.c_fc.bias', 'model.transformer.resblocks.11.mlp.c_proj.weight', 'model.transformer.resblocks.11.mlp.c_proj.bias', 'model.transformer.resblocks.11.ln_2.weight', 'model.transformer.resblocks.11.ln_2.bias', 'image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2023-11-14 10:16:22,383 - INFO - Parameters in classifier with big lr: ['image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2023-11-14 10:16:27,048 - INFO - len of train dataset: 50000
2023-11-14 10:16:27,048 - INFO - len of test dataset: 30000
2023-11-14 10:16:27,048 - INFO - Pseudo Nums: 180
2023-11-14 10:17:47,082 - INFO - len of image_to_class_map: 11146
2023-11-14 10:17:47,082 - INFO - len of image_to_class_map_i: 11215
2023-11-14 10:19:05,287 - INFO - Before Train Accuracies: All 0.1141 | Old 0.0629 | New 0.2164
2023-11-14 10:19:05,288 - INFO - Before Train Accuracies: All 0.0705 | Old 0.0245 | New 0.1625
2023-11-14 10:23:54,780 - INFO - Epoch 1/200, Total Loss: 6.5915, Cls Loss: 5.2995, Cluster Loss: 4.9088, New Loss: 0.0000, Clip tag Loss: 1.6045
2023-11-14 10:23:54,781 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2023-11-14 10:23:54,781 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-11-14 10:25:11,607 - INFO - Text classifier Epoch 0 Train Accuracies: All 0.6590 | Old 0.7077 | New 0.5615
2023-11-14 10:25:11,608 - INFO - Image classifier Epoch 0 Train Accuracies: All 0.5626 | Old 0.6229 | New 0.4420
2023-11-14 10:26:28,234 - INFO - Weighted Accuracies: All 0.6402 | Old 0.6858 | New 0.5489
2023-11-14 10:27:45,406 - INFO - len of image_to_class_map: 17364
2023-11-14 10:27:45,407 - INFO - len of image_to_class_map_i: 17209
2023-11-14 10:32:31,998 - INFO - Epoch 2/200, Total Loss: 4.2198, Cls Loss: 2.8843, Cluster Loss: 2.6851, New Loss: 0.0000, Clip tag Loss: 1.4949
2023-11-14 10:32:31,999 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2023-11-14 10:32:31,999 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-11-14 10:33:48,811 - INFO - Text classifier Epoch 1 Train Accuracies: All 0.6917 | Old 0.7674 | New 0.5404
2023-11-14 10:33:48,812 - INFO - Image classifier Epoch 1 Train Accuracies: All 0.5901 | Old 0.7005 | New 0.3694
2023-11-14 10:35:06,084 - INFO - Weighted Accuracies: All 0.6571 | Old 0.7416 | New 0.4882
2023-11-14 10:36:23,132 - INFO - len of image_to_class_map: 17915
2023-11-14 10:36:23,132 - INFO - len of image_to_class_map_i: 17781
2023-11-14 10:41:10,046 - INFO - Epoch 3/200, Total Loss: 3.8991, Cls Loss: 2.4513, Cluster Loss: 2.4750, New Loss: 0.0000, Clip tag Loss: 1.4288
2023-11-14 10:41:10,047 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2023-11-14 10:41:10,047 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-11-14 10:42:27,045 - INFO - Text classifier Epoch 2 Train Accuracies: All 0.7061 | Old 0.7722 | New 0.5738
2023-11-14 10:42:27,045 - INFO - Image classifier Epoch 2 Train Accuracies: All 0.6118 | Old 0.7247 | New 0.3859
2023-11-14 10:43:43,625 - INFO - Weighted Accuracies: All 0.6513 | Old 0.7853 | New 0.3835
2023-11-14 10:45:00,877 - INFO - len of image_to_class_map: 17976
2023-11-14 10:45:00,878 - INFO - len of image_to_class_map_i: 17924
2023-11-14 10:49:47,132 - INFO - Epoch 4/200, Total Loss: 3.7275, Cls Loss: 2.2317, Cluster Loss: 2.3676, New Loss: 0.0000, Clip tag Loss: 1.3871
2023-11-14 10:49:47,133 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2023-11-14 10:49:47,133 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-11-14 10:51:03,997 - INFO - Text classifier Epoch 3 Train Accuracies: All 0.7087 | Old 0.7829 | New 0.5603
2023-11-14 10:51:03,997 - INFO - Image classifier Epoch 3 Train Accuracies: All 0.6328 | Old 0.7618 | New 0.3750
2023-11-14 10:52:20,447 - INFO - Weighted Accuracies: All 0.6454 | Old 0.8046 | New 0.3270
2023-11-14 10:53:37,861 - INFO - len of image_to_class_map: 17994
2023-11-14 10:53:37,862 - INFO - len of image_to_class_map_i: 17958
2023-11-14 10:58:24,548 - INFO - Epoch 5/200, Total Loss: 3.6185, Cls Loss: 2.1111, Cluster Loss: 2.3036, New Loss: 0.0000, Clip tag Loss: 1.3534
2023-11-14 10:58:24,549 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2023-11-14 10:58:24,549 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-11-14 10:59:41,174 - INFO - Text classifier Epoch 4 Train Accuracies: All 0.6887 | Old 0.7881 | New 0.4901
2023-11-14 10:59:41,175 - INFO - Image classifier Epoch 4 Train Accuracies: All 0.6363 | Old 0.7647 | New 0.3794
2023-11-14 11:00:58,630 - INFO - Weighted Accuracies: All 0.6479 | Old 0.7627 | New 0.4182
2023-11-14 11:02:15,468 - INFO - len of image_to_class_map: 17999
2023-11-14 11:02:15,468 - INFO - len of image_to_class_map_i: 17993
2023-11-14 11:07:02,228 - INFO - Epoch 6/200, Total Loss: 3.5735, Cls Loss: 2.0396, Cluster Loss: 2.2850, New Loss: 0.0000, Clip tag Loss: 1.3376
2023-11-14 11:07:02,229 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2023-11-14 11:07:02,229 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-11-14 11:08:18,716 - INFO - Text classifier Epoch 5 Train Accuracies: All 0.6908 | Old 0.7931 | New 0.4864
2023-11-14 11:08:18,716 - INFO - Image classifier Epoch 5 Train Accuracies: All 0.6568 | Old 0.7797 | New 0.4110
2023-11-14 11:09:35,472 - INFO - Weighted Accuracies: All 0.6454 | Old 0.7941 | New 0.3479
2023-11-14 11:10:53,027 - INFO - len of image_to_class_map: 18000
2023-11-14 11:10:53,028 - INFO - len of image_to_class_map_i: 17926
2023-11-14 11:15:40,192 - INFO - Epoch 7/200, Total Loss: 3.5014, Cls Loss: 1.9582, Cluster Loss: 2.2466, New Loss: 0.0000, Clip tag Loss: 1.3125
2023-11-14 11:15:40,192 - INFO -    Param Group: classifier_head, Learning Rate: 0.0997
2023-11-14 11:15:40,192 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-11-14 11:16:56,823 - INFO - Text classifier Epoch 6 Train Accuracies: All 0.7114 | Old 0.7819 | New 0.5706
2023-11-14 11:16:56,824 - INFO - Image classifier Epoch 6 Train Accuracies: All 0.6545 | Old 0.7761 | New 0.4113
2023-11-14 11:18:13,568 - INFO - Weighted Accuracies: All 0.6529 | Old 0.7826 | New 0.3934
2023-11-14 11:19:30,868 - INFO - len of image_to_class_map: 18000
2023-11-14 11:19:30,869 - INFO - len of image_to_class_map_i: 17915
2023-11-14 11:24:17,667 - INFO - Epoch 8/200, Total Loss: 3.4598, Cls Loss: 1.9161, Cluster Loss: 2.2228, New Loss: 0.0000, Clip tag Loss: 1.2983
2023-11-14 11:24:17,668 - INFO -    Param Group: classifier_head, Learning Rate: 0.0996
2023-11-14 11:24:17,668 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-11-14 11:25:34,271 - INFO - Text classifier Epoch 7 Train Accuracies: All 0.7151 | Old 0.7962 | New 0.5528
2023-11-14 11:25:34,271 - INFO - Image classifier Epoch 7 Train Accuracies: All 0.6607 | Old 0.7748 | New 0.4327
2023-11-14 11:26:51,322 - INFO - Weighted Accuracies: All 0.6487 | Old 0.8074 | New 0.3315
2023-11-14 11:28:08,888 - INFO - len of image_to_class_map: 18000
2023-11-14 11:28:08,888 - INFO - len of image_to_class_map_i: 17944
