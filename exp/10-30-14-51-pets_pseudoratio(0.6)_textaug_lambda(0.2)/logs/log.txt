2023-10-30 14:51:50,941 - INFO - Training pets_pseudoratio(0.6)_textaug_lambda(0.2) with the following settings:
2023-10-30 14:51:50,941 - INFO - Command-line arguments: output_dir=exp
 experiment_name=pets_pseudoratio(0.6)_textaug_lambda(0.2)
 seed_num=1
 evaluate=False
 dataset_name=pets
 backbone_name=ViT-B/16
 epochs=200
 base_lr=0.0005
 classifier_lr=0.1
 momentum=0.9
 weight_decay=0.0001
 num_workers=8
 batch_size=128
 prop_train_labels=0.5
 image_size=224
 crop_pct=0.875
 interpolation=3
 transform=imagenet
 alpha_sr=0
 alpha_ri=0.05
 alpha_rs=0.05
 alpha_rd=0.05
 pseudo_ratio=0.6
 lambda_loss=0.2
 coteaching_epoch_t=10
 coteaching_epoch_i=15
 max_kmeans_iter=10
 k_means_init=20
 train_classes=range(0, 19)
 unlabeled_classes=range(19, 37)
 num_labeled_classes=19
 num_unlabeled_classes=18
 num_classes=37
 log_path=exp/10-30-14-51-pets_pseudoratio(0.6)_textaug_lambda(0.2)/logs/log.txt
 model_path=exp/10-30-14-51-pets_pseudoratio(0.6)_textaug_lambda(0.2)/models/model.pth
 device=cuda
2023-10-30 14:51:50,946 - INFO - Loading CLIP (backbone: ViT-B/16)
2023-10-30 14:51:52,855 - INFO - Building custom CLIP
2023-10-30 14:51:53,136 - INFO - Turning off gradients in both the image and the text encoder
2023-10-30 14:51:53,138 - INFO - Parameters that require gradients: ['model.text_projection', 'model.visual.proj', 'model.visual.transformer.resblocks.11.attn.in_proj_weight', 'model.visual.transformer.resblocks.11.attn.in_proj_bias', 'model.visual.transformer.resblocks.11.attn.out_proj.weight', 'model.visual.transformer.resblocks.11.attn.out_proj.bias', 'model.visual.transformer.resblocks.11.ln_1.weight', 'model.visual.transformer.resblocks.11.ln_1.bias', 'model.visual.transformer.resblocks.11.mlp.c_fc.weight', 'model.visual.transformer.resblocks.11.mlp.c_fc.bias', 'model.visual.transformer.resblocks.11.mlp.c_proj.weight', 'model.visual.transformer.resblocks.11.mlp.c_proj.bias', 'model.visual.transformer.resblocks.11.ln_2.weight', 'model.visual.transformer.resblocks.11.ln_2.bias', 'model.transformer.resblocks.11.attn.in_proj_weight', 'model.transformer.resblocks.11.attn.in_proj_bias', 'model.transformer.resblocks.11.attn.out_proj.weight', 'model.transformer.resblocks.11.attn.out_proj.bias', 'model.transformer.resblocks.11.ln_1.weight', 'model.transformer.resblocks.11.ln_1.bias', 'model.transformer.resblocks.11.mlp.c_fc.weight', 'model.transformer.resblocks.11.mlp.c_fc.bias', 'model.transformer.resblocks.11.mlp.c_proj.weight', 'model.transformer.resblocks.11.mlp.c_proj.bias', 'model.transformer.resblocks.11.ln_2.weight', 'model.transformer.resblocks.11.ln_2.bias', 'image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2023-10-30 14:51:53,139 - INFO - Parameters in classifier with big lr: ['image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2023-10-30 14:51:54,151 - INFO - len of train dataset: 3680
2023-10-30 14:51:54,152 - INFO - len of test dataset: 2738
2023-10-30 14:51:54,152 - INFO - Pseudo Nums: 44
2023-10-30 14:52:15,122 - INFO - len of image_to_class_map: 1134
2023-10-30 14:52:15,167 - INFO - len of image_to_class_map_i: 1113
2023-10-30 14:52:34,070 - INFO - Before Train Accuracies: All 0.2221 | Old 0.1241 | New 0.2735
2023-10-30 14:52:34,080 - INFO - Before Train Accuracies: All 0.1417 | Old 0.0467 | New 0.1916
2023-10-30 14:53:05,281 - INFO - Epoch 1/200, Total Loss: 12.3337, Cls Loss: 10.9682, Cluster Loss: 10.0133, New Loss: 0.0000, Clip tag Loss: 2.1294
2023-10-30 14:53:05,294 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2023-10-30 14:53:05,294 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-10-30 14:53:16,045 - INFO - Text classifier Epoch 0 Train Accuracies: All 0.2126 | Old 0.1145 | New 0.2641
2023-10-30 14:53:16,045 - INFO - Image classifier Epoch 0 Train Accuracies: All 0.0730 | Old 0.0000 | New 0.1114
2023-10-30 14:53:26,331 - INFO - Weighted Accuracies: All 0.0986 | Old 0.0806 | New 0.1081
2023-10-30 14:53:36,486 - INFO - len of image_to_class_map: 673
2023-10-30 14:53:36,487 - INFO - len of image_to_class_map_i: 384
2023-10-30 14:54:03,246 - INFO - Epoch 2/200, Total Loss: 7.8121, Cls Loss: 4.6142, Cluster Loss: 6.0923, New Loss: 0.0000, Clip tag Loss: 2.0155
2023-10-30 14:54:03,246 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2023-10-30 14:54:03,246 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-10-30 14:54:13,973 - INFO - Text classifier Epoch 1 Train Accuracies: All 0.6684 | Old 0.5832 | New 0.7131
2023-10-30 14:54:13,973 - INFO - Image classifier Epoch 1 Train Accuracies: All 0.4328 | Old 0.3722 | New 0.4646
2023-10-30 14:54:24,435 - INFO - Weighted Accuracies: All 0.5551 | Old 0.4486 | New 0.6111
2023-10-30 14:54:35,163 - INFO - len of image_to_class_map: 1359
2023-10-30 14:54:35,163 - INFO - len of image_to_class_map_i: 1291
2023-10-30 14:55:03,844 - INFO - Epoch 3/200, Total Loss: 5.0424, Cls Loss: 2.5947, Cluster Loss: 3.2210, New Loss: 0.0000, Clip tag Loss: 1.9467
2023-10-30 14:55:03,844 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2023-10-30 14:55:03,844 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-10-30 14:55:14,455 - INFO - Text classifier Epoch 2 Train Accuracies: All 0.6888 | Old 0.6331 | New 0.7181
2023-10-30 14:55:14,455 - INFO - Image classifier Epoch 2 Train Accuracies: All 0.5062 | Old 0.4189 | New 0.5521
2023-10-30 14:55:25,270 - INFO - Weighted Accuracies: All 0.6673 | Old 0.5907 | New 0.7075
2023-10-30 14:55:36,275 - INFO - len of image_to_class_map: 1391
2023-10-30 14:55:36,275 - INFO - len of image_to_class_map_i: 1459
2023-10-30 14:56:02,949 - INFO - Epoch 4/200, Total Loss: 4.4399, Cls Loss: 2.2014, Cluster Loss: 2.6155, New Loss: 0.0000, Clip tag Loss: 1.9073
2023-10-30 14:56:02,949 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2023-10-30 14:56:02,949 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-10-30 14:56:13,605 - INFO - Text classifier Epoch 3 Train Accuracies: All 0.7213 | Old 0.7413 | New 0.7109
2023-10-30 14:56:13,605 - INFO - Image classifier Epoch 3 Train Accuracies: All 0.5807 | Old 0.6957 | New 0.5203
2023-10-30 14:56:23,999 - INFO - Weighted Accuracies: All 0.6665 | Old 0.6628 | New 0.6685
2023-10-30 14:56:35,088 - INFO - len of image_to_class_map: 1427
2023-10-30 14:56:35,088 - INFO - len of image_to_class_map_i: 1564
2023-10-30 14:57:02,152 - INFO - Epoch 5/200, Total Loss: 4.0172, Cls Loss: 1.9262, Cluster Loss: 2.2182, New Loss: 0.0000, Clip tag Loss: 1.8574
2023-10-30 14:57:02,152 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2023-10-30 14:57:02,152 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-10-30 14:57:12,851 - INFO - Text classifier Epoch 4 Train Accuracies: All 0.7297 | Old 0.7932 | New 0.6964
2023-10-30 14:57:12,851 - INFO - Image classifier Epoch 4 Train Accuracies: All 0.6669 | Old 0.8271 | New 0.5827
2023-10-30 14:57:22,565 - INFO - Weighted Accuracies: All 0.6563 | Old 0.6670 | New 0.6507
2023-10-30 14:57:33,471 - INFO - len of image_to_class_map: 1413
2023-10-30 14:57:33,471 - INFO - len of image_to_class_map_i: 1577
