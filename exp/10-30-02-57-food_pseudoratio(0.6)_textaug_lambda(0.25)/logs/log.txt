2023-10-30 02:57:40,557 - INFO - Training food_pseudoratio(0.6)_textaug_lambda(0.25) with the following settings:
2023-10-30 02:57:40,558 - INFO - Command-line arguments: output_dir=exp
 experiment_name=food_pseudoratio(0.6)_textaug_lambda(0.25)
 seed_num=1
 evaluate=False
 dataset_name=food
 backbone_name=ViT-B/16
 epochs=200
 base_lr=0.0005
 classifier_lr=0.1
 momentum=0.9
 weight_decay=0.0001
 num_workers=8
 batch_size=128
 prop_train_labels=0.5
 image_size=224
 crop_pct=0.875
 interpolation=3
 transform=imagenet
 alpha_sr=0
 alpha_ri=0.05
 alpha_rs=0.05
 alpha_rd=0.05
 pseudo_ratio=0.6
 lambda_loss=0.25
 coteaching_epoch_t=10
 coteaching_epoch_i=15
 max_kmeans_iter=10
 k_means_init=20
 train_classes=range(0, 51)
 unlabeled_classes=range(51, 101)
 num_labeled_classes=51
 num_unlabeled_classes=50
 num_classes=101
 log_path=exp/10-30-02-57-food_pseudoratio(0.6)_textaug_lambda(0.25)/logs/log.txt
 model_path=exp/10-30-02-57-food_pseudoratio(0.6)_textaug_lambda(0.25)/models/model.pth
 device=cuda
2023-10-30 02:57:40,572 - INFO - Loading CLIP (backbone: ViT-B/16)
2023-10-30 02:57:42,601 - INFO - Building custom CLIP
2023-10-30 02:57:42,895 - INFO - Turning off gradients in both the image and the text encoder
2023-10-30 02:57:42,897 - INFO - Parameters that require gradients: ['model.text_projection', 'model.visual.proj', 'model.visual.transformer.resblocks.11.attn.in_proj_weight', 'model.visual.transformer.resblocks.11.attn.in_proj_bias', 'model.visual.transformer.resblocks.11.attn.out_proj.weight', 'model.visual.transformer.resblocks.11.attn.out_proj.bias', 'model.visual.transformer.resblocks.11.ln_1.weight', 'model.visual.transformer.resblocks.11.ln_1.bias', 'model.visual.transformer.resblocks.11.mlp.c_fc.weight', 'model.visual.transformer.resblocks.11.mlp.c_fc.bias', 'model.visual.transformer.resblocks.11.mlp.c_proj.weight', 'model.visual.transformer.resblocks.11.mlp.c_proj.bias', 'model.visual.transformer.resblocks.11.ln_2.weight', 'model.visual.transformer.resblocks.11.ln_2.bias', 'model.transformer.resblocks.11.attn.in_proj_weight', 'model.transformer.resblocks.11.attn.in_proj_bias', 'model.transformer.resblocks.11.attn.out_proj.weight', 'model.transformer.resblocks.11.attn.out_proj.bias', 'model.transformer.resblocks.11.ln_1.weight', 'model.transformer.resblocks.11.ln_1.bias', 'model.transformer.resblocks.11.mlp.c_fc.weight', 'model.transformer.resblocks.11.mlp.c_fc.bias', 'model.transformer.resblocks.11.mlp.c_proj.weight', 'model.transformer.resblocks.11.mlp.c_proj.bias', 'model.transformer.resblocks.11.ln_2.weight', 'model.transformer.resblocks.11.ln_2.bias', 'image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2023-10-30 02:57:42,898 - INFO - Parameters in classifier with big lr: ['image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2023-10-30 02:57:55,403 - INFO - len of train dataset: 75750
2023-10-30 02:57:55,420 - INFO - len of test dataset: 56625
2023-10-30 02:57:55,421 - INFO - Pseudo Nums: 336
2023-10-30 03:03:52,511 - INFO - len of image_to_class_map: 17861
2023-10-30 03:03:52,566 - INFO - len of image_to_class_map_i: 21755
2023-10-30 03:14:17,635 - INFO - Before Train Accuracies: All 0.1095 | Old 0.0596 | New 0.1350
2023-10-30 03:14:17,667 - INFO - Before Train Accuracies: All 0.0776 | Old 0.0262 | New 0.1037
2023-10-30 03:25:45,692 - INFO - Epoch 1/200, Total Loss: 4.8962, Cls Loss: 3.1614, Cluster Loss: 3.6748, New Loss: 0.0000, Clip tag Loss: 1.3498
2023-10-30 03:25:45,726 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2023-10-30 03:25:45,727 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-10-30 03:33:39,558 - INFO - Text classifier Epoch 0 Train Accuracies: All 0.7244 | Old 0.8951 | New 0.6374
2023-10-30 03:33:39,584 - INFO - Image classifier Epoch 0 Train Accuracies: All 0.5879 | Old 0.8466 | New 0.4560
2023-10-30 03:37:24,172 - INFO - Weighted Accuracies: All 0.5375 | Old 0.8453 | New 0.3805
2023-10-30 03:42:03,027 - INFO - len of image_to_class_map: 33725
2023-10-30 03:42:03,028 - INFO - len of image_to_class_map_i: 33875
2023-10-30 03:52:45,773 - INFO - Epoch 2/200, Total Loss: 3.4364, Cls Loss: 1.5085, Cluster Loss: 2.3782, New Loss: 0.0000, Clip tag Loss: 1.2756
2023-10-30 03:52:45,859 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2023-10-30 03:52:45,859 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-10-30 03:58:53,513 - INFO - Text classifier Epoch 1 Train Accuracies: All 0.6934 | Old 0.8957 | New 0.5902
2023-10-30 03:58:53,550 - INFO - Image classifier Epoch 1 Train Accuracies: All 0.5763 | Old 0.8418 | New 0.4409
2023-10-30 04:03:07,525 - INFO - Weighted Accuracies: All 0.5385 | Old 0.8813 | New 0.3637
2023-10-30 04:07:48,963 - INFO - len of image_to_class_map: 33906
2023-10-30 04:07:48,963 - INFO - len of image_to_class_map_i: 33908
2023-10-30 04:17:49,554 - INFO - Epoch 3/200, Total Loss: 3.3313, Cls Loss: 1.3673, Cluster Loss: 2.3352, New Loss: 0.0000, Clip tag Loss: 1.2380
2023-10-30 04:17:49,571 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2023-10-30 04:17:49,571 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-10-30 04:24:11,758 - INFO - Text classifier Epoch 2 Train Accuracies: All 0.6728 | Old 0.8936 | New 0.5602
2023-10-30 04:24:11,759 - INFO - Image classifier Epoch 2 Train Accuracies: All 0.5638 | Old 0.8413 | New 0.4223
2023-10-30 04:28:06,197 - INFO - Weighted Accuracies: All 0.5221 | Old 0.8478 | New 0.3560
2023-10-30 04:32:32,871 - INFO - len of image_to_class_map: 33750
2023-10-30 04:32:32,914 - INFO - len of image_to_class_map_i: 33917
2023-10-30 04:42:52,542 - INFO - Epoch 4/200, Total Loss: 3.2567, Cls Loss: 1.2745, Cluster Loss: 2.3079, New Loss: 0.0000, Clip tag Loss: 1.2072
2023-10-30 04:42:52,571 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2023-10-30 04:42:52,571 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-10-30 04:49:05,232 - INFO - Text classifier Epoch 3 Train Accuracies: All 0.6396 | Old 0.8944 | New 0.5097
2023-10-30 04:49:05,260 - INFO - Image classifier Epoch 3 Train Accuracies: All 0.5635 | Old 0.8438 | New 0.4206
2023-10-30 04:53:27,436 - INFO - Weighted Accuracies: All 0.5105 | Old 0.8631 | New 0.3307
2023-10-30 04:57:42,002 - INFO - len of image_to_class_map: 33761
2023-10-30 04:57:42,003 - INFO - len of image_to_class_map_i: 33918
2023-10-30 05:07:04,062 - INFO - Epoch 5/200, Total Loss: 3.2144, Cls Loss: 1.2371, Cluster Loss: 2.2865, New Loss: 0.0000, Clip tag Loss: 1.1903
2023-10-30 05:07:04,073 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2023-10-30 05:07:04,073 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-10-30 05:13:23,331 - INFO - Text classifier Epoch 4 Train Accuracies: All 0.6401 | Old 0.8930 | New 0.5111
2023-10-30 05:13:23,358 - INFO - Image classifier Epoch 4 Train Accuracies: All 0.5668 | Old 0.8363 | New 0.4293
2023-10-30 05:17:17,322 - INFO - Weighted Accuracies: All 0.5159 | Old 0.8820 | New 0.3291
2023-10-30 05:21:35,402 - INFO - len of image_to_class_map: 33630
2023-10-30 05:21:35,451 - INFO - len of image_to_class_map_i: 33922
2023-10-30 05:30:30,476 - INFO - Epoch 6/200, Total Loss: 3.1904, Cls Loss: 1.1994, Cluster Loss: 2.2784, New Loss: 0.0000, Clip tag Loss: 1.1818
2023-10-30 05:30:30,491 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2023-10-30 05:30:30,491 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-10-30 05:36:14,454 - INFO - Text classifier Epoch 5 Train Accuracies: All 0.6279 | Old 0.8922 | New 0.4931
2023-10-30 05:36:14,499 - INFO - Image classifier Epoch 5 Train Accuracies: All 0.5637 | Old 0.8337 | New 0.4260
2023-10-30 05:40:12,202 - INFO - Weighted Accuracies: All 0.5154 | Old 0.8647 | New 0.3373
2023-10-30 05:44:20,097 - INFO - len of image_to_class_map: 33891
2023-10-30 05:44:20,142 - INFO - len of image_to_class_map_i: 33887
2023-10-30 05:54:21,600 - INFO - Epoch 7/200, Total Loss: 3.1528, Cls Loss: 1.1377, Cluster Loss: 2.2618, New Loss: 0.0000, Clip tag Loss: 1.1720
2023-10-30 05:54:21,630 - INFO -    Param Group: classifier_head, Learning Rate: 0.0997
2023-10-30 05:54:21,630 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-10-30 06:01:42,441 - INFO - Text classifier Epoch 6 Train Accuracies: All 0.6268 | Old 0.8912 | New 0.4920
2023-10-30 06:01:42,476 - INFO - Image classifier Epoch 6 Train Accuracies: All 0.5685 | Old 0.8483 | New 0.4258
2023-10-30 06:05:03,540 - INFO - Weighted Accuracies: All 0.5150 | Old 0.8328 | New 0.3529
2023-10-30 06:09:32,213 - INFO - len of image_to_class_map: 33839
2023-10-30 06:09:32,214 - INFO - len of image_to_class_map_i: 33897
2023-10-30 06:19:46,624 - INFO - Epoch 8/200, Total Loss: 3.1279, Cls Loss: 1.1347, Cluster Loss: 2.2421, New Loss: 0.0000, Clip tag Loss: 1.1626
2023-10-30 06:19:46,657 - INFO -    Param Group: classifier_head, Learning Rate: 0.0996
2023-10-30 06:19:46,657 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2023-10-30 06:26:37,303 - INFO - Text classifier Epoch 7 Train Accuracies: All 0.6410 | Old 0.8889 | New 0.5146
2023-10-30 06:26:37,326 - INFO - Image classifier Epoch 7 Train Accuracies: All 0.5625 | Old 0.8383 | New 0.4218
2023-10-30 06:30:43,865 - INFO - Weighted Accuracies: All 0.4992 | Old 0.8657 | New 0.3123
2023-10-30 06:35:06,175 - INFO - len of image_to_class_map: 33746
2023-10-30 06:35:06,175 - INFO - len of image_to_class_map_i: 33918
2023-10-30 06:44:50,251 - INFO - Epoch 9/200, Total Loss: 3.1081, Cls Loss: 1.1285, Cluster Loss: 2.2295, New Loss: 0.0000, Clip tag Loss: 1.1538
2023-10-30 06:44:50,281 - INFO -    Param Group: classifier_head, Learning Rate: 0.0995
2023-10-30 06:44:50,281 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
