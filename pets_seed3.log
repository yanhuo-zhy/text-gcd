2024-12-07 08:57:12,046 - INFO - Training pets_seed0 with the following settings:
2024-12-07 08:57:12,046 - INFO - Command-line arguments: output_dir=exp_iscap
 experiment_name=pets_seed0
 seed_num=0
 evaluate=False
 dataset_name=pets
 backbone_name=ViT-B/16
 epochs=200
 base_lr=0.0005
 classifier_lr=0.1
 momentum=0.9
 weight_decay=0.0001
 num_workers=8
 batch_size=128
 prop_train_labels=0.5
 image_size=224
 crop_pct=0.875
 interpolation=3
 transform=imagenet
 alpha_sr=0
 alpha_ri=0.05
 alpha_rs=0.05
 alpha_rd=0.05
 pseudo_ratio=0.6
 lambda_loss=0.2
 coteaching_epoch_t=10
 coteaching_epoch_i=15
 max_kmeans_iter=10
 k_means_init=20
 interrupted_path=
 train_classes=range(0, 19)
 unlabeled_classes=range(19, 37)
 num_labeled_classes=19
 num_unlabeled_classes=18
 num_classes=37
 log_path=exp_iscap/pets_seed0/logs/log.txt
 model_path=exp_iscap/pets_seed0/models/model.pth
 device=cuda
2024-12-07 08:57:12,049 - INFO - Loading CLIP (backbone: ViT-B/16)
2024-12-07 08:57:14,675 - INFO - Building custom CLIP
/leonardo/home/userexternal/hzheng00/miniconda3/envs/textgcd/lib/python3.9/site-packages/torch/nn/utils/weight_norm.py:134: FutureWarning: `torch.nn.utils.weight_norm` is deprecated in favor of `torch.nn.utils.parametrizations.weight_norm`.
  WeightNorm.apply(module, name, dim)
2024-12-07 08:57:16,014 - INFO - Turning off gradients in both the image and the text encoder
2024-12-07 08:57:16,016 - INFO - Parameters that require gradients: ['model.text_projection', 'model.visual.proj', 'model.visual.transformer.resblocks.11.attn.in_proj_weight', 'model.visual.transformer.resblocks.11.attn.in_proj_bias', 'model.visual.transformer.resblocks.11.attn.out_proj.weight', 'model.visual.transformer.resblocks.11.attn.out_proj.bias', 'model.visual.transformer.resblocks.11.ln_1.weight', 'model.visual.transformer.resblocks.11.ln_1.bias', 'model.visual.transformer.resblocks.11.mlp.c_fc.weight', 'model.visual.transformer.resblocks.11.mlp.c_fc.bias', 'model.visual.transformer.resblocks.11.mlp.c_proj.weight', 'model.visual.transformer.resblocks.11.mlp.c_proj.bias', 'model.visual.transformer.resblocks.11.ln_2.weight', 'model.visual.transformer.resblocks.11.ln_2.bias', 'model.transformer.resblocks.11.attn.in_proj_weight', 'model.transformer.resblocks.11.attn.in_proj_bias', 'model.transformer.resblocks.11.attn.out_proj.weight', 'model.transformer.resblocks.11.attn.out_proj.bias', 'model.transformer.resblocks.11.ln_1.weight', 'model.transformer.resblocks.11.ln_1.bias', 'model.transformer.resblocks.11.mlp.c_fc.weight', 'model.transformer.resblocks.11.mlp.c_fc.bias', 'model.transformer.resblocks.11.mlp.c_proj.weight', 'model.transformer.resblocks.11.mlp.c_proj.bias', 'model.transformer.resblocks.11.ln_2.weight', 'model.transformer.resblocks.11.ln_2.bias', 'image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2024-12-07 08:57:16,017 - INFO - Parameters in classifier with big lr: ['image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
/leonardo/home/userexternal/hzheng00/miniconda3/envs/textgcd/lib/python3.9/site-packages/torch/utils/data/dataloader.py:557: UserWarning: This DataLoader will create 8 worker processes in total. Our suggested max number of worker in current system is 4, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2024-12-07 08:57:16,951 - INFO - len of train dataset: 3680
2024-12-07 08:57:16,951 - INFO - len of test dataset: 2738
2024-12-07 08:57:16,951 - INFO - Pseudo Nums: 44
len of train_labelled 942
len of train_unlabelled 2738
2024-12-07 08:57:37,118 - INFO - len of image_to_class_map: 908
2024-12-07 08:57:37,118 - INFO - len of image_to_class_map_i: 1110
logits_text.shape torch.Size([2738, 37])
logits_image.shape torch.Size([2738, 37])
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:07<01:45,  7.57s/it] 13%|█▎        | 2/15 [00:08<00:45,  3.51s/it] 20%|██        | 3/15 [00:08<00:26,  2.21s/it] 27%|██▋       | 4/15 [00:09<00:17,  1.60s/it] 33%|███▎      | 5/15 [00:10<00:12,  1.26s/it] 40%|████      | 6/15 [00:10<00:09,  1.06s/it] 47%|████▋     | 7/15 [00:11<00:07,  1.08it/s] 53%|█████▎    | 8/15 [00:12<00:05,  1.19it/s] 60%|██████    | 9/15 [00:13<00:04,  1.20it/s] 67%|██████▋   | 10/15 [00:13<00:03,  1.28it/s] 73%|███████▎  | 11/15 [00:14<00:02,  1.35it/s] 80%|████████  | 12/15 [00:14<00:02,  1.39it/s] 87%|████████▋ | 13/15 [00:15<00:01,  1.43it/s] 93%|█████████▎| 14/15 [00:16<00:00,  1.46it/s]100%|██████████| 15/15 [00:16<00:00,  1.81it/s]100%|██████████| 15/15 [00:16<00:00,  1.12s/it]
2024-12-07 08:57:53,938 - INFO - Before Train Accuracies: All 0.0635 | Old 0.0548 | New 0.0727
2024-12-07 08:57:53,938 - INFO - Before Train Accuracies: All 0.1199 | Old 0.1675 | New 0.0699
Training:   0%|          | 0/28 [00:00<?, ?it/s]Training:   4%|▎         | 1/28 [00:05<02:40,  5.95s/it]Training:   7%|▋         | 2/28 [00:06<01:16,  2.96s/it]Training:  11%|█         | 3/28 [00:07<00:50,  2.04s/it]Training:  14%|█▍        | 4/28 [00:08<00:37,  1.56s/it]Training:  18%|█▊        | 5/28 [00:09<00:29,  1.29s/it]Training:  21%|██▏       | 6/28 [00:10<00:25,  1.14s/it]Training:  25%|██▌       | 7/28 [00:11<00:21,  1.04s/it]Training:  29%|██▊       | 8/28 [00:11<00:19,  1.04it/s]Training:  32%|███▏      | 9/28 [00:12<00:17,  1.10it/s]Training:  36%|███▌      | 10/28 [00:13<00:15,  1.13it/s]Training:  39%|███▉      | 11/28 [00:14<00:14,  1.17it/s]Training:  43%|████▎     | 12/28 [00:15<00:13,  1.19it/s]Training:  46%|████▋     | 13/28 [00:15<00:12,  1.21it/s]Training:  50%|█████     | 14/28 [00:16<00:11,  1.23it/s]Training:  54%|█████▎    | 15/28 [00:17<00:10,  1.25it/s]Training:  57%|█████▋    | 16/28 [00:18<00:09,  1.26it/s]Training:  61%|██████    | 17/28 [00:18<00:08,  1.27it/s]Training:  64%|██████▍   | 18/28 [00:19<00:07,  1.28it/s]Training:  68%|██████▊   | 19/28 [00:20<00:07,  1.28it/s]Training:  71%|███████▏  | 20/28 [00:21<00:06,  1.29it/s]Training:  75%|███████▌  | 21/28 [00:22<00:05,  1.29it/s]Training:  79%|███████▊  | 22/28 [00:22<00:04,  1.29it/s]Training:  82%|████████▏ | 23/28 [00:23<00:03,  1.29it/s]Training:  86%|████████▌ | 24/28 [00:24<00:03,  1.29it/s]Training:  89%|████████▉ | 25/28 [00:25<00:02,  1.30it/s]Training:  93%|█████████▎| 26/28 [00:25<00:01,  1.30it/s]Training:  96%|█████████▋| 27/28 [00:26<00:00,  1.30it/s]Training: 100%|██████████| 28/28 [00:27<00:00,  1.30it/s]Training: 100%|██████████| 28/28 [00:27<00:00,  1.01it/s]
2024-12-07 08:58:21,658 - INFO - Epoch 1/200, Total Loss: 13.1849, Cls Loss: 10.2954, Cluster Loss: 9.9126, New Loss: 0.0000, Clip tag Loss: 3.1958
2024-12-07 08:58:21,658 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2024-12-07 08:58:21,658 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:04<01:04,  4.64s/it] 13%|█▎        | 2/15 [00:05<00:29,  2.30s/it] 20%|██        | 3/15 [00:05<00:18,  1.55s/it] 27%|██▋       | 4/15 [00:06<00:13,  1.20s/it] 33%|███▎      | 5/15 [00:07<00:10,  1.01s/it] 40%|████      | 6/15 [00:07<00:08,  1.12it/s] 47%|████▋     | 7/15 [00:08<00:06,  1.23it/s] 53%|█████▎    | 8/15 [00:09<00:05,  1.31it/s] 60%|██████    | 9/15 [00:09<00:04,  1.37it/s] 67%|██████▋   | 10/15 [00:10<00:03,  1.41it/s] 73%|███████▎  | 11/15 [00:11<00:02,  1.44it/s] 80%|████████  | 12/15 [00:11<00:02,  1.46it/s] 87%|████████▋ | 13/15 [00:12<00:01,  1.48it/s] 93%|█████████▎| 14/15 [00:13<00:00,  1.49it/s]100%|██████████| 15/15 [00:13<00:00,  1.85it/s]100%|██████████| 15/15 [00:13<00:00,  1.09it/s]
2024-12-07 08:58:35,389 - INFO - Text classifier Epoch 0 Train Accuracies: All 0.0463 | Old 0.0553 | New 0.0369
2024-12-07 08:58:35,389 - INFO - Image classifier Epoch 0 Train Accuracies: All 0.0545 | Old 0.0532 | New 0.0559
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:04<01:04,  4.57s/it] 13%|█▎        | 2/15 [00:05<00:29,  2.27s/it] 20%|██        | 3/15 [00:05<00:18,  1.54s/it] 27%|██▋       | 4/15 [00:06<00:13,  1.19s/it] 33%|███▎      | 5/15 [00:07<00:10,  1.00s/it] 40%|████      | 6/15 [00:07<00:07,  1.13it/s] 47%|████▋     | 7/15 [00:08<00:06,  1.23it/s] 53%|█████▎    | 8/15 [00:09<00:05,  1.31it/s] 60%|██████    | 9/15 [00:09<00:04,  1.37it/s] 67%|██████▋   | 10/15 [00:10<00:03,  1.41it/s] 73%|███████▎  | 11/15 [00:11<00:02,  1.44it/s] 80%|████████  | 12/15 [00:11<00:02,  1.46it/s] 87%|████████▋ | 13/15 [00:12<00:01,  1.48it/s] 93%|█████████▎| 14/15 [00:13<00:00,  1.49it/s]100%|██████████| 15/15 [00:13<00:00,  1.85it/s]100%|██████████| 15/15 [00:13<00:00,  1.10it/s]
2024-12-07 08:58:49,030 - INFO - Weighted Accuracies: All 0.0676 | Old 0.0728 | New 0.0621
2024-12-07 08:59:00,125 - INFO - len of image_to_class_map: 547
2024-12-07 08:59:00,125 - INFO - len of image_to_class_map_i: 383
logits_text.shape torch.Size([2738, 37])
logits_image.shape torch.Size([2738, 37])
Training:   0%|          | 0/28 [00:00<?, ?it/s]Training:   4%|▎         | 1/28 [00:05<02:17,  5.10s/it]Training:   7%|▋         | 2/28 [00:06<01:08,  2.63s/it]Training:  11%|█         | 3/28 [00:06<00:46,  1.87s/it]Training:  14%|█▍        | 4/28 [00:07<00:34,  1.45s/it]Training:  18%|█▊        | 5/28 [00:08<00:28,  1.23s/it]Training:  21%|██▏       | 6/28 [00:09<00:24,  1.09s/it]Training:  25%|██▌       | 7/28 [00:10<00:21,  1.00s/it]Training:  29%|██▊       | 8/28 [00:11<00:18,  1.07it/s]Training:  32%|███▏      | 9/28 [00:11<00:17,  1.11it/s]Training:  36%|███▌      | 10/28 [00:12<00:15,  1.16it/s]Training:  39%|███▉      | 11/28 [00:13<00:14,  1.19it/s]Training:  43%|████▎     | 12/28 [00:14<00:13,  1.20it/s]Training:  46%|████▋     | 13/28 [00:15<00:12,  1.22it/s]Training:  50%|█████     | 14/28 [00:15<00:11,  1.24it/s]Training:  54%|█████▎    | 15/28 [00:16<00:10,  1.26it/s]Training:  57%|█████▋    | 16/28 [00:17<00:09,  1.27it/s]Training:  61%|██████    | 17/28 [00:18<00:08,  1.28it/s]Training:  64%|██████▍   | 18/28 [00:18<00:07,  1.28it/s]Training:  68%|██████▊   | 19/28 [00:19<00:06,  1.29it/s]Training:  71%|███████▏  | 20/28 [00:20<00:06,  1.29it/s]Training:  75%|███████▌  | 21/28 [00:21<00:05,  1.29it/s]Training:  79%|███████▊  | 22/28 [00:21<00:04,  1.29it/s]Training:  82%|████████▏ | 23/28 [00:22<00:03,  1.29it/s]Training:  86%|████████▌ | 24/28 [00:23<00:03,  1.29it/s]Training:  89%|████████▉ | 25/28 [00:24<00:02,  1.30it/s]Training:  93%|█████████▎| 26/28 [00:25<00:01,  1.30it/s]Training:  96%|█████████▋| 27/28 [00:25<00:00,  1.30it/s]Training: 100%|██████████| 28/28 [00:26<00:00,  1.30it/s]Training: 100%|██████████| 28/28 [00:26<00:00,  1.04it/s]
2024-12-07 08:59:27,023 - INFO - Epoch 2/200, Total Loss: 10.8456, Cls Loss: 6.5974, Cluster Loss: 8.2624, New Loss: 0.0000, Clip tag Loss: 2.9162
2024-12-07 08:59:27,023 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2024-12-07 08:59:27,023 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:04<01:04,  4.64s/it] 13%|█▎        | 2/15 [00:05<00:29,  2.30s/it] 20%|██        | 3/15 [00:05<00:18,  1.55s/it] 27%|██▋       | 4/15 [00:06<00:13,  1.20s/it] 33%|███▎      | 5/15 [00:07<00:10,  1.00s/it] 40%|████      | 6/15 [00:07<00:07,  1.13it/s] 47%|████▋     | 7/15 [00:08<00:06,  1.23it/s] 53%|█████▎    | 8/15 [00:09<00:05,  1.31it/s] 60%|██████    | 9/15 [00:09<00:04,  1.37it/s] 67%|██████▋   | 10/15 [00:10<00:03,  1.41it/s] 73%|███████▎  | 11/15 [00:11<00:02,  1.44it/s] 80%|████████  | 12/15 [00:11<00:02,  1.46it/s] 87%|████████▋ | 13/15 [00:12<00:01,  1.48it/s] 93%|█████████▎| 14/15 [00:13<00:00,  1.49it/s]100%|██████████| 15/15 [00:13<00:00,  1.85it/s]100%|██████████| 15/15 [00:13<00:00,  1.09it/s]
2024-12-07 08:59:40,738 - INFO - Text classifier Epoch 1 Train Accuracies: All 0.2099 | Old 0.2010 | New 0.2192
2024-12-07 08:59:40,738 - INFO - Image classifier Epoch 1 Train Accuracies: All 0.3742 | Old 0.6491 | New 0.0850
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:04<01:04,  4.62s/it] 13%|█▎        | 2/15 [00:05<00:29,  2.29s/it] 20%|██        | 3/15 [00:05<00:18,  1.55s/it] 27%|██▋       | 4/15 [00:06<00:13,  1.20s/it] 33%|███▎      | 5/15 [00:07<00:10,  1.01s/it] 40%|████      | 6/15 [00:07<00:07,  1.13it/s] 47%|████▋     | 7/15 [00:08<00:06,  1.23it/s] 53%|█████▎    | 8/15 [00:09<00:05,  1.31it/s] 60%|██████    | 9/15 [00:09<00:04,  1.37it/s] 67%|██████▋   | 10/15 [00:10<00:03,  1.41it/s] 73%|███████▎  | 11/15 [00:11<00:02,  1.44it/s] 80%|████████  | 12/15 [00:11<00:02,  1.46it/s] 87%|████████▋ | 13/15 [00:12<00:01,  1.48it/s] 93%|█████████▎| 14/15 [00:13<00:00,  1.49it/s]100%|██████████| 15/15 [00:13<00:00,  1.85it/s]100%|██████████| 15/15 [00:13<00:00,  1.09it/s]
2024-12-07 08:59:54,455 - INFO - Weighted Accuracies: All 0.2407 | Old 0.1988 | New 0.2847
2024-12-07 09:00:05,440 - INFO - len of image_to_class_map: 1084
2024-12-07 09:00:05,440 - INFO - len of image_to_class_map_i: 1102
logits_text.shape torch.Size([2738, 37])
logits_image.shape torch.Size([2738, 37])
Training:   0%|          | 0/28 [00:00<?, ?it/s]Training:   4%|▎         | 1/28 [00:04<02:11,  4.87s/it]Training:   7%|▋         | 2/28 [00:05<01:06,  2.57s/it]Training:  11%|█         | 3/28 [00:06<00:45,  1.82s/it]Training:  14%|█▍        | 4/28 [00:07<00:34,  1.44s/it]Training:  18%|█▊        | 5/28 [00:08<00:28,  1.24s/it]Training:  21%|██▏       | 6/28 [00:09<00:24,  1.10s/it]Training:  25%|██▌       | 7/28 [00:10<00:21,  1.00s/it]Training:  29%|██▊       | 8/28 [00:10<00:18,  1.07it/s]Training:  32%|███▏      | 9/28 [00:11<00:17,  1.11it/s]Training:  36%|███▌      | 10/28 [00:12<00:15,  1.15it/s]Training:  39%|███▉      | 11/28 [00:13<00:14,  1.18it/s]Training:  43%|████▎     | 12/28 [00:14<00:13,  1.20it/s]Training:  46%|████▋     | 13/28 [00:14<00:12,  1.21it/s]Training:  50%|█████     | 14/28 [00:15<00:11,  1.24it/s]Training:  54%|█████▎    | 15/28 [00:16<00:10,  1.25it/s]Training:  57%|█████▋    | 16/28 [00:17<00:09,  1.27it/s]Training:  61%|██████    | 17/28 [00:18<00:08,  1.27it/s]Training:  64%|██████▍   | 18/28 [00:18<00:07,  1.28it/s]Training:  68%|██████▊   | 19/28 [00:19<00:06,  1.29it/s]Training:  71%|███████▏  | 20/28 [00:20<00:06,  1.29it/s]Training:  75%|███████▌  | 21/28 [00:21<00:05,  1.29it/s]Training:  79%|███████▊  | 22/28 [00:21<00:04,  1.30it/s]Training:  82%|████████▏ | 23/28 [00:22<00:03,  1.30it/s]Training:  86%|████████▌ | 24/28 [00:23<00:03,  1.30it/s]Training:  89%|████████▉ | 25/28 [00:24<00:02,  1.30it/s]Training:  93%|█████████▎| 26/28 [00:24<00:01,  1.30it/s]Training:  96%|█████████▋| 27/28 [00:25<00:00,  1.30it/s]Training: 100%|██████████| 28/28 [00:26<00:00,  1.29it/s]Training: 100%|██████████| 28/28 [00:26<00:00,  1.05it/s]
2024-12-07 09:00:32,227 - INFO - Epoch 3/200, Total Loss: 7.0676, Cls Loss: 3.6873, Cluster Loss: 4.4552, New Loss: 0.0000, Clip tag Loss: 2.7660
2024-12-07 09:00:32,227 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2024-12-07 09:00:32,227 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:04<01:05,  4.65s/it] 13%|█▎        | 2/15 [00:05<00:29,  2.30s/it] 20%|██        | 3/15 [00:05<00:18,  1.55s/it] 27%|██▋       | 4/15 [00:06<00:13,  1.20s/it] 33%|███▎      | 5/15 [00:07<00:10,  1.01s/it] 40%|████      | 6/15 [00:07<00:07,  1.13it/s] 47%|████▋     | 7/15 [00:08<00:06,  1.23it/s] 53%|█████▎    | 8/15 [00:09<00:05,  1.31it/s] 60%|██████    | 9/15 [00:09<00:04,  1.37it/s] 67%|██████▋   | 10/15 [00:10<00:03,  1.41it/s] 73%|███████▎  | 11/15 [00:11<00:02,  1.44it/s] 80%|████████  | 12/15 [00:11<00:02,  1.46it/s] 87%|████████▋ | 13/15 [00:12<00:01,  1.48it/s] 93%|█████████▎| 14/15 [00:13<00:00,  1.49it/s]100%|██████████| 15/15 [00:13<00:00,  1.85it/s]100%|██████████| 15/15 [00:13<00:00,  1.09it/s]
2024-12-07 09:00:45,949 - INFO - Text classifier Epoch 2 Train Accuracies: All 0.2494 | Old 0.2472 | New 0.2517
2024-12-07 09:00:45,949 - INFO - Image classifier Epoch 2 Train Accuracies: All 0.5154 | Old 0.7390 | New 0.2802
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:04<01:02,  4.47s/it] 13%|█▎        | 2/15 [00:05<00:29,  2.23s/it] 20%|██        | 3/15 [00:05<00:18,  1.53s/it] 27%|██▋       | 4/15 [00:06<00:13,  1.19s/it] 33%|███▎      | 5/15 [00:07<00:09,  1.00it/s] 40%|████      | 6/15 [00:07<00:07,  1.13it/s] 47%|████▋     | 7/15 [00:08<00:06,  1.24it/s] 53%|█████▎    | 8/15 [00:09<00:05,  1.31it/s] 60%|██████    | 9/15 [00:09<00:04,  1.37it/s] 67%|██████▋   | 10/15 [00:10<00:03,  1.42it/s] 73%|███████▎  | 11/15 [00:11<00:02,  1.45it/s] 80%|████████  | 12/15 [00:11<00:02,  1.47it/s] 87%|████████▋ | 13/15 [00:12<00:01,  1.48it/s] 93%|█████████▎| 14/15 [00:13<00:00,  1.49it/s]100%|██████████| 15/15 [00:13<00:00,  1.85it/s]100%|██████████| 15/15 [00:13<00:00,  1.10it/s]
2024-12-07 09:00:59,536 - INFO - Weighted Accuracies: All 0.3396 | Old 0.3328 | New 0.3468
2024-12-07 09:01:10,721 - INFO - len of image_to_class_map: 1442
2024-12-07 09:01:10,722 - INFO - len of image_to_class_map_i: 1300
logits_text.shape torch.Size([2738, 37])
logits_image.shape torch.Size([2738, 37])
Training:   0%|          | 0/28 [00:00<?, ?it/s]Training:   4%|▎         | 1/28 [00:05<02:16,  5.07s/it]Training:   7%|▋         | 2/28 [00:05<01:08,  2.62s/it]Training:  11%|█         | 3/28 [00:06<00:45,  1.82s/it]Training:  14%|█▍        | 4/28 [00:07<00:34,  1.43s/it]Training:  18%|█▊        | 5/28 [00:08<00:28,  1.23s/it]Training:  21%|██▏       | 6/28 [00:09<00:24,  1.09s/it]Training:  25%|██▌       | 7/28 [00:10<00:21,  1.00s/it]Training:  29%|██▊       | 8/28 [00:10<00:18,  1.07it/s]Training:  32%|███▏      | 9/28 [00:11<00:17,  1.12it/s]Training:  36%|███▌      | 10/28 [00:12<00:15,  1.16it/s]Training:  39%|███▉      | 11/28 [00:13<00:14,  1.19it/s]Training:  43%|████▎     | 12/28 [00:14<00:13,  1.21it/s]Training:  46%|████▋     | 13/28 [00:14<00:12,  1.22it/s]Training:  50%|█████     | 14/28 [00:15<00:11,  1.24it/s]Training:  54%|█████▎    | 15/28 [00:16<00:10,  1.26it/s]Training:  57%|█████▋    | 16/28 [00:17<00:09,  1.27it/s]Training:  61%|██████    | 17/28 [00:18<00:08,  1.28it/s]Training:  64%|██████▍   | 18/28 [00:18<00:07,  1.28it/s]Training:  68%|██████▊   | 19/28 [00:19<00:07,  1.29it/s]Training:  71%|███████▏  | 20/28 [00:20<00:06,  1.29it/s]Training:  75%|███████▌  | 21/28 [00:21<00:05,  1.29it/s]Training:  79%|███████▊  | 22/28 [00:21<00:04,  1.29it/s]Training:  82%|████████▏ | 23/28 [00:22<00:03,  1.29it/s]Training:  86%|████████▌ | 24/28 [00:23<00:03,  1.29it/s]Training:  89%|████████▉ | 25/28 [00:24<00:02,  1.29it/s]Training:  93%|█████████▎| 26/28 [00:25<00:01,  1.29it/s]Training:  96%|█████████▋| 27/28 [00:25<00:00,  1.29it/s]Training: 100%|██████████| 28/28 [00:26<00:00,  1.29it/s]Training: 100%|██████████| 28/28 [00:26<00:00,  1.04it/s]
2024-12-07 09:01:37,542 - INFO - Epoch 4/200, Total Loss: 6.1088, Cls Loss: 3.1163, Cluster Loss: 3.6195, New Loss: 0.0000, Clip tag Loss: 2.5900
2024-12-07 09:01:37,543 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2024-12-07 09:01:37,543 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:04<01:05,  4.65s/it] 13%|█▎        | 2/15 [00:05<00:30,  2.32s/it] 20%|██        | 3/15 [00:05<00:18,  1.56s/it] 27%|██▋       | 4/15 [00:06<00:13,  1.21s/it] 33%|███▎      | 5/15 [00:07<00:10,  1.01s/it] 40%|████      | 6/15 [00:07<00:07,  1.13it/s] 47%|████▋     | 7/15 [00:08<00:06,  1.23it/s] 53%|█████▎    | 8/15 [00:09<00:05,  1.31it/s] 60%|██████    | 9/15 [00:09<00:04,  1.37it/s] 67%|██████▋   | 10/15 [00:10<00:03,  1.41it/s] 73%|███████▎  | 11/15 [00:11<00:02,  1.44it/s] 80%|████████  | 12/15 [00:11<00:02,  1.46it/s] 87%|████████▋ | 13/15 [00:12<00:01,  1.48it/s] 93%|█████████▎| 14/15 [00:13<00:00,  1.49it/s]100%|██████████| 15/15 [00:13<00:00,  1.85it/s]100%|██████████| 15/15 [00:13<00:00,  1.09it/s]
2024-12-07 09:01:51,314 - INFO - Text classifier Epoch 3 Train Accuracies: All 0.2843 | Old 0.2892 | New 0.2791
2024-12-07 09:01:51,314 - INFO - Image classifier Epoch 3 Train Accuracies: All 0.5846 | Old 0.8347 | New 0.3216
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:04<01:04,  4.62s/it] 13%|█▎        | 2/15 [00:05<00:29,  2.29s/it] 20%|██        | 3/15 [00:05<00:18,  1.55s/it] 27%|██▋       | 4/15 [00:06<00:13,  1.20s/it] 33%|███▎      | 5/15 [00:07<00:10,  1.00s/it] 40%|████      | 6/15 [00:07<00:07,  1.13it/s] 47%|████▋     | 7/15 [00:08<00:06,  1.23it/s] 53%|█████▎    | 8/15 [00:09<00:05,  1.31it/s] 60%|██████    | 9/15 [00:09<00:04,  1.37it/s] 67%|██████▋   | 10/15 [00:10<00:03,  1.41it/s] 73%|███████▎  | 11/15 [00:11<00:02,  1.44it/s] 80%|████████  | 12/15 [00:11<00:02,  1.46it/s] 87%|████████▋ | 13/15 [00:12<00:01,  1.47it/s] 93%|█████████▎| 14/15 [00:13<00:00,  1.49it/s]100%|██████████| 15/15 [00:13<00:00,  1.85it/s]100%|██████████| 15/15 [00:13<00:00,  1.09it/s]
2024-12-07 09:02:05,047 - INFO - Weighted Accuracies: All 0.3952 | Old 0.4354 | New 0.3529
2024-12-07 09:02:16,176 - INFO - len of image_to_class_map: 1537
2024-12-07 09:02:16,177 - INFO - len of image_to_class_map_i: 1353
logits_text.shape torch.Size([2738, 37])
logits_image.shape torch.Size([2738, 37])
Training:   0%|          | 0/28 [00:00<?, ?it/s]Training:   4%|▎         | 1/28 [00:04<02:08,  4.75s/it]Training:   7%|▋         | 2/28 [00:05<01:04,  2.46s/it]Training:  11%|█         | 3/28 [00:06<00:43,  1.73s/it]Training:  14%|█▍        | 4/28 [00:07<00:32,  1.37s/it]Training:  18%|█▊        | 5/28 [00:08<00:27,  1.18s/it]Training:  21%|██▏       | 6/28 [00:08<00:23,  1.07s/it]Training:  25%|██▌       | 7/28 [00:09<00:20,  1.02it/s]Training:  29%|██▊       | 8/28 [00:10<00:18,  1.08it/s]Training:  32%|███▏      | 9/28 [00:11<00:16,  1.13it/s]Training:  36%|███▌      | 10/28 [00:12<00:15,  1.17it/s]Training:  39%|███▉      | 11/28 [00:12<00:14,  1.19it/s]Training:  43%|████▎     | 12/28 [00:13<00:13,  1.20it/s]Training:  46%|████▋     | 13/28 [00:14<00:12,  1.22it/s]Training:  50%|█████     | 14/28 [00:15<00:11,  1.24it/s]Training:  54%|█████▎    | 15/28 [00:16<00:10,  1.26it/s]Training:  57%|█████▋    | 16/28 [00:16<00:09,  1.27it/s]Training:  61%|██████    | 17/28 [00:17<00:08,  1.28it/s]Training:  64%|██████▍   | 18/28 [00:18<00:07,  1.28it/s]Training:  68%|██████▊   | 19/28 [00:19<00:06,  1.29it/s]Training:  71%|███████▏  | 20/28 [00:19<00:06,  1.29it/s]Training:  75%|███████▌  | 21/28 [00:20<00:05,  1.29it/s]Training:  79%|███████▊  | 22/28 [00:21<00:04,  1.29it/s]Training:  82%|████████▏ | 23/28 [00:22<00:03,  1.30it/s]Training:  86%|████████▌ | 24/28 [00:23<00:03,  1.30it/s]Training:  89%|████████▉ | 25/28 [00:23<00:02,  1.30it/s]Training:  93%|█████████▎| 26/28 [00:24<00:01,  1.29it/s]Training:  96%|█████████▋| 27/28 [00:25<00:00,  1.30it/s]Training: 100%|██████████| 28/28 [00:26<00:00,  1.30it/s]Training: 100%|██████████| 28/28 [00:26<00:00,  1.06it/s]
2024-12-07 09:02:42,618 - INFO - Epoch 5/200, Total Loss: 5.5272, Cls Loss: 2.7975, Cluster Loss: 3.0961, New Loss: 0.0000, Clip tag Loss: 2.4908
2024-12-07 09:02:42,618 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2024-12-07 09:02:42,619 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:04<01:05,  4.66s/it] 13%|█▎        | 2/15 [00:05<00:30,  2.33s/it] 20%|██        | 3/15 [00:06<00:18,  1.57s/it] 27%|██▋       | 4/15 [00:06<00:13,  1.21s/it] 33%|███▎      | 5/15 [00:07<00:10,  1.01s/it] 40%|████      | 6/15 [00:08<00:08,  1.12it/s] 47%|████▋     | 7/15 [00:08<00:06,  1.23it/s] 53%|█████▎    | 8/15 [00:09<00:05,  1.31it/s] 60%|██████    | 9/15 [00:09<00:04,  1.37it/s] 67%|██████▋   | 10/15 [00:10<00:03,  1.41it/s] 73%|███████▎  | 11/15 [00:11<00:02,  1.44it/s] 80%|████████  | 12/15 [00:11<00:02,  1.46it/s] 87%|████████▋ | 13/15 [00:12<00:01,  1.48it/s] 93%|█████████▎| 14/15 [00:13<00:00,  1.49it/s]100%|██████████| 15/15 [00:13<00:00,  1.84it/s]100%|██████████| 15/15 [00:13<00:00,  1.09it/s]
2024-12-07 09:02:56,410 - INFO - Text classifier Epoch 4 Train Accuracies: All 0.3025 | Old 0.3418 | New 0.2612
2024-12-07 09:02:56,410 - INFO - Image classifier Epoch 4 Train Accuracies: All 0.6162 | Old 0.8368 | New 0.3842
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:04<01:05,  4.67s/it] 13%|█▎        | 2/15 [00:05<00:30,  2.31s/it] 20%|██        | 3/15 [00:05<00:18,  1.56s/it] 27%|██▋       | 4/15 [00:06<00:13,  1.20s/it] 33%|███▎      | 5/15 [00:07<00:10,  1.01s/it] 40%|████      | 6/15 [00:07<00:08,  1.12it/s] 47%|████▋     | 7/15 [00:08<00:06,  1.23it/s] 53%|█████▎    | 8/15 [00:09<00:05,  1.31it/s] 60%|██████    | 9/15 [00:09<00:04,  1.37it/s] 67%|██████▋   | 10/15 [00:10<00:03,  1.41it/s] 73%|███████▎  | 11/15 [00:11<00:02,  1.45it/s] 80%|████████  | 12/15 [00:11<00:02,  1.47it/s] 87%|████████▋ | 13/15 [00:12<00:01,  1.48it/s] 93%|█████████▎| 14/15 [00:13<00:00,  1.50it/s]100%|██████████| 15/15 [00:13<00:00,  1.86it/s]100%|██████████| 15/15 [00:13<00:00,  1.09it/s]
2024-12-07 09:03:10,141 - INFO - Weighted Accuracies: All 0.3941 | Old 0.4519 | New 0.3333
2024-12-07 09:03:21,120 - INFO - len of image_to_class_map: 1542
2024-12-07 09:03:21,121 - INFO - len of image_to_class_map_i: 1372
logits_text.shape torch.Size([2738, 37])
logits_image.shape torch.Size([2738, 37])
Training:   0%|          | 0/28 [00:00<?, ?it/s]Training:   4%|▎         | 1/28 [00:04<01:52,  4.15s/it]Training:   7%|▋         | 2/28 [00:05<00:58,  2.24s/it]Training:  11%|█         | 3/28 [00:05<00:40,  1.63s/it]Training:  14%|█▍        | 4/28 [00:06<00:32,  1.33s/it]Training:  18%|█▊        | 5/28 [00:07<00:26,  1.16s/it]Training:  21%|██▏       | 6/28 [00:08<00:22,  1.05s/it]Training:  25%|██▌       | 7/28 [00:09<00:20,  1.02it/s]Training:  29%|██▊       | 8/28 [00:10<00:18,  1.06it/s]Training:  32%|███▏      | 9/28 [00:11<00:17,  1.11it/s]Training:  36%|███▌      | 10/28 [00:11<00:15,  1.15it/s]Training:  39%|███▉      | 11/28 [00:12<00:14,  1.17it/s]Training:  43%|████▎     | 12/28 [00:13<00:13,  1.20it/s]Training:  46%|████▋     | 13/28 [00:14<00:12,  1.22it/s]Training:  50%|█████     | 14/28 [00:14<00:11,  1.24it/s]Training:  54%|█████▎    | 15/28 [00:15<00:10,  1.26it/s]Training:  57%|█████▋    | 16/28 [00:16<00:09,  1.27it/s]Training:  61%|██████    | 17/28 [00:17<00:08,  1.28it/s]Training:  64%|██████▍   | 18/28 [00:18<00:07,  1.28it/s]Training:  68%|██████▊   | 19/28 [00:18<00:07,  1.29it/s]Training:  71%|███████▏  | 20/28 [00:19<00:06,  1.29it/s]Training:  75%|███████▌  | 21/28 [00:20<00:05,  1.29it/s]Training:  79%|███████▊  | 22/28 [00:21<00:04,  1.29it/s]Training:  82%|████████▏ | 23/28 [00:21<00:03,  1.29it/s]Training:  86%|████████▌ | 24/28 [00:22<00:03,  1.29it/s]Training:  89%|████████▉ | 25/28 [00:23<00:02,  1.29it/s]Training:  93%|█████████▎| 26/28 [00:24<00:01,  1.29it/s]Training:  96%|█████████▋| 27/28 [00:25<00:00,  1.30it/s]Training: 100%|██████████| 28/28 [00:25<00:00,  1.30it/s]Training: 100%|██████████| 28/28 [00:26<00:00,  1.07it/s]
2024-12-07 09:03:47,231 - INFO - Epoch 6/200, Total Loss: 5.1589, Cls Loss: 2.5360, Cluster Loss: 2.7723, New Loss: 0.0000, Clip tag Loss: 2.4339
2024-12-07 09:03:47,231 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2024-12-07 09:03:47,231 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:04<01:06,  4.73s/it] 13%|█▎        | 2/15 [00:05<00:30,  2.34s/it] 20%|██        | 3/15 [00:06<00:18,  1.57s/it] 27%|██▋       | 4/15 [00:06<00:13,  1.21s/it] 33%|███▎      | 5/15 [00:07<00:10,  1.01s/it] 40%|████      | 6/15 [00:08<00:08,  1.12it/s] 47%|████▋     | 7/15 [00:08<00:06,  1.23it/s] 53%|█████▎    | 8/15 [00:09<00:05,  1.31it/s] 60%|██████    | 9/15 [00:10<00:04,  1.37it/s] 67%|██████▋   | 10/15 [00:10<00:03,  1.41it/s] 73%|███████▎  | 11/15 [00:11<00:02,  1.44it/s] 80%|████████  | 12/15 [00:11<00:02,  1.46it/s] 87%|████████▋ | 13/15 [00:12<00:01,  1.48it/s] 93%|█████████▎| 14/15 [00:13<00:00,  1.48it/s]100%|██████████| 15/15 [00:13<00:00,  1.84it/s]100%|██████████| 15/15 [00:13<00:00,  1.08it/s]
2024-12-07 09:04:01,076 - INFO - Text classifier Epoch 5 Train Accuracies: All 0.3162 | Old 0.3445 | New 0.2864
2024-12-07 09:04:01,076 - INFO - Image classifier Epoch 5 Train Accuracies: All 0.6364 | Old 0.8682 | New 0.3926
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:04<01:05,  4.65s/it] 13%|█▎        | 2/15 [00:05<00:29,  2.30s/it] 20%|██        | 3/15 [00:05<00:18,  1.55s/it] 27%|██▋       | 4/15 [00:06<00:13,  1.20s/it] 33%|███▎      | 5/15 [00:07<00:10,  1.01s/it] 40%|████      | 6/15 [00:07<00:08,  1.12it/s] 47%|████▋     | 7/15 [00:08<00:06,  1.23it/s] 53%|█████▎    | 8/15 [00:09<00:05,  1.31it/s] 60%|██████    | 9/15 [00:09<00:04,  1.37it/s] 67%|██████▋   | 10/15 [00:10<00:03,  1.41it/s] 73%|███████▎  | 11/15 [00:11<00:02,  1.44it/s] 80%|████████  | 12/15 [00:11<00:02,  1.47it/s] 87%|████████▋ | 13/15 [00:12<00:01,  1.48it/s] 93%|█████████▎| 14/15 [00:13<00:00,  1.50it/s]100%|██████████| 15/15 [00:13<00:00,  1.86it/s]100%|██████████| 15/15 [00:13<00:00,  1.09it/s]
2024-12-07 09:04:14,815 - INFO - Weighted Accuracies: All 0.3957 | Old 0.4652 | New 0.3227
2024-12-07 09:04:25,866 - INFO - len of image_to_class_map: 1557
2024-12-07 09:04:25,866 - INFO - len of image_to_class_map_i: 1363
logits_text.shape torch.Size([2738, 37])
logits_image.shape torch.Size([2738, 37])
Training:   0%|          | 0/28 [00:00<?, ?it/s]Training:   4%|▎         | 1/28 [00:04<02:06,  4.69s/it]Training:   7%|▋         | 2/28 [00:05<01:03,  2.44s/it]Training:  11%|█         | 3/28 [00:06<00:43,  1.72s/it]Training:  14%|█▍        | 4/28 [00:07<00:32,  1.37s/it]Training:  18%|█▊        | 5/28 [00:08<00:27,  1.18s/it]Training:  21%|██▏       | 6/28 [00:08<00:23,  1.07s/it]Training:  25%|██▌       | 7/28 [00:09<00:20,  1.01it/s]Training:  29%|██▊       | 8/28 [00:10<00:18,  1.08it/s]Training:  32%|███▏      | 9/28 [00:11<00:16,  1.13it/s]Training:  36%|███▌      | 10/28 [00:12<00:15,  1.16it/s]Training:  39%|███▉      | 11/28 [00:12<00:14,  1.19it/s]Training:  43%|████▎     | 12/28 [00:13<00:13,  1.20it/s]Training:  46%|████▋     | 13/28 [00:14<00:12,  1.22it/s]Training:  50%|█████     | 14/28 [00:15<00:11,  1.24it/s]Training:  54%|█████▎    | 15/28 [00:16<00:10,  1.26it/s]Training:  57%|█████▋    | 16/28 [00:16<00:09,  1.27it/s]Training:  61%|██████    | 17/28 [00:17<00:08,  1.28it/s]Training:  64%|██████▍   | 18/28 [00:18<00:07,  1.28it/s]Training:  68%|██████▊   | 19/28 [00:19<00:07,  1.29it/s]Training:  71%|███████▏  | 20/28 [00:19<00:06,  1.29it/s]Training:  75%|███████▌  | 21/28 [00:20<00:05,  1.29it/s]Training:  79%|███████▊  | 22/28 [00:21<00:04,  1.29it/s]Training:  82%|████████▏ | 23/28 [00:22<00:03,  1.29it/s]Training:  86%|████████▌ | 24/28 [00:23<00:03,  1.29it/s]Training:  89%|████████▉ | 25/28 [00:23<00:02,  1.29it/s]Training:  93%|█████████▎| 26/28 [00:24<00:01,  1.29it/s]Training:  96%|█████████▋| 27/28 [00:25<00:00,  1.29it/s]Training: 100%|██████████| 28/28 [00:26<00:00,  1.29it/s]Training: 100%|██████████| 28/28 [00:26<00:00,  1.06it/s]
2024-12-07 09:04:52,314 - INFO - Epoch 7/200, Total Loss: 4.8293, Cls Loss: 2.2652, Cluster Loss: 2.5394, New Loss: 0.0000, Clip tag Loss: 2.3447
2024-12-07 09:04:52,314 - INFO -    Param Group: classifier_head, Learning Rate: 0.0997
2024-12-07 09:04:52,314 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:04<01:05,  4.66s/it] 13%|█▎        | 2/15 [00:05<00:29,  2.31s/it] 20%|██        | 3/15 [00:05<00:18,  1.55s/it] 27%|██▋       | 4/15 [00:06<00:13,  1.20s/it] 33%|███▎      | 5/15 [00:07<00:10,  1.01s/it] 40%|████      | 6/15 [00:07<00:07,  1.13it/s] 47%|████▋     | 7/15 [00:08<00:06,  1.23it/s] 53%|█████▎    | 8/15 [00:09<00:05,  1.31it/s] 60%|██████    | 9/15 [00:09<00:04,  1.37it/s] 67%|██████▋   | 10/15 [00:10<00:03,  1.41it/s] 73%|███████▎  | 11/15 [00:11<00:02,  1.44it/s] 80%|████████  | 12/15 [00:11<00:02,  1.46it/s] 87%|████████▋ | 13/15 [00:12<00:01,  1.48it/s] 93%|█████████▎| 14/15 [00:13<00:00,  1.49it/s]100%|██████████| 15/15 [00:13<00:00,  1.85it/s]100%|██████████| 15/15 [00:13<00:00,  1.09it/s]
2024-12-07 09:05:06,083 - INFO - Text classifier Epoch 6 Train Accuracies: All 0.3254 | Old 0.3620 | New 0.2869
2024-12-07 09:05:06,084 - INFO - Image classifier Epoch 6 Train Accuracies: All 0.6449 | Old 0.8708 | New 0.4072
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:04<01:03,  4.54s/it] 13%|█▎        | 2/15 [00:05<00:29,  2.29s/it] 20%|██        | 3/15 [00:05<00:18,  1.54s/it] 27%|██▋       | 4/15 [00:06<00:13,  1.19s/it] 33%|███▎      | 5/15 [00:07<00:10,  1.00s/it] 40%|████      | 6/15 [00:07<00:07,  1.13it/s] 47%|████▋     | 7/15 [00:08<00:06,  1.23it/s] 53%|█████▎    | 8/15 [00:09<00:05,  1.31it/s] 60%|██████    | 9/15 [00:09<00:04,  1.37it/s] 67%|██████▋   | 10/15 [00:10<00:03,  1.41it/s] 73%|███████▎  | 11/15 [00:11<00:02,  1.45it/s] 80%|████████  | 12/15 [00:11<00:02,  1.47it/s] 87%|████████▋ | 13/15 [00:12<00:01,  1.48it/s] 93%|█████████▎| 14/15 [00:13<00:00,  1.49it/s]100%|██████████| 15/15 [00:13<00:00,  1.85it/s]100%|██████████| 15/15 [00:13<00:00,  1.10it/s]
2024-12-07 09:05:19,726 - INFO - Weighted Accuracies: All 0.4132 | Old 0.4838 | New 0.3389
2024-12-07 09:05:30,877 - INFO - len of image_to_class_map: 1558
2024-12-07 09:05:30,878 - INFO - len of image_to_class_map_i: 1357
logits_text.shape torch.Size([2738, 37])
logits_image.shape torch.Size([2738, 37])
Training:   0%|          | 0/28 [00:00<?, ?it/s]Training:   4%|▎         | 1/28 [00:04<01:53,  4.19s/it]Training:   7%|▋         | 2/28 [00:05<00:58,  2.25s/it]Training:  11%|█         | 3/28 [00:05<00:40,  1.64s/it]Training:  14%|█▍        | 4/28 [00:06<00:32,  1.35s/it]Training:  18%|█▊        | 5/28 [00:07<00:27,  1.19s/it]Training:  21%|██▏       | 6/28 [00:08<00:23,  1.07s/it]Training:  25%|██▌       | 7/28 [00:09<00:21,  1.00s/it]Training:  29%|██▊       | 8/28 [00:10<00:18,  1.06it/s]Training:  32%|███▏      | 9/28 [00:11<00:17,  1.12it/s]Training:  36%|███▌      | 10/28 [00:11<00:15,  1.15it/s]Training:  39%|███▉      | 11/28 [00:12<00:14,  1.19it/s]Training:  43%|████▎     | 12/28 [00:13<00:13,  1.20it/s]Training:  46%|████▋     | 13/28 [00:14<00:12,  1.23it/s]Training:  50%|█████     | 14/28 [00:15<00:11,  1.25it/s]Training:  54%|█████▎    | 15/28 [00:15<00:10,  1.26it/s]Training:  57%|█████▋    | 16/28 [00:16<00:09,  1.27it/s]Training:  61%|██████    | 17/28 [00:17<00:08,  1.28it/s]Training:  64%|██████▍   | 18/28 [00:18<00:07,  1.28it/s]Training:  68%|██████▊   | 19/28 [00:18<00:07,  1.28it/s]Training:  71%|███████▏  | 20/28 [00:19<00:06,  1.29it/s]Training:  75%|███████▌  | 21/28 [00:20<00:05,  1.29it/s]Training:  79%|███████▊  | 22/28 [00:21<00:04,  1.29it/s]Training:  82%|████████▏ | 23/28 [00:22<00:03,  1.29it/s]Training:  86%|████████▌ | 24/28 [00:22<00:03,  1.29it/s]Training:  89%|████████▉ | 25/28 [00:23<00:02,  1.29it/s]Training:  93%|█████████▎| 26/28 [00:24<00:01,  1.29it/s]Training:  96%|█████████▋| 27/28 [00:25<00:00,  1.29it/s]Training: 100%|██████████| 28/28 [00:25<00:00,  1.29it/s]Training: 100%|██████████| 28/28 [00:26<00:00,  1.07it/s]
2024-12-07 09:05:57,071 - INFO - Epoch 8/200, Total Loss: 4.6056, Cls Loss: 2.0724, Cluster Loss: 2.3546, New Loss: 0.0000, Clip tag Loss: 2.3074
2024-12-07 09:05:57,071 - INFO -    Param Group: classifier_head, Learning Rate: 0.0996
2024-12-07 09:05:57,071 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:04<01:03,  4.51s/it] 13%|█▎        | 2/15 [00:05<00:29,  2.25s/it] 20%|██        | 3/15 [00:05<00:18,  1.52s/it] 27%|██▋       | 4/15 [00:06<00:13,  1.18s/it] 33%|███▎      | 5/15 [00:07<00:09,  1.00it/s] 40%|████      | 6/15 [00:07<00:07,  1.13it/s] 47%|████▋     | 7/15 [00:08<00:06,  1.24it/s] 53%|█████▎    | 8/15 [00:09<00:05,  1.32it/s] 60%|██████    | 9/15 [00:09<00:04,  1.37it/s] 67%|██████▋   | 10/15 [00:10<00:03,  1.41it/s] 73%|███████▎  | 11/15 [00:11<00:02,  1.44it/s] 80%|████████  | 12/15 [00:11<00:02,  1.46it/s] 87%|████████▋ | 13/15 [00:12<00:01,  1.48it/s] 93%|█████████▎| 14/15 [00:13<00:00,  1.49it/s]100%|██████████| 15/15 [00:13<00:00,  1.84it/s]100%|██████████| 15/15 [00:13<00:00,  1.10it/s]
2024-12-07 09:06:10,709 - INFO - Text classifier Epoch 7 Train Accuracies: All 0.3298 | Old 0.3690 | New 0.2886
2024-12-07 09:06:10,709 - INFO - Image classifier Epoch 7 Train Accuracies: All 0.6334 | Old 0.8745 | New 0.3798
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:04<01:04,  4.63s/it] 13%|█▎        | 2/15 [00:05<00:29,  2.30s/it] 20%|██        | 3/15 [00:05<00:18,  1.55s/it] 27%|██▋       | 4/15 [00:06<00:13,  1.20s/it] 33%|███▎      | 5/15 [00:07<00:10,  1.00s/it] 40%|████      | 6/15 [00:07<00:07,  1.13it/s] 47%|████▋     | 7/15 [00:08<00:06,  1.23it/s] 53%|█████▎    | 8/15 [00:09<00:05,  1.31it/s] 60%|██████    | 9/15 [00:09<00:04,  1.37it/s] 67%|██████▋   | 10/15 [00:10<00:03,  1.42it/s] 73%|███████▎  | 11/15 [00:11<00:02,  1.45it/s] 80%|████████  | 12/15 [00:11<00:02,  1.47it/s] 87%|████████▋ | 13/15 [00:12<00:01,  1.49it/s] 93%|█████████▎| 14/15 [00:13<00:00,  1.50it/s]100%|██████████| 15/15 [00:13<00:00,  1.86it/s]100%|██████████| 15/15 [00:13<00:00,  1.10it/s]
2024-12-07 09:06:24,363 - INFO - Weighted Accuracies: All 0.4053 | Old 0.4375 | New 0.3714
2024-12-07 09:06:35,419 - INFO - len of image_to_class_map: 1570
2024-12-07 09:06:35,420 - INFO - len of image_to_class_map_i: 1326
logits_text.shape torch.Size([2738, 37])
logits_image.shape torch.Size([2738, 37])
Training:   0%|          | 0/28 [00:00<?, ?it/s]Training:   4%|▎         | 1/28 [00:04<02:04,  4.60s/it]Training:   7%|▋         | 2/28 [00:05<01:02,  2.40s/it]Training:  11%|█         | 3/28 [00:06<00:43,  1.72s/it]Training:  14%|█▍        | 4/28 [00:07<00:33,  1.39s/it]Training:  18%|█▊        | 5/28 [00:08<00:27,  1.21s/it]Training:  21%|██▏       | 6/28 [00:09<00:23,  1.09s/it]Training:  25%|██▌       | 7/28 [00:09<00:21,  1.00s/it]Training:  29%|██▊       | 8/28 [00:10<00:18,  1.06it/s]Training:  32%|███▏      | 9/28 [00:11<00:17,  1.11it/s]Training:  36%|███▌      | 10/28 [00:12<00:15,  1.15it/s]Training:  39%|███▉      | 11/28 [00:13<00:14,  1.18it/s]Training:  43%|████▎     | 12/28 [00:13<00:13,  1.21it/s]Training:  46%|████▋     | 13/28 [00:14<00:12,  1.22it/s]Training:  50%|█████     | 14/28 [00:15<00:11,  1.24it/s]Training:  54%|█████▎    | 15/28 [00:16<00:10,  1.25it/s]Training:  57%|█████▋    | 16/28 [00:16<00:09,  1.27it/s]Training:  61%|██████    | 17/28 [00:17<00:08,  1.27it/s]Training:  64%|██████▍   | 18/28 [00:18<00:07,  1.28it/s]Training:  68%|██████▊   | 19/28 [00:19<00:06,  1.29it/s]Training:  71%|███████▏  | 20/28 [00:20<00:06,  1.29it/s]Training:  75%|███████▌  | 21/28 [00:20<00:05,  1.29it/s]Training:  79%|███████▊  | 22/28 [00:21<00:04,  1.29it/s]Training:  82%|████████▏ | 23/28 [00:22<00:03,  1.29it/s]Training:  86%|████████▌ | 24/28 [00:23<00:03,  1.29it/s]Training:  89%|████████▉ | 25/28 [00:23<00:02,  1.29it/s]Training:  93%|█████████▎| 26/28 [00:24<00:01,  1.29it/s]Training:  96%|█████████▋| 27/28 [00:25<00:00,  1.29it/s]Training: 100%|██████████| 28/28 [00:26<00:00,  1.29it/s]Training: 100%|██████████| 28/28 [00:26<00:00,  1.06it/s]
2024-12-07 09:07:01,956 - INFO - Epoch 9/200, Total Loss: 4.3977, Cls Loss: 1.9843, Cluster Loss: 2.1878, New Loss: 0.0000, Clip tag Loss: 2.2506
2024-12-07 09:07:01,956 - INFO -    Param Group: classifier_head, Learning Rate: 0.0995
2024-12-07 09:07:01,957 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:04<01:05,  4.65s/it] 13%|█▎        | 2/15 [00:05<00:30,  2.33s/it] 20%|██        | 3/15 [00:06<00:18,  1.57s/it] 27%|██▋       | 4/15 [00:06<00:13,  1.21s/it] 33%|███▎      | 5/15 [00:07<00:10,  1.01s/it] 40%|████      | 6/15 [00:07<00:08,  1.12it/s] 47%|████▋     | 7/15 [00:08<00:06,  1.22it/s] 53%|█████▎    | 8/15 [00:09<00:05,  1.31it/s] 60%|██████    | 9/15 [00:09<00:04,  1.37it/s] 67%|██████▋   | 10/15 [00:10<00:03,  1.41it/s] 73%|███████▎  | 11/15 [00:11<00:02,  1.44it/s] 80%|████████  | 12/15 [00:11<00:02,  1.46it/s] 87%|████████▋ | 13/15 [00:12<00:01,  1.48it/s] 93%|█████████▎| 14/15 [00:13<00:00,  1.49it/s]100%|██████████| 15/15 [00:13<00:00,  1.85it/s]100%|██████████| 15/15 [00:13<00:00,  1.09it/s]
2024-12-07 09:07:15,757 - INFO - Text classifier Epoch 8 Train Accuracies: All 0.3284 | Old 0.3280 | New 0.3289
2024-12-07 09:07:15,758 - INFO - Image classifier Epoch 8 Train Accuracies: All 0.6740 | Old 0.9240 | New 0.4111
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:04<01:03,  4.57s/it] 13%|█▎        | 2/15 [00:05<00:29,  2.27s/it] 20%|██        | 3/15 [00:05<00:18,  1.54s/it] 27%|██▋       | 4/15 [00:06<00:13,  1.19s/it] 33%|███▎      | 5/15 [00:07<00:10,  1.00s/it] 40%|████      | 6/15 [00:07<00:07,  1.13it/s] 47%|████▋     | 7/15 [00:08<00:06,  1.23it/s] 53%|█████▎    | 8/15 [00:09<00:05,  1.31it/s] 60%|██████    | 9/15 [00:09<00:04,  1.37it/s] 67%|██████▋   | 10/15 [00:10<00:03,  1.41it/s] 73%|███████▎  | 11/15 [00:11<00:02,  1.44it/s] 80%|████████  | 12/15 [00:11<00:02,  1.46it/s] 87%|████████▋ | 13/15 [00:12<00:01,  1.48it/s] 93%|█████████▎| 14/15 [00:13<00:00,  1.49it/s]100%|██████████| 15/15 [00:13<00:00,  1.85it/s]100%|██████████| 15/15 [00:13<00:00,  1.10it/s]
2024-12-07 09:07:29,430 - INFO - Weighted Accuracies: All 0.4159 | Old 0.4620 | New 0.3674
2024-12-07 09:07:40,540 - INFO - len of image_to_class_map: 1570
2024-12-07 09:07:40,541 - INFO - len of image_to_class_map_i: 1374
logits_text.shape torch.Size([2738, 37])
logits_image.shape torch.Size([2738, 37])
Training:   0%|          | 0/28 [00:00<?, ?it/s]Training:   4%|▎         | 1/28 [00:05<02:21,  5.23s/it]Training:   7%|▋         | 2/28 [00:06<01:10,  2.70s/it]Training:  11%|█         | 3/28 [00:07<00:46,  1.87s/it]Training:  14%|█▍        | 4/28 [00:07<00:34,  1.45s/it]Training:  18%|█▊        | 5/28 [00:08<00:28,  1.24s/it]Training:  21%|██▏       | 6/28 [00:09<00:24,  1.10s/it]Training:  25%|██▌       | 7/28 [00:10<00:21,  1.01s/it]Training:  29%|██▊       | 8/28 [00:11<00:18,  1.06it/s]Training:  32%|███▏      | 9/28 [00:11<00:17,  1.12it/s]Training:  36%|███▌      | 10/28 [00:12<00:15,  1.15it/s]Training:  39%|███▉      | 11/28 [00:13<00:14,  1.18it/s]Training:  43%|████▎     | 12/28 [00:14<00:13,  1.20it/s]Training:  46%|████▋     | 13/28 [00:15<00:12,  1.21it/s]Training:  50%|█████     | 14/28 [00:15<00:11,  1.24it/s]Training:  54%|█████▎    | 15/28 [00:16<00:10,  1.25it/s]Training:  57%|█████▋    | 16/28 [00:17<00:09,  1.27it/s]Training:  61%|██████    | 17/28 [00:18<00:08,  1.27it/s]Training:  64%|██████▍   | 18/28 [00:19<00:07,  1.28it/s]Training:  68%|██████▊   | 19/28 [00:19<00:07,  1.28it/s]Training:  71%|███████▏  | 20/28 [00:20<00:06,  1.29it/s]Training:  75%|███████▌  | 21/28 [00:21<00:05,  1.29it/s]Training:  79%|███████▊  | 22/28 [00:22<00:04,  1.29it/s]Training:  82%|████████▏ | 23/28 [00:22<00:03,  1.29it/s]Training:  86%|████████▌ | 24/28 [00:23<00:03,  1.29it/s]Training:  89%|████████▉ | 25/28 [00:24<00:02,  1.29it/s]Training:  93%|█████████▎| 26/28 [00:25<00:01,  1.29it/s]Training:  96%|█████████▋| 27/28 [00:25<00:00,  1.29it/s]Training: 100%|██████████| 28/28 [00:26<00:00,  1.29it/s]Training: 100%|██████████| 28/28 [00:27<00:00,  1.04it/s]
2024-12-07 09:08:07,583 - INFO - Epoch 10/200, Total Loss: 4.2426, Cls Loss: 1.8987, Cluster Loss: 2.1023, New Loss: 0.0000, Clip tag Loss: 2.1810
2024-12-07 09:08:07,583 - INFO -    Param Group: classifier_head, Learning Rate: 0.0994
2024-12-07 09:08:07,583 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:04<01:05,  4.65s/it] 13%|█▎        | 2/15 [00:05<00:29,  2.30s/it] 20%|██        | 3/15 [00:05<00:18,  1.55s/it] 27%|██▋       | 4/15 [00:06<00:13,  1.20s/it] 33%|███▎      | 5/15 [00:07<00:10,  1.01s/it] 40%|████      | 6/15 [00:07<00:07,  1.13it/s] 47%|████▋     | 7/15 [00:08<00:06,  1.23it/s] 53%|█████▎    | 8/15 [00:09<00:05,  1.31it/s] 60%|██████    | 9/15 [00:09<00:04,  1.37it/s] 67%|██████▋   | 10/15 [00:10<00:03,  1.41it/s] 73%|███████▎  | 11/15 [00:11<00:02,  1.44it/s] 80%|████████  | 12/15 [00:11<00:02,  1.46it/s] 87%|████████▋ | 13/15 [00:12<00:01,  1.48it/s] 93%|█████████▎| 14/15 [00:13<00:00,  1.49it/s]100%|██████████| 15/15 [00:13<00:00,  1.85it/s]100%|██████████| 15/15 [00:13<00:00,  1.09it/s]
2024-12-07 09:08:21,312 - INFO - Text classifier Epoch 9 Train Accuracies: All 0.3290 | Old 0.3323 | New 0.3255
2024-12-07 09:08:21,312 - INFO - Image classifier Epoch 9 Train Accuracies: All 0.6857 | Old 0.9293 | New 0.4295
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:04<01:04,  4.60s/it] 13%|█▎        | 2/15 [00:05<00:30,  2.31s/it] 20%|██        | 3/15 [00:05<00:18,  1.56s/it] 27%|██▋       | 4/15 [00:06<00:13,  1.20s/it] 33%|███▎      | 5/15 [00:07<00:10,  1.01s/it] 40%|████      | 6/15 [00:07<00:07,  1.13it/s] 47%|████▋     | 7/15 [00:08<00:06,  1.23it/s] 53%|█████▎    | 8/15 [00:09<00:05,  1.31it/s] 60%|██████    | 9/15 [00:09<00:04,  1.37it/s] 67%|██████▋   | 10/15 [00:10<00:03,  1.41it/s] 73%|███████▎  | 11/15 [00:11<00:02,  1.44it/s] 80%|████████  | 12/15 [00:11<00:02,  1.46it/s] 87%|████████▋ | 13/15 [00:12<00:01,  1.48it/s] 93%|█████████▎| 14/15 [00:13<00:00,  1.49it/s]100%|██████████| 15/15 [00:13<00:00,  1.85it/s]100%|██████████| 15/15 [00:13<00:00,  1.09it/s]
2024-12-07 09:08:35,029 - INFO - Weighted Accuracies: All 0.4178 | Old 0.4381 | New 0.3965
2024-12-07 09:08:46,141 - INFO - len of image_to_class_map: 1559
2024-12-07 09:08:46,142 - INFO - len of image_to_class_map_i: 1377
logits_text.shape torch.Size([2738, 37])
logits_image.shape torch.Size([2738, 37])
Training:   0%|          | 0/28 [00:00<?, ?it/s]Training:   4%|▎         | 1/28 [00:04<02:13,  4.95s/it]Training:   7%|▋         | 2/28 [00:05<01:06,  2.57s/it]Training:  11%|█         | 3/28 [00:06<00:44,  1.79s/it]Training:  14%|█▍        | 4/28 [00:07<00:34,  1.42s/it]Training:  18%|█▊        | 5/28 [00:08<00:28,  1.22s/it]Training:  21%|██▏       | 6/28 [00:09<00:23,  1.09s/it]Training:  25%|██▌       | 7/28 [00:10<00:20,  1.01it/s]Training:  29%|██▊       | 8/28 [00:10<00:18,  1.07it/s]Training:  32%|███▏      | 9/28 [00:11<00:17,  1.12it/s]Training:  36%|███▌      | 10/28 [00:12<00:15,  1.15it/s]Training:  39%|███▉      | 11/28 [00:13<00:14,  1.18it/s]Training:  43%|████▎     | 12/28 [00:14<00:13,  1.20it/s]Training:  46%|████▋     | 13/28 [00:14<00:12,  1.21it/s]Training:  50%|█████     | 14/28 [00:15<00:11,  1.24it/s]Training:  54%|█████▎    | 15/28 [00:16<00:10,  1.25it/s]Training:  57%|█████▋    | 16/28 [00:17<00:09,  1.27it/s]Training:  61%|██████    | 17/28 [00:17<00:08,  1.27it/s]Training:  64%|██████▍   | 18/28 [00:18<00:07,  1.28it/s]Training:  68%|██████▊   | 19/28 [00:19<00:07,  1.28it/s]Training:  71%|███████▏  | 20/28 [00:20<00:06,  1.29it/s]Training:  75%|███████▌  | 21/28 [00:21<00:05,  1.29it/s]Training:  79%|███████▊  | 22/28 [00:21<00:04,  1.29it/s]Training:  82%|████████▏ | 23/28 [00:22<00:03,  1.29it/s]Training:  86%|████████▌ | 24/28 [00:23<00:03,  1.29it/s]Training:  89%|████████▉ | 25/28 [00:24<00:02,  1.29it/s]Training:  93%|█████████▎| 26/28 [00:24<00:01,  1.29it/s]Training:  96%|█████████▋| 27/28 [00:25<00:00,  1.29it/s]Training: 100%|██████████| 28/28 [00:26<00:00,  1.29it/s]Training: 100%|██████████| 28/28 [00:26<00:00,  1.05it/s]
2024-12-07 09:09:12,920 - INFO - Epoch 11/200, Total Loss: 4.1565, Cls Loss: 1.7672, Cluster Loss: 2.0082, New Loss: 0.0000, Clip tag Loss: 2.1965
2024-12-07 09:09:12,920 - INFO -    Param Group: classifier_head, Learning Rate: 0.0993
2024-12-07 09:09:12,920 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:04<01:04,  4.60s/it] 13%|█▎        | 2/15 [00:05<00:29,  2.28s/it] 20%|██        | 3/15 [00:05<00:18,  1.54s/it] 27%|██▋       | 4/15 [00:06<00:13,  1.19s/it] 33%|███▎      | 5/15 [00:07<00:09,  1.00it/s] 40%|████      | 6/15 [00:07<00:07,  1.13it/s] 47%|████▋     | 7/15 [00:08<00:06,  1.24it/s] 53%|█████▎    | 8/15 [00:09<00:05,  1.32it/s] 60%|██████    | 9/15 [00:09<00:04,  1.37it/s] 67%|██████▋   | 10/15 [00:10<00:03,  1.41it/s] 73%|███████▎  | 11/15 [00:11<00:02,  1.44it/s] 80%|████████  | 12/15 [00:11<00:02,  1.47it/s] 87%|████████▋ | 13/15 [00:12<00:01,  1.48it/s] 93%|█████████▎| 14/15 [00:13<00:00,  1.49it/s]100%|██████████| 15/15 [00:13<00:00,  1.85it/s]100%|██████████| 15/15 [00:13<00:00,  1.10it/s]
2024-12-07 09:09:26,609 - INFO - Text classifier Epoch 10 Train Accuracies: All 0.3352 | Old 0.3599 | New 0.3093
2024-12-07 09:09:26,609 - INFO - Image classifier Epoch 10 Train Accuracies: All 0.6920 | Old 0.9346 | New 0.4368
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:04<01:03,  4.55s/it] 13%|█▎        | 2/15 [00:05<00:29,  2.26s/it] 20%|██        | 3/15 [00:05<00:18,  1.54s/it] 27%|██▋       | 4/15 [00:06<00:13,  1.19s/it] 33%|███▎      | 5/15 [00:07<00:10,  1.00s/it] 40%|████      | 6/15 [00:07<00:07,  1.13it/s] 47%|████▋     | 7/15 [00:08<00:06,  1.23it/s] 53%|█████▎    | 8/15 [00:09<00:05,  1.31it/s] 60%|██████    | 9/15 [00:09<00:04,  1.37it/s] 67%|██████▋   | 10/15 [00:10<00:03,  1.41it/s] 73%|███████▎  | 11/15 [00:11<00:02,  1.44it/s] 80%|████████  | 12/15 [00:11<00:02,  1.46it/s] 87%|████████▋ | 13/15 [00:12<00:01,  1.48it/s] 93%|█████████▎| 14/15 [00:13<00:00,  1.49it/s]100%|██████████| 15/15 [00:13<00:00,  1.85it/s]100%|██████████| 15/15 [00:13<00:00,  1.10it/s]
2024-12-07 09:09:40,308 - INFO - Weighted Accuracies: All 0.4186 | Old 0.4641 | New 0.3708
slurmstepd: error: *** JOB 10002337 ON lrdn0015 CANCELLED AT 2024-12-07T09:09:43 ***
