2024-05-13 17:28:07,335 - INFO - Training cifar100_frozentext_text(clusterloss)_ssl(0.05)_seed0 with the following settings:
2024-05-13 17:28:07,335 - INFO - Command-line arguments: output_dir=./rebuttal/frozen_text
 experiment_name=cifar100_frozentext_text(clusterloss)_ssl(0.05)_seed0
 seed_num=0
 evaluate=False
 dataset_name=cifar100
 backbone_name=ViT-B/16
 epochs=200
 base_lr=0.0005
 classifier_lr=0.1
 momentum=0.9
 weight_decay=0.0001
 num_workers=8
 batch_size=128
 prop_train_labels=0.05
 image_size=224
 crop_pct=0.875
 interpolation=3
 transform=imagenet
 alpha_sr=0
 alpha_ri=0.05
 alpha_rs=0.05
 alpha_rd=0.05
 pseudo_ratio=0.6
 lambda_loss=0.2
 coteaching_epoch_t=10
 coteaching_epoch_i=15
 max_kmeans_iter=10
 k_means_init=20
 interrupted_path=
 train_classes=range(0, 100)
 unlabeled_classes=[]
 num_labeled_classes=100
 num_unlabeled_classes=0
 num_classes=100
 log_path=./rebuttal/frozen_text/cifar100_frozentext_text(clusterloss)_ssl(0.05)_seed0/logs/log.txt
 model_path=./rebuttal/frozen_text/cifar100_frozentext_text(clusterloss)_ssl(0.05)_seed0/models/model.pth
 device=cuda
2024-05-13 17:28:07,338 - INFO - Loading CLIP (backbone: ViT-B/16)
2024-05-13 17:28:13,700 - INFO - Building custom CLIP
2024-05-13 17:28:23,904 - INFO - Turning off gradients in the image encoder
2024-05-13 17:28:23,907 - INFO - Parameters that require gradients: ['model.visual.proj', 'model.visual.transformer.resblocks.11.attn.in_proj_weight', 'model.visual.transformer.resblocks.11.attn.in_proj_bias', 'model.visual.transformer.resblocks.11.attn.out_proj.weight', 'model.visual.transformer.resblocks.11.attn.out_proj.bias', 'model.visual.transformer.resblocks.11.ln_1.weight', 'model.visual.transformer.resblocks.11.ln_1.bias', 'model.visual.transformer.resblocks.11.mlp.c_fc.weight', 'model.visual.transformer.resblocks.11.mlp.c_fc.bias', 'model.visual.transformer.resblocks.11.mlp.c_proj.weight', 'model.visual.transformer.resblocks.11.mlp.c_proj.bias', 'model.visual.transformer.resblocks.11.ln_2.weight', 'model.visual.transformer.resblocks.11.ln_2.bias', 'image_classifier.weight_g', 'image_classifier.weight_v']
2024-05-13 17:28:23,909 - INFO - Parameters in classifier with big lr: ['image_classifier.weight_g', 'image_classifier.weight_v']
2024-05-13 17:28:29,358 - INFO - len of train dataset: 50000
2024-05-13 17:28:29,358 - INFO - len of test dataset: 47500
2024-05-13 17:28:29,358 - INFO - Pseudo Nums: 285
2024-05-13 17:33:40,019 - INFO - len of image_to_class_map: 27718
2024-05-13 17:38:54,276 - INFO - Before Train Text Classifier Accuracies: Top-1 0.6513 | Top-5 0.8795
2024-05-13 17:38:54,277 - INFO - Before Train Image Classifier Accuracies: Top-1 0.0108 | Top-5 0.0496
2024-05-13 17:38:54,277 - INFO - Before Train Combined Classifier Accuracies: Top-1 0.6513 | Top-5 0.8793
2024-05-13 17:51:28,715 - INFO - Epoch 1/200, Total Loss: 4.5555, Cls Loss: 2.7805, Cluster Loss: 3.9327, New Loss: 0.0000, Clip tag Loss: 0.8532
2024-05-13 17:51:28,716 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2024-05-13 17:51:28,716 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-05-13 17:56:46,035 - INFO - Text classifier Epoch 0 Train Accuracies: Top-1 0.7469 | Top-5 0.9421
2024-05-13 17:56:46,036 - INFO - Image classifier Epoch 0 Train Accuracies: Top-1 0.6730 | Top-5 0.9099
2024-05-13 17:56:46,036 - INFO - All classifier Epoch 0 Train Accuracies: Top-1 0.7470 | Top-5 0.9427
2024-05-13 18:01:55,873 - INFO - len of image_to_class_map: 28495
2024-05-13 18:14:26,414 - INFO - Epoch 2/200, Total Loss: 2.8908, Cls Loss: 1.2924, Cluster Loss: 2.5648, New Loss: 0.0000, Clip tag Loss: 0.5805
2024-05-13 18:14:26,414 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2024-05-13 18:14:26,415 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-05-13 18:19:46,455 - INFO - Text classifier Epoch 1 Train Accuracies: Top-1 0.7531 | Top-5 0.9463
2024-05-13 18:19:46,455 - INFO - Image classifier Epoch 1 Train Accuracies: Top-1 0.7115 | Top-5 0.9309
2024-05-13 18:19:46,455 - INFO - All classifier Epoch 1 Train Accuracies: Top-1 0.7532 | Top-5 0.9470
2024-05-13 18:24:59,111 - INFO - len of image_to_class_map: 28500
2024-05-13 18:37:35,168 - INFO - Epoch 3/200, Total Loss: 2.5111, Cls Loss: 0.9921, Cluster Loss: 2.3980, New Loss: 0.0000, Clip tag Loss: 0.3943
2024-05-13 18:37:35,169 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2024-05-13 18:37:35,169 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-05-13 18:42:53,174 - INFO - Text classifier Epoch 2 Train Accuracies: Top-1 0.7584 | Top-5 0.9456
2024-05-13 18:42:53,175 - INFO - Image classifier Epoch 2 Train Accuracies: Top-1 0.7071 | Top-5 0.9374
2024-05-13 18:42:53,175 - INFO - All classifier Epoch 2 Train Accuracies: Top-1 0.7584 | Top-5 0.9462
2024-05-13 18:48:06,786 - INFO - len of image_to_class_map: 28500
2024-05-13 19:00:43,532 - INFO - Epoch 4/200, Total Loss: 2.3154, Cls Loss: 0.8480, Cluster Loss: 2.3294, New Loss: 0.0000, Clip tag Loss: 0.2823
2024-05-13 19:00:43,533 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2024-05-13 19:00:43,533 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-05-13 19:06:04,533 - INFO - Text classifier Epoch 3 Train Accuracies: Top-1 0.7575 | Top-5 0.9454
2024-05-13 19:06:04,534 - INFO - Image classifier Epoch 3 Train Accuracies: Top-1 0.7143 | Top-5 0.9361
2024-05-13 19:06:04,534 - INFO - All classifier Epoch 3 Train Accuracies: Top-1 0.7577 | Top-5 0.9463
2024-05-13 19:11:19,366 - INFO - len of image_to_class_map: 28499
2024-05-13 19:23:57,575 - INFO - Epoch 5/200, Total Loss: 2.1893, Cls Loss: 0.7707, Cluster Loss: 2.2662, New Loss: 0.0000, Clip tag Loss: 0.2221
2024-05-13 19:23:57,576 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2024-05-13 19:23:57,576 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-05-13 19:29:17,553 - INFO - Text classifier Epoch 4 Train Accuracies: Top-1 0.7555 | Top-5 0.9430
2024-05-13 19:29:17,554 - INFO - Image classifier Epoch 4 Train Accuracies: Top-1 0.7101 | Top-5 0.9360
2024-05-13 19:29:17,554 - INFO - All classifier Epoch 4 Train Accuracies: Top-1 0.7555 | Top-5 0.9441
2024-05-13 19:34:32,574 - INFO - len of image_to_class_map: 28470
2024-05-13 19:47:14,250 - INFO - Epoch 6/200, Total Loss: 2.0949, Cls Loss: 0.7144, Cluster Loss: 2.2224, New Loss: 0.0000, Clip tag Loss: 0.1741
2024-05-13 19:47:14,251 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2024-05-13 19:47:14,251 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-05-13 19:52:35,036 - INFO - Text classifier Epoch 5 Train Accuracies: Top-1 0.7566 | Top-5 0.9429
2024-05-13 19:52:35,036 - INFO - Image classifier Epoch 5 Train Accuracies: Top-1 0.6986 | Top-5 0.9352
2024-05-13 19:52:35,036 - INFO - All classifier Epoch 5 Train Accuracies: Top-1 0.7567 | Top-5 0.9442
2024-05-13 19:57:48,722 - INFO - len of image_to_class_map: 28454
2024-05-13 20:10:24,481 - INFO - Epoch 7/200, Total Loss: 2.0156, Cls Loss: 0.6646, Cluster Loss: 2.1753, New Loss: 0.0000, Clip tag Loss: 0.1425
2024-05-13 20:10:24,481 - INFO -    Param Group: classifier_head, Learning Rate: 0.0997
2024-05-13 20:10:24,481 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-05-13 20:15:44,737 - INFO - Text classifier Epoch 6 Train Accuracies: Top-1 0.7549 | Top-5 0.9440
2024-05-13 20:15:44,738 - INFO - Image classifier Epoch 6 Train Accuracies: Top-1 0.6943 | Top-5 0.9348
2024-05-13 20:15:44,738 - INFO - All classifier Epoch 6 Train Accuracies: Top-1 0.7551 | Top-5 0.9451
2024-05-13 20:20:59,789 - INFO - len of image_to_class_map: 28495
2024-05-13 20:33:43,385 - INFO - Epoch 8/200, Total Loss: 1.9707, Cls Loss: 0.6217, Cluster Loss: 2.1581, New Loss: 0.0000, Clip tag Loss: 0.1199
2024-05-13 20:33:43,386 - INFO -    Param Group: classifier_head, Learning Rate: 0.0996
2024-05-13 20:33:43,386 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-05-13 20:39:04,901 - INFO - Text classifier Epoch 7 Train Accuracies: Top-1 0.7540 | Top-5 0.9429
2024-05-13 20:39:04,902 - INFO - Image classifier Epoch 7 Train Accuracies: Top-1 0.6932 | Top-5 0.9352
2024-05-13 20:39:04,902 - INFO - All classifier Epoch 7 Train Accuracies: Top-1 0.7541 | Top-5 0.9439
2024-05-13 20:44:21,696 - INFO - len of image_to_class_map: 28499
2024-05-13 20:57:13,658 - INFO - Epoch 9/200, Total Loss: 1.9185, Cls Loss: 0.5885, Cluster Loss: 2.1190, New Loss: 0.0000, Clip tag Loss: 0.1056
2024-05-13 20:57:13,659 - INFO -    Param Group: classifier_head, Learning Rate: 0.0995
2024-05-13 20:57:13,659 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-05-13 21:02:36,115 - INFO - Text classifier Epoch 8 Train Accuracies: Top-1 0.7503 | Top-5 0.9424
2024-05-13 21:02:36,116 - INFO - Image classifier Epoch 8 Train Accuracies: Top-1 0.6947 | Top-5 0.9371
2024-05-13 21:02:36,116 - INFO - All classifier Epoch 8 Train Accuracies: Top-1 0.7503 | Top-5 0.9436
2024-05-13 21:07:53,620 - INFO - len of image_to_class_map: 28500
2024-05-13 21:20:39,125 - INFO - Epoch 10/200, Total Loss: 1.8904, Cls Loss: 0.5580, Cluster Loss: 2.1031, New Loss: 0.0000, Clip tag Loss: 0.0963
2024-05-13 21:20:39,126 - INFO -    Param Group: classifier_head, Learning Rate: 0.0994
2024-05-13 21:20:39,126 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-05-13 21:26:01,587 - INFO - Text classifier Epoch 9 Train Accuracies: Top-1 0.7526 | Top-5 0.9419
2024-05-13 21:26:01,588 - INFO - Image classifier Epoch 9 Train Accuracies: Top-1 0.6915 | Top-5 0.9344
2024-05-13 21:26:01,588 - INFO - All classifier Epoch 9 Train Accuracies: Top-1 0.7527 | Top-5 0.9430
2024-05-13 21:31:19,154 - INFO - len of image_to_class_map: 28476
2024-05-13 21:44:11,807 - INFO - Epoch 11/200, Total Loss: 1.8545, Cls Loss: 0.5235, Cluster Loss: 2.0839, New Loss: 0.0000, Clip tag Loss: 0.0827
2024-05-13 21:44:11,808 - INFO -    Param Group: classifier_head, Learning Rate: 0.0993
2024-05-13 21:44:11,808 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-05-13 21:49:33,730 - INFO - Text classifier Epoch 10 Train Accuracies: Top-1 0.7543 | Top-5 0.9439
2024-05-13 21:49:33,730 - INFO - Image classifier Epoch 10 Train Accuracies: Top-1 0.6953 | Top-5 0.9359
2024-05-13 21:49:33,731 - INFO - All classifier Epoch 10 Train Accuracies: Top-1 0.7545 | Top-5 0.9446
2024-05-13 21:54:51,054 - INFO - len of image_to_class_map: 28500
2024-05-13 22:07:46,358 - INFO - Epoch 12/200, Total Loss: 2.6067, Cls Loss: 0.3808, Cluster Loss: 2.0669, New Loss: 0.8037, Clip tag Loss: 0.0733
2024-05-13 22:07:46,359 - INFO -    Param Group: classifier_head, Learning Rate: 0.0991
2024-05-13 22:07:46,359 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-05-13 22:13:08,459 - INFO - Text classifier Epoch 11 Train Accuracies: Top-1 0.7669 | Top-5 0.9482
2024-05-13 22:13:08,460 - INFO - Image classifier Epoch 11 Train Accuracies: Top-1 0.7640 | Top-5 0.9493
2024-05-13 22:13:08,460 - INFO - All classifier Epoch 11 Train Accuracies: Top-1 0.7671 | Top-5 0.9496
2024-05-13 22:18:24,961 - INFO - len of image_to_class_map: 28500
2024-05-13 22:31:22,577 - INFO - Epoch 13/200, Total Loss: 2.4428, Cls Loss: 0.3208, Cluster Loss: 2.0909, New Loss: 0.6385, Clip tag Loss: 0.0675
2024-05-13 22:31:22,578 - INFO -    Param Group: classifier_head, Learning Rate: 0.0990
2024-05-13 22:31:22,578 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-05-13 22:36:43,827 - INFO - Text classifier Epoch 12 Train Accuracies: Top-1 0.7664 | Top-5 0.9477
2024-05-13 22:36:43,827 - INFO - Image classifier Epoch 12 Train Accuracies: Top-1 0.7763 | Top-5 0.9535
2024-05-13 22:36:43,828 - INFO - All classifier Epoch 12 Train Accuracies: Top-1 0.7667 | Top-5 0.9493
2024-05-13 22:42:02,166 - INFO - len of image_to_class_map: 28500
2024-05-13 22:54:42,830 - INFO - Epoch 14/200, Total Loss: 2.3659, Cls Loss: 0.3011, Cluster Loss: 2.0825, New Loss: 0.5772, Clip tag Loss: 0.0625
2024-05-13 22:54:42,831 - INFO -    Param Group: classifier_head, Learning Rate: 0.0988
2024-05-13 22:54:42,831 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-05-13 23:00:02,693 - INFO - Text classifier Epoch 13 Train Accuracies: Top-1 0.7643 | Top-5 0.9478
2024-05-13 23:00:02,694 - INFO - Image classifier Epoch 13 Train Accuracies: Top-1 0.7731 | Top-5 0.9543
2024-05-13 23:00:02,694 - INFO - All classifier Epoch 13 Train Accuracies: Top-1 0.7647 | Top-5 0.9499
2024-05-13 23:05:20,159 - INFO - len of image_to_class_map: 28500
2024-05-13 23:18:09,018 - INFO - Epoch 15/200, Total Loss: 2.3405, Cls Loss: 0.2835, Cluster Loss: 2.0798, New Loss: 0.5614, Clip tag Loss: 0.0586
2024-05-13 23:18:09,018 - INFO -    Param Group: classifier_head, Learning Rate: 0.0986
2024-05-13 23:18:09,018 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-05-13 23:23:29,842 - INFO - Text classifier Epoch 14 Train Accuracies: Top-1 0.7633 | Top-5 0.9471
2024-05-13 23:23:29,843 - INFO - Image classifier Epoch 14 Train Accuracies: Top-1 0.7731 | Top-5 0.9527
2024-05-13 23:23:29,843 - INFO - All classifier Epoch 14 Train Accuracies: Top-1 0.7635 | Top-5 0.9488
2024-05-13 23:28:47,998 - INFO - len of image_to_class_map: 28500
2024-05-13 23:41:32,891 - INFO - Epoch 16/200, Total Loss: 2.3233, Cls Loss: 0.2648, Cluster Loss: 2.0817, New Loss: 0.5496, Clip tag Loss: 0.0554
2024-05-13 23:41:32,892 - INFO -    Param Group: classifier_head, Learning Rate: 0.0984
2024-05-13 23:41:32,892 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-05-13 23:46:52,863 - INFO - Text classifier Epoch 15 Train Accuracies: Top-1 0.7632 | Top-5 0.9468
2024-05-13 23:46:52,864 - INFO - Image classifier Epoch 15 Train Accuracies: Top-1 0.7760 | Top-5 0.9525
2024-05-13 23:46:52,864 - INFO - All classifier Epoch 15 Train Accuracies: Top-1 0.7635 | Top-5 0.9491
2024-05-13 23:52:09,410 - INFO - len of image_to_class_map: 28498
2024-05-14 00:04:52,115 - INFO - Epoch 17/200, Total Loss: 2.2889, Cls Loss: 0.2527, Cluster Loss: 2.0678, New Loss: 0.5323, Clip tag Loss: 0.0518
2024-05-14 00:04:52,116 - INFO -    Param Group: classifier_head, Learning Rate: 0.0982
2024-05-14 00:04:52,116 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-05-14 00:10:11,925 - INFO - Text classifier Epoch 16 Train Accuracies: Top-1 0.7635 | Top-5 0.9465
2024-05-14 00:10:11,926 - INFO - Image classifier Epoch 16 Train Accuracies: Top-1 0.7754 | Top-5 0.9511
2024-05-14 00:10:11,926 - INFO - All classifier Epoch 16 Train Accuracies: Top-1 0.7637 | Top-5 0.9486
2024-05-14 00:15:29,920 - INFO - len of image_to_class_map: 28494
2024-05-14 00:28:09,471 - INFO - Epoch 18/200, Total Loss: 2.2649, Cls Loss: 0.2384, Cluster Loss: 2.0498, New Loss: 0.5289, Clip tag Loss: 0.0485
2024-05-14 00:28:09,472 - INFO -    Param Group: classifier_head, Learning Rate: 0.0980
2024-05-14 00:28:09,472 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-05-14 00:33:29,376 - INFO - Text classifier Epoch 17 Train Accuracies: Top-1 0.7617 | Top-5 0.9464
2024-05-14 00:33:29,376 - INFO - Image classifier Epoch 17 Train Accuracies: Top-1 0.7711 | Top-5 0.9519
2024-05-14 00:33:29,376 - INFO - All classifier Epoch 17 Train Accuracies: Top-1 0.7619 | Top-5 0.9483
2024-05-14 00:38:46,666 - INFO - len of image_to_class_map: 28496
2024-05-14 00:51:27,621 - INFO - Epoch 19/200, Total Loss: 2.2424, Cls Loss: 0.2245, Cluster Loss: 2.0540, New Loss: 0.5077, Clip tag Loss: 0.0466
2024-05-14 00:51:27,622 - INFO -    Param Group: classifier_head, Learning Rate: 0.0978
2024-05-14 00:51:27,622 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-05-14 00:56:48,788 - INFO - Text classifier Epoch 18 Train Accuracies: Top-1 0.7609 | Top-5 0.9467
2024-05-14 00:56:48,789 - INFO - Image classifier Epoch 18 Train Accuracies: Top-1 0.7710 | Top-5 0.9508
2024-05-14 00:56:48,789 - INFO - All classifier Epoch 18 Train Accuracies: Top-1 0.7610 | Top-5 0.9484
2024-05-14 01:02:06,611 - INFO - len of image_to_class_map: 28483
2024-05-14 01:14:51,229 - INFO - Epoch 20/200, Total Loss: 2.2397, Cls Loss: 0.2185, Cluster Loss: 2.0709, New Loss: 0.4944, Clip tag Loss: 0.0449
2024-05-14 01:14:51,230 - INFO -    Param Group: classifier_head, Learning Rate: 0.0976
2024-05-14 01:14:51,230 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-05-14 01:20:11,935 - INFO - Text classifier Epoch 19 Train Accuracies: Top-1 0.7594 | Top-5 0.9455
2024-05-14 01:20:11,936 - INFO - Image classifier Epoch 19 Train Accuracies: Top-1 0.7712 | Top-5 0.9499
2024-05-14 01:20:11,936 - INFO - All classifier Epoch 19 Train Accuracies: Top-1 0.7597 | Top-5 0.9473
2024-05-14 01:25:29,555 - INFO - len of image_to_class_map: 28491
2024-05-14 01:38:17,545 - INFO - Epoch 21/200, Total Loss: 2.2110, Cls Loss: 0.2069, Cluster Loss: 2.0503, New Loss: 0.4868, Clip tag Loss: 0.0426
2024-05-14 01:38:17,547 - INFO -    Param Group: classifier_head, Learning Rate: 0.0973
2024-05-14 01:38:17,547 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
