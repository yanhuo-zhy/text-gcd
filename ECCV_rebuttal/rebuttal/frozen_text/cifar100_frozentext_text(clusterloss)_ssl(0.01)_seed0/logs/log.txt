2024-05-13 17:15:24,627 - INFO - Training cifar100_frozentext_text(clusterloss)_ssl(0.01)_seed0 with the following settings:
2024-05-13 17:15:24,627 - INFO - Command-line arguments: output_dir=./rebuttal/frozen_text
 experiment_name=cifar100_frozentext_text(clusterloss)_ssl(0.01)_seed0
 seed_num=0
 evaluate=False
 dataset_name=cifar100
 backbone_name=ViT-B/16
 epochs=200
 base_lr=0.0005
 classifier_lr=0.1
 momentum=0.9
 weight_decay=0.0001
 num_workers=8
 batch_size=128
 prop_train_labels=0.01
 image_size=224
 crop_pct=0.875
 interpolation=3
 transform=imagenet
 alpha_sr=0
 alpha_ri=0.05
 alpha_rs=0.05
 alpha_rd=0.05
 pseudo_ratio=0.6
 lambda_loss=0.2
 coteaching_epoch_t=10
 coteaching_epoch_i=15
 max_kmeans_iter=10
 k_means_init=20
 interrupted_path=
 train_classes=range(0, 100)
 unlabeled_classes=[]
 num_labeled_classes=100
 num_unlabeled_classes=0
 num_classes=100
 log_path=./rebuttal/frozen_text/cifar100_frozentext_text(clusterloss)_ssl(0.01)_seed0/logs/log.txt
 model_path=./rebuttal/frozen_text/cifar100_frozentext_text(clusterloss)_ssl(0.01)_seed0/models/model.pth
 device=cuda
2024-05-13 17:15:24,630 - INFO - Loading CLIP (backbone: ViT-B/16)
2024-05-13 17:15:29,106 - INFO - Building custom CLIP
2024-05-13 17:15:40,180 - INFO - Turning off gradients in the image encoder
2024-05-13 17:15:40,183 - INFO - Parameters that require gradients: ['model.visual.proj', 'model.visual.transformer.resblocks.11.attn.in_proj_weight', 'model.visual.transformer.resblocks.11.attn.in_proj_bias', 'model.visual.transformer.resblocks.11.attn.out_proj.weight', 'model.visual.transformer.resblocks.11.attn.out_proj.bias', 'model.visual.transformer.resblocks.11.ln_1.weight', 'model.visual.transformer.resblocks.11.ln_1.bias', 'model.visual.transformer.resblocks.11.mlp.c_fc.weight', 'model.visual.transformer.resblocks.11.mlp.c_fc.bias', 'model.visual.transformer.resblocks.11.mlp.c_proj.weight', 'model.visual.transformer.resblocks.11.mlp.c_proj.bias', 'model.visual.transformer.resblocks.11.ln_2.weight', 'model.visual.transformer.resblocks.11.ln_2.bias', 'image_classifier.weight_g', 'image_classifier.weight_v']
2024-05-13 17:15:40,185 - INFO - Parameters in classifier with big lr: ['image_classifier.weight_g', 'image_classifier.weight_v']
2024-05-13 17:15:45,351 - INFO - len of train dataset: 50000
2024-05-13 17:15:45,351 - INFO - len of test dataset: 49500
2024-05-13 17:15:45,351 - INFO - Pseudo Nums: 297
2024-05-13 17:21:06,336 - INFO - len of image_to_class_map: 28877
2024-05-13 17:26:28,499 - INFO - Before Train Text Classifier Accuracies: Top-1 0.6515 | Top-5 0.8799
2024-05-13 17:26:28,500 - INFO - Before Train Image Classifier Accuracies: Top-1 0.0108 | Top-5 0.0495
2024-05-13 17:26:28,500 - INFO - Before Train Combined Classifier Accuracies: Top-1 0.6515 | Top-5 0.8797
2024-05-13 17:38:51,073 - INFO - Epoch 1/200, Total Loss: 3.9802, Cls Loss: 2.3599, Cluster Loss: 3.7161, New Loss: 0.0000, Clip tag Loss: 0.5354
2024-05-13 17:38:51,074 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2024-05-13 17:38:51,074 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-05-13 17:44:16,702 - INFO - Text classifier Epoch 0 Train Accuracies: Top-1 0.7291 | Top-5 0.9324
2024-05-13 17:44:16,703 - INFO - Image classifier Epoch 0 Train Accuracies: Top-1 0.5602 | Top-5 0.8554
2024-05-13 17:44:16,703 - INFO - All classifier Epoch 0 Train Accuracies: Top-1 0.7291 | Top-5 0.9323
2024-05-13 17:49:39,943 - INFO - len of image_to_class_map: 29700
2024-05-13 18:01:59,679 - INFO - Epoch 2/200, Total Loss: 2.1711, Cls Loss: 0.7221, Cluster Loss: 2.3620, New Loss: 0.0000, Clip tag Loss: 0.1371
2024-05-13 18:01:59,680 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2024-05-13 18:01:59,680 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-05-13 18:07:25,283 - INFO - Text classifier Epoch 1 Train Accuracies: Top-1 0.7206 | Top-5 0.9257
2024-05-13 18:07:25,284 - INFO - Image classifier Epoch 1 Train Accuracies: Top-1 0.5668 | Top-5 0.8681
2024-05-13 18:07:25,284 - INFO - All classifier Epoch 1 Train Accuracies: Top-1 0.7206 | Top-5 0.9263
2024-05-13 18:12:49,972 - INFO - len of image_to_class_map: 29687
2024-05-13 18:25:13,402 - INFO - Epoch 3/200, Total Loss: 1.9655, Cls Loss: 0.4917, Cluster Loss: 2.2350, New Loss: 0.0000, Clip tag Loss: 0.0791
2024-05-13 18:25:13,403 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2024-05-13 18:25:13,403 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-05-13 18:30:40,172 - INFO - Text classifier Epoch 2 Train Accuracies: Top-1 0.7099 | Top-5 0.9212
2024-05-13 18:30:40,172 - INFO - Image classifier Epoch 2 Train Accuracies: Top-1 0.5597 | Top-5 0.8618
2024-05-13 18:30:40,173 - INFO - All classifier Epoch 2 Train Accuracies: Top-1 0.7100 | Top-5 0.9219
2024-05-13 18:36:05,530 - INFO - len of image_to_class_map: 29700
2024-05-13 18:48:29,284 - INFO - Epoch 4/200, Total Loss: 1.9064, Cls Loss: 0.3961, Cluster Loss: 2.2101, New Loss: 0.0000, Clip tag Loss: 0.0591
2024-05-13 18:48:29,284 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2024-05-13 18:48:29,284 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-05-13 18:53:57,790 - INFO - Text classifier Epoch 3 Train Accuracies: Top-1 0.7055 | Top-5 0.9179
2024-05-13 18:53:57,790 - INFO - Image classifier Epoch 3 Train Accuracies: Top-1 0.5344 | Top-5 0.8507
2024-05-13 18:53:57,790 - INFO - All classifier Epoch 3 Train Accuracies: Top-1 0.7055 | Top-5 0.9190
2024-05-13 18:59:24,328 - INFO - len of image_to_class_map: 29689
2024-05-13 19:11:51,392 - INFO - Epoch 5/200, Total Loss: 1.8696, Cls Loss: 0.3488, Cluster Loss: 2.1889, New Loss: 0.0000, Clip tag Loss: 0.0487
2024-05-13 19:11:51,392 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2024-05-13 19:11:51,392 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-05-13 19:17:20,646 - INFO - Text classifier Epoch 4 Train Accuracies: Top-1 0.6953 | Top-5 0.9092
2024-05-13 19:17:20,647 - INFO - Image classifier Epoch 4 Train Accuracies: Top-1 0.5001 | Top-5 0.8393
2024-05-13 19:17:20,647 - INFO - All classifier Epoch 4 Train Accuracies: Top-1 0.6954 | Top-5 0.9097
2024-05-13 19:22:47,142 - INFO - len of image_to_class_map: 29668
2024-05-13 19:35:14,109 - INFO - Epoch 6/200, Total Loss: 1.8495, Cls Loss: 0.3053, Cluster Loss: 2.1819, New Loss: 0.0000, Clip tag Loss: 0.0429
2024-05-13 19:35:14,109 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2024-05-13 19:35:14,110 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-05-13 19:40:42,548 - INFO - Text classifier Epoch 5 Train Accuracies: Top-1 0.6951 | Top-5 0.9110
2024-05-13 19:40:42,549 - INFO - Image classifier Epoch 5 Train Accuracies: Top-1 0.5008 | Top-5 0.8410
2024-05-13 19:40:42,549 - INFO - All classifier Epoch 5 Train Accuracies: Top-1 0.6953 | Top-5 0.9113
2024-05-13 19:46:09,482 - INFO - len of image_to_class_map: 29679
2024-05-13 19:58:36,662 - INFO - Epoch 7/200, Total Loss: 1.8443, Cls Loss: 0.2787, Cluster Loss: 2.1879, New Loss: 0.0000, Clip tag Loss: 0.0382
2024-05-13 19:58:36,663 - INFO -    Param Group: classifier_head, Learning Rate: 0.0997
2024-05-13 19:58:36,663 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-05-13 20:04:05,297 - INFO - Text classifier Epoch 6 Train Accuracies: Top-1 0.6877 | Top-5 0.9050
2024-05-13 20:04:05,298 - INFO - Image classifier Epoch 6 Train Accuracies: Top-1 0.4994 | Top-5 0.8349
2024-05-13 20:04:05,298 - INFO - All classifier Epoch 6 Train Accuracies: Top-1 0.6879 | Top-5 0.9057
2024-05-13 20:09:33,242 - INFO - len of image_to_class_map: 29584
2024-05-13 20:22:00,917 - INFO - Epoch 8/200, Total Loss: 1.8085, Cls Loss: 0.2556, Cluster Loss: 2.1535, New Loss: 0.0000, Clip tag Loss: 0.0346
2024-05-13 20:22:00,918 - INFO -    Param Group: classifier_head, Learning Rate: 0.0996
2024-05-13 20:22:00,918 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-05-13 20:27:30,574 - INFO - Text classifier Epoch 7 Train Accuracies: Top-1 0.6839 | Top-5 0.9053
2024-05-13 20:27:30,574 - INFO - Image classifier Epoch 7 Train Accuracies: Top-1 0.4996 | Top-5 0.8360
2024-05-13 20:27:30,574 - INFO - All classifier Epoch 7 Train Accuracies: Top-1 0.6839 | Top-5 0.9062
2024-05-13 20:32:58,536 - INFO - len of image_to_class_map: 29596
2024-05-13 20:45:27,813 - INFO - Epoch 9/200, Total Loss: 1.7824, Cls Loss: 0.2287, Cluster Loss: 2.1330, New Loss: 0.0000, Clip tag Loss: 0.0303
2024-05-13 20:45:27,814 - INFO -    Param Group: classifier_head, Learning Rate: 0.0995
2024-05-13 20:45:27,814 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-05-13 20:50:57,526 - INFO - Text classifier Epoch 8 Train Accuracies: Top-1 0.6842 | Top-5 0.9049
2024-05-13 20:50:57,527 - INFO - Image classifier Epoch 8 Train Accuracies: Top-1 0.4888 | Top-5 0.8301
2024-05-13 20:50:57,527 - INFO - All classifier Epoch 8 Train Accuracies: Top-1 0.6845 | Top-5 0.9055
2024-05-13 20:56:25,797 - INFO - len of image_to_class_map: 29653
2024-05-13 21:08:54,961 - INFO - Epoch 10/200, Total Loss: 1.7855, Cls Loss: 0.2091, Cluster Loss: 2.1441, New Loss: 0.0000, Clip tag Loss: 0.0284
2024-05-13 21:08:54,961 - INFO -    Param Group: classifier_head, Learning Rate: 0.0994
2024-05-13 21:08:54,961 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-05-13 21:14:24,810 - INFO - Text classifier Epoch 9 Train Accuracies: Top-1 0.6785 | Top-5 0.9024
2024-05-13 21:14:24,811 - INFO - Image classifier Epoch 9 Train Accuracies: Top-1 0.4833 | Top-5 0.8330
2024-05-13 21:14:24,811 - INFO - All classifier Epoch 9 Train Accuracies: Top-1 0.6787 | Top-5 0.9034
2024-05-13 21:19:52,872 - INFO - len of image_to_class_map: 29622
2024-05-13 21:32:21,124 - INFO - Epoch 11/200, Total Loss: 1.7780, Cls Loss: 0.1966, Cluster Loss: 2.1401, New Loss: 0.0000, Clip tag Loss: 0.0266
2024-05-13 21:32:21,124 - INFO -    Param Group: classifier_head, Learning Rate: 0.0993
2024-05-13 21:32:21,124 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-05-13 21:37:50,037 - INFO - Text classifier Epoch 10 Train Accuracies: Top-1 0.6755 | Top-5 0.9019
2024-05-13 21:37:50,038 - INFO - Image classifier Epoch 10 Train Accuracies: Top-1 0.4798 | Top-5 0.8331
2024-05-13 21:37:50,038 - INFO - All classifier Epoch 10 Train Accuracies: Top-1 0.6756 | Top-5 0.9029
2024-05-13 21:43:17,907 - INFO - len of image_to_class_map: 29619
2024-05-13 21:55:48,619 - INFO - Epoch 12/200, Total Loss: 2.7487, Cls Loss: 0.1271, Cluster Loss: 2.0698, New Loss: 1.0501, Clip tag Loss: 0.0173
2024-05-13 21:55:48,620 - INFO -    Param Group: classifier_head, Learning Rate: 0.0991
2024-05-13 21:55:48,620 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-05-13 22:01:18,482 - INFO - Text classifier Epoch 11 Train Accuracies: Top-1 0.7098 | Top-5 0.9202
2024-05-13 22:01:18,483 - INFO - Image classifier Epoch 11 Train Accuracies: Top-1 0.7163 | Top-5 0.9280
2024-05-13 22:01:18,483 - INFO - All classifier Epoch 11 Train Accuracies: Top-1 0.7102 | Top-5 0.9232
2024-05-13 22:06:45,747 - INFO - len of image_to_class_map: 29627
2024-05-13 22:19:17,189 - INFO - Epoch 13/200, Total Loss: 2.4733, Cls Loss: 0.1284, Cluster Loss: 2.0889, New Loss: 0.7587, Clip tag Loss: 0.0178
2024-05-13 22:19:17,189 - INFO -    Param Group: classifier_head, Learning Rate: 0.0990
2024-05-13 22:19:17,190 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-05-13 22:24:47,192 - INFO - Text classifier Epoch 12 Train Accuracies: Top-1 0.7086 | Top-5 0.9189
2024-05-13 22:24:47,192 - INFO - Image classifier Epoch 12 Train Accuracies: Top-1 0.7319 | Top-5 0.9366
2024-05-13 22:24:47,193 - INFO - All classifier Epoch 12 Train Accuracies: Top-1 0.7089 | Top-5 0.9221
2024-05-13 22:30:15,649 - INFO - len of image_to_class_map: 29654
2024-05-13 22:42:46,670 - INFO - Epoch 14/200, Total Loss: 2.4158, Cls Loss: 0.1207, Cluster Loss: 2.1011, New Loss: 0.6928, Clip tag Loss: 0.0180
2024-05-13 22:42:46,670 - INFO -    Param Group: classifier_head, Learning Rate: 0.0988
2024-05-13 22:42:46,671 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-05-13 22:48:15,655 - INFO - Text classifier Epoch 13 Train Accuracies: Top-1 0.7032 | Top-5 0.9130
2024-05-13 22:48:15,656 - INFO - Image classifier Epoch 13 Train Accuracies: Top-1 0.7374 | Top-5 0.9350
2024-05-13 22:48:15,656 - INFO - All classifier Epoch 13 Train Accuracies: Top-1 0.7036 | Top-5 0.9168
2024-05-13 22:53:43,699 - INFO - len of image_to_class_map: 29610
2024-05-13 23:06:14,068 - INFO - Epoch 15/200, Total Loss: 2.3726, Cls Loss: 0.1152, Cluster Loss: 2.0727, New Loss: 0.6739, Clip tag Loss: 0.0175
2024-05-13 23:06:14,068 - INFO -    Param Group: classifier_head, Learning Rate: 0.0986
2024-05-13 23:06:14,068 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-05-13 23:11:43,639 - INFO - Text classifier Epoch 14 Train Accuracies: Top-1 0.7053 | Top-5 0.9176
2024-05-13 23:11:43,639 - INFO - Image classifier Epoch 14 Train Accuracies: Top-1 0.7331 | Top-5 0.9354
2024-05-13 23:11:43,640 - INFO - All classifier Epoch 14 Train Accuracies: Top-1 0.7057 | Top-5 0.9218
2024-05-13 23:17:11,187 - INFO - len of image_to_class_map: 29648
2024-05-13 23:29:42,240 - INFO - Epoch 16/200, Total Loss: 2.3719, Cls Loss: 0.1068, Cluster Loss: 2.0987, New Loss: 0.6548, Clip tag Loss: 0.0167
2024-05-13 23:29:42,240 - INFO -    Param Group: classifier_head, Learning Rate: 0.0984
2024-05-13 23:29:42,240 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-05-13 23:35:12,114 - INFO - Text classifier Epoch 15 Train Accuracies: Top-1 0.7026 | Top-5 0.9144
2024-05-13 23:35:12,115 - INFO - Image classifier Epoch 15 Train Accuracies: Top-1 0.7366 | Top-5 0.9379
2024-05-13 23:35:12,115 - INFO - All classifier Epoch 15 Train Accuracies: Top-1 0.7030 | Top-5 0.9191
2024-05-13 23:40:39,290 - INFO - len of image_to_class_map: 29612
2024-05-13 23:53:09,075 - INFO - Epoch 17/200, Total Loss: 2.3524, Cls Loss: 0.1067, Cluster Loss: 2.0889, New Loss: 0.6439, Clip tag Loss: 0.0160
2024-05-13 23:53:09,076 - INFO -    Param Group: classifier_head, Learning Rate: 0.0982
2024-05-13 23:53:09,076 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-05-13 23:58:38,096 - INFO - Text classifier Epoch 16 Train Accuracies: Top-1 0.7001 | Top-5 0.9160
2024-05-13 23:58:38,097 - INFO - Image classifier Epoch 16 Train Accuracies: Top-1 0.7352 | Top-5 0.9362
2024-05-13 23:58:38,097 - INFO - All classifier Epoch 16 Train Accuracies: Top-1 0.7004 | Top-5 0.9206
2024-05-14 00:04:05,252 - INFO - len of image_to_class_map: 29609
2024-05-14 00:16:36,691 - INFO - Epoch 18/200, Total Loss: 2.3390, Cls Loss: 0.1032, Cluster Loss: 2.0827, New Loss: 0.6365, Clip tag Loss: 0.0156
2024-05-14 00:16:36,691 - INFO -    Param Group: classifier_head, Learning Rate: 0.0980
2024-05-14 00:16:36,691 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-05-14 00:22:06,647 - INFO - Text classifier Epoch 17 Train Accuracies: Top-1 0.6961 | Top-5 0.9124
2024-05-14 00:22:06,648 - INFO - Image classifier Epoch 17 Train Accuracies: Top-1 0.7325 | Top-5 0.9339
2024-05-14 00:22:06,648 - INFO - All classifier Epoch 17 Train Accuracies: Top-1 0.6965 | Top-5 0.9166
2024-05-14 00:27:34,049 - INFO - len of image_to_class_map: 29607
2024-05-14 00:40:04,610 - INFO - Epoch 19/200, Total Loss: 2.3029, Cls Loss: 0.0948, Cluster Loss: 2.0733, New Loss: 0.6101, Clip tag Loss: 0.0152
2024-05-14 00:40:04,610 - INFO -    Param Group: classifier_head, Learning Rate: 0.0978
2024-05-14 00:40:04,611 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-05-14 00:45:34,982 - INFO - Text classifier Epoch 18 Train Accuracies: Top-1 0.6972 | Top-5 0.9138
2024-05-14 00:45:34,982 - INFO - Image classifier Epoch 18 Train Accuracies: Top-1 0.7309 | Top-5 0.9341
2024-05-14 00:45:34,982 - INFO - All classifier Epoch 18 Train Accuracies: Top-1 0.6977 | Top-5 0.9184
2024-05-14 00:51:03,921 - INFO - len of image_to_class_map: 29632
2024-05-14 01:03:35,795 - INFO - Epoch 20/200, Total Loss: 2.3075, Cls Loss: 0.0905, Cluster Loss: 2.0821, New Loss: 0.6087, Clip tag Loss: 0.0150
2024-05-14 01:03:35,796 - INFO -    Param Group: classifier_head, Learning Rate: 0.0976
2024-05-14 01:03:35,796 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-05-14 01:09:05,973 - INFO - Text classifier Epoch 19 Train Accuracies: Top-1 0.6953 | Top-5 0.9111
2024-05-14 01:09:05,974 - INFO - Image classifier Epoch 19 Train Accuracies: Top-1 0.7355 | Top-5 0.9359
2024-05-14 01:09:05,974 - INFO - All classifier Epoch 19 Train Accuracies: Top-1 0.6958 | Top-5 0.9158
2024-05-14 01:14:34,982 - INFO - len of image_to_class_map: 29643
2024-05-14 01:27:06,413 - INFO - Epoch 21/200, Total Loss: 2.2624, Cls Loss: 0.0811, Cluster Loss: 2.0412, New Loss: 0.5997, Clip tag Loss: 0.0136
2024-05-14 01:27:06,413 - INFO -    Param Group: classifier_head, Learning Rate: 0.0973
2024-05-14 01:27:06,414 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-05-14 01:32:36,393 - INFO - Text classifier Epoch 20 Train Accuracies: Top-1 0.6947 | Top-5 0.9112
2024-05-14 01:32:36,394 - INFO - Image classifier Epoch 20 Train Accuracies: Top-1 0.7293 | Top-5 0.9327
2024-05-14 01:32:36,394 - INFO - All classifier Epoch 20 Train Accuracies: Top-1 0.6952 | Top-5 0.9157
2024-05-14 01:38:04,681 - INFO - len of image_to_class_map: 29581
